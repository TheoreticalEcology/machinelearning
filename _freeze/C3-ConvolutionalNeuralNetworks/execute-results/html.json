{
  "hash": "79032d7ffa0023405e77531429216b5f",
  "result": {
    "markdown": "---\noutput: html_document\neditor_options:\n  chunk_output_type: console\n---\n\n\n# Convolutional Neural Networks (CNN)\n\n\n\n\n\nThe main purpose of convolutional neural networks is image recognition. (Sound can be understood as an image as well!) In a convolutional neural network, we have at least one convolution layer, additional to the normal, fully connected deep neural network layers.\n\nNeurons in a convolution layer are connected only to a small spatially contiguous area of the input layer (*receptive field*). We use this structure (*feature map*) to scan the **entire** features / neurons (e.g. picture). Think of the feature map as a *kernel* or *filter* (or imagine a sliding window with weighted pixels) that is used to scan the image. As the name is already indicating, this operation is a convolution in mathematics. The kernel weights are optimized, but we use the same weights across the entire input neurons (*shared weights*).\n\nThe resulting (hidden) convolutional layer after training is called a *feature map*. You can think of the feature map as a map that shows you where the \"shapes\" expressed by the kernel appear in the input. One kernel / feature map will not be enough, we typically have many shapes that we want to recognize. Thus, the input layer is typically connected to several feature maps, which can be aggregated and followed by a second layer of feature maps, and so on.\n\nYou get one convolution map/layer for each kernel of one convolutional layer.\n\n## Example MNIST\n\nWe will show the use of convolutional neural networks with the MNIST data set. This data set is maybe one of the most famous image data sets. It consists of 60,000 handwritten digits from 0-9.\n\nTo do so, we define a few helper functions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(keras3)\n\nrotate = function(x){ t(apply(x, 2, rev)) }\n\nimgPlot = function(img, title = \"\"){\n  col = grey.colors(255)\n  image(rotate(img), col = col, xlab = \"\", ylab = \"\", axes = FALSE,\n     main = paste0(\"Label: \", as.character(title)))\n}\n```\n:::\n\n\nThe MNIST data set is so famous that there is an automatic download function in Keras:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata = dataset_mnist()\ntrain = data$train\ntest = data$test\n```\n:::\n\n\nLet's visualize a few digits:\n\n\n::: {.cell}\n\n```{.r .cell-code}\noldpar = par(mfrow = c(1, 3))\n.n = sapply(1:3, function(x) imgPlot(train$x[x,,], train$y[x]))\n```\n\n::: {.cell-output-display}\n![](C3-ConvolutionalNeuralNetworks_files/figure-html/chunk_chapter5_11-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(oldpar)\n```\n:::\n\n\nSimilar to the normal machine learning workflow, we have to scale the pixels (from 0-255) to the range of $[0, 1]$ and one hot encode the response. For scaling the pixels, we will use arrays instead of matrices. Arrays are called tensors in mathematics and a 2D array/tensor is typically called a matrix.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain_x = array(train$x/255, c(dim(train$x), 1))\ntest_x = array(test$x/255, c(dim(test$x), 1))\ntrain_y = keras3::to_categorical(train$y)\ntest_y = keras3::to_categorical(test$y)\n```\n:::\n\n\nThe last dimension denotes the number of channels in the image. In our case we have only one channel because the images are black and white.\n\nMost times, we would have at least 3 color channels, for example RGB (red, green, blue) or HSV (hue, saturation, value), sometimes with several additional dimensions like transparency.\n\nTo build our convolutional model, we have to specify a kernel. In our case, we will use 16 convolutional kernels (filters) of size $2\\times2$. These are 2D kernels because our images are 2D. For movies for example, one would use 3D kernels (the third dimension would correspond to time and not to the color channels).\n\n::: panel-tabset\n## Keras\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel = keras_model_sequential(shape(28L, 28L, 1L))\nmodel |>\n layer_conv_2d(filters = 16L,\n               kernel_size = c(2L, 2L), activation = \"relu\") |>\n layer_max_pooling_2d() |>\n layer_conv_2d(filters = 16L, kernel_size = c(3L, 3L), activation = \"relu\") |>\n layer_max_pooling_2d() |>\n layer_flatten() |>\n layer_dense(100L, activation = \"relu\") |>\n layer_dense(10L, activation = \"softmax\")\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModel: \"sequential\"\n┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓\n┃ Layer (type)                      ┃ Output Shape             ┃       Param # ┃\n┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩\n│ conv2d (Conv2D)                   │ (None, 27, 27, 16)       │            80 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ max_pooling2d (MaxPooling2D)      │ (None, 13, 13, 16)       │             0 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ conv2d_1 (Conv2D)                 │ (None, 11, 11, 16)       │         2,320 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ max_pooling2d_1 (MaxPooling2D)    │ (None, 5, 5, 16)         │             0 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ flatten (Flatten)                 │ (None, 400)              │             0 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ dense (Dense)                     │ (None, 100)              │        40,100 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ dense_1 (Dense)                   │ (None, 10)               │         1,010 │\n└───────────────────────────────────┴──────────────────────────┴───────────────┘\n Total params: 43,510 (169.96 KB)\n Trainable params: 43,510 (169.96 KB)\n Non-trainable params: 0 (0.00 B)\n```\n:::\n\n```{.r .cell-code}\nplot(model)\n```\n\n::: {.cell-output-display}\n![](C3-ConvolutionalNeuralNetworks_files/figure-html/chunk_chapter5_13-1.png){width=192}\n:::\n:::\n\n\n## Torch\n\nPrepare/download data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(torch)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'torch'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:keras3':\n\n    as_iterator\n```\n:::\n\n```{.r .cell-code}\nlibrary(torchvision)\ntorch_manual_seed(321L)\nset.seed(123)\n\ntrain_ds = mnist_dataset(\n  \".\",\n  download = TRUE,\n  train = TRUE,\n  transform = transform_to_tensor\n)\n\ntest_ds = mnist_dataset(\n  \".\",\n  download = TRUE,\n  train = FALSE,\n  transform = transform_to_tensor\n)\n```\n:::\n\n\nBuild dataloader:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain_dl = dataloader(train_ds, batch_size = 32, shuffle = TRUE)\ntest_dl = dataloader(test_ds, batch_size = 32)\nfirst_batch = train_dl$.iter()\ndf = first_batch$.next()\n\ndf$x$size()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 32  1 28 28\n```\n:::\n:::\n\n\nBuild convolutional neural network: We have here to calculate the shapes of our layers on our own:\n\n**We start with our input of shape (batch_size, 1, 28, 28)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsample = df$x\nsample$size()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 32  1 28 28\n```\n:::\n:::\n\n\n**First convolutional layer has shape (input channel = 1, number of feature maps = 16, kernel size = 2)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconv1 = nn_conv2d(1, 16L, 2L, stride = 1L)\n(sample |> conv1())$size()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 32 16 27 27\n```\n:::\n:::\n\n\nOutput: batch_size = 32, number of feature maps = 16, dimensions of each feature map = $(27 , 27)$ Wit a kernel size of two and stride = 1 we will lose one pixel in each dimension... Questions:\n\n-   What happens if we increase the stride?\n-   What happens if we increase the kernel size?\n\n**Pooling layer summarizes each feature map**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(sample |> conv1() |> nnf_max_pool2d(kernel_size = 2L, stride = 2L))$size()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 32 16 13 13\n```\n:::\n:::\n\n\nkernel_size = 2L and stride = 2L halfs the pixel dimensions of our image.\n\n**Fully connected layer**\n\nNow we have to flatten our final output of the convolutional neural network model to use a normal fully connected layer, but to do so we have to calculate the number of inputs for the fully connected layer:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndims = (sample |> conv1() |>\n          nnf_max_pool2d(kernel_size = 2L, stride = 2L))$size()\n# Without the batch size of course.\nfinal = prod(dims[-1]) \nprint(final)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2704\n```\n:::\n\n```{.r .cell-code}\nfc = nn_linear(final, 10L)\n(sample |> conv1() |> nnf_max_pool2d(kernel_size = 2L, stride = 2L)\n  |> torch_flatten(start_dim = 2L) |> fc())$size()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 32 10\n```\n:::\n:::\n\n\nBuild the network:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnet = nn_module(\n  \"mnist\",\n  initialize = function(){\n    self$conv1 = nn_conv2d(1, 16L, 2L)\n    self$conv2 = nn_conv2d(16L, 16L, 3L)\n    self$fc1 = nn_linear(400L, 100L)\n    self$fc2 = nn_linear(100L, 10L)\n  },\n  forward = function(x){\n    x |>\n      self$conv1() |>\n      nnf_relu() |>\n      nnf_max_pool2d(2) |>\n      self$conv2() |>\n      nnf_relu() |>\n      nnf_max_pool2d(2) |>\n      torch_flatten(start_dim = 2) |>\n      self$fc1() |>\n      nnf_relu() |>\n      self$fc2()\n  }\n)\n```\n:::\n\n:::\n\nWe additionally used a pooling layer for downsizing the resulting feature maps. Without further specification, a $2\\times2$ pooling layer is taken automatically. Pooling layers take the input feature map and divide it into (in our case) parts of $2\\times2$ size. Then the respective pooling operation is executed. For every input map/layer, you get one (downsized) output map/layer.\n\nAs we are using the max pooling layer (there are sever other methods like the mean pooling), only the maximum value of these 4 parts is taken and forwarded further. Example input:\n\n```         \n1   2   |   5   8   |   3   6\n6   5   |   2   4   |   8   1\n------------------------------\n9   4   |   3   7   |   2   5\n0   3   |   2   7   |   4   9\n```\n\nWe use max pooling for every field:\n\n```         \nmax(1, 2, 6, 5)   |   max(5, 8, 2, 4)   |   max(3, 6, 8, 1)\n-----------------------------------------------------------\nmax(9, 4, 0, 3)   |   max(3, 7, 2, 7)   |   max(2, 5, 4, 9)\n```\n\nSo the resulting pooled information is:\n\n```         \n6   |   8   |   8\n------------------\n9   |   7   |   9\n```\n\nIn this example, a $4\\times6$ layer was transformed to a $2\\times3$ layer and thus downsized. This is similar to the biological process called *lateral inhibition* where active neurons inhibit the activity of neighboring neurons. It's a loss of information but often very useful for aggregating information and prevent overfitting.\n\nAfter another convolution and pooling layer, we flatten the output. This means that the following dense layer treats the previous layer as a full layer (so the dense layer is connected to all the weights from the last feature maps). You can think of this as transforming a matrix (2D) into a simple 1D vector. The full vector is then used. After flattening the layer, we can simply use our typical output layer.\n\n::: panel-tabset\n## Keras\n\nThe rest is as usual:\n\nFirst we compile the model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel |>\n  keras3::compile(\n      optimizer = keras3::optimizer_adamax(0.01),\n      loss = keras3::loss_categorical_crossentropy\n  )\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModel: \"sequential\"\n┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓\n┃ Layer (type)                      ┃ Output Shape             ┃       Param # ┃\n┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩\n│ conv2d (Conv2D)                   │ (None, 27, 27, 16)       │            80 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ max_pooling2d (MaxPooling2D)      │ (None, 13, 13, 16)       │             0 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ conv2d_1 (Conv2D)                 │ (None, 11, 11, 16)       │         2,320 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ max_pooling2d_1 (MaxPooling2D)    │ (None, 5, 5, 16)         │             0 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ flatten (Flatten)                 │ (None, 400)              │             0 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ dense (Dense)                     │ (None, 100)              │        40,100 │\n├───────────────────────────────────┼──────────────────────────┼───────────────┤\n│ dense_1 (Dense)                   │ (None, 10)               │         1,010 │\n└───────────────────────────────────┴──────────────────────────┴───────────────┘\n Total params: 43,510 (169.96 KB)\n Trainable params: 43,510 (169.96 KB)\n Non-trainable params: 0 (0.00 B)\n```\n:::\n:::\n\n\nThen, we train the model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tensorflow)\nlibrary(keras3)\n\nepochs = 5L\nbatch_size = 32L\nmodel |>\n  fit(\n    x = train_x, \n    y = train_y,\n    epochs = epochs,\n    batch_size = batch_size,\n    shuffle = TRUE,\n    validation_split = 0.2\n  )\n```\n:::\n\n\n## Torch\n\nTrain model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(torch)\ntorch_manual_seed(321L)\nset.seed(123)\n\nmodel_torch = net()\nopt = optim_adam(params = model_torch$parameters, lr = 0.01)\n\nfor(e in 1:3){\n  losses = c()\n  coro::loop(\n    for(batch in train_dl){\n      opt$zero_grad()\n      pred = model_torch(batch[[1]])\n      loss = nnf_cross_entropy(pred, batch[[2]], reduction = \"mean\")\n      loss$backward()\n      opt$step()\n      losses = c(losses, loss$item())\n    }\n  )\n  cat(sprintf(\"Loss at epoch %d: %3f\\n\", e, mean(losses)))\n}\n```\n:::\n\n\nEvaluation:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_torch$eval()\n\ntest_losses = c()\ntotal = 0\ncorrect = 0\n\ncoro::loop(\n  for(batch in test_dl){\n    output = model_torch(batch[[1]])\n    labels = batch[[2]]\n    loss = nnf_cross_entropy(output, labels)\n    test_losses = c(test_losses, loss$item())\n    predicted = torch_max(output$data(), dim = 2)[[2]]\n    total = total + labels$size(1)\n    correct = correct + (predicted == labels)$sum()$item()\n  }\n)\n\nmean(test_losses)\ntest_accuracy =  correct/total\ntest_accuracy\n```\n:::\n\n:::\n\n## Example CIFAR\n\nCIFAR10 is another famous image classification dataset. It consists of ten classes with colored images (see https://www.cs.toronto.edu/\\~kriz/cifar.html).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(keras3)\ndata = keras3::dataset_cifar10()\ntrain = data$train\ntest = data$test\nimage = train$x[1,,,]\nimage %>%  \n image_to_array() %>%\n `/`(., 255) %>%\n as.raster() %>%\n plot()\n## normalize pixel to 0-1\ntrain_x = array(train$x/255, c(dim(train$x)))\ntest_x = array(test$x/255, c(dim(test$x)))\ntrain_y = keras3::to_categorical(train$y)\ntest_y = keras3::to_categorical(test$y)\nmodel = keras_model_sequential(shape(32L, 32L,3L))\nmodel |> \n layer_conv_2d(input_shape = c(32L, 32L,3L),filters = 16L, kernel_size = c(2L,2L), activation = \"relu\") |> \n layer_max_pooling_2d() |> \n layer_dropout(0.3) |> \n layer_conv_2d(filters = 16L, kernel_size = c(3L,3L), activation = \"relu\") |> \n layer_max_pooling_2d() |> \n layer_flatten() |> \n layer_dense(10, activation = \"softmax\")\nsummary(model)\nmodel |> \n compile(\n optimizer = optimizer_adamax(),\n loss = keras3::loss_categorical_crossentropy\n )\nearly = callback_early_stopping(patience = 5L)\nepochs = 1L\nbatch_size =20L\nmodel |> fit(\n x = train_x, \n y = train_y,\n epochs = epochs,\n batch_size = batch_size,\n shuffle = TRUE,\n validation_split = 0.2,\n callbacks = c(early)\n)\n```\n:::\n\n\n## Exercise\n\n::: {.callout-caution icon=\"false\"}\n#### Task: CNN for flower dataset\n\nThe next exercise is based on the flower dataset in the Ecodata package.\n\nFollow the steps above and build your own convolutional neural network.\n\nFinally, submit your predictions to the submission server. If you have extra time, take a look at kaggle and find the flower dataset challenge for specific architectures tailored for this dataset.\n\nTasks:\n\n-   If you are unsure how do it, take a look at the solution and try to make the model more complex (e.g. add convolutional layers, regularization, etc.)\n-   Take a look at this [notebook from kaggle](https://www.kaggle.com/code/rajmehra03/flower-recognition-cnn-keras) , try to copy their architecture (it is the same dataset but upsized (i.e. more pixels, the only difference is the input dimension))\n\nPrepare data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tensorflow)\nlibrary(keras3)\n\ntrain = EcoData::dataset_flower()$train/255\ntest = EcoData::dataset_flower()$test/255\nlabels = EcoData::dataset_flower()$labels\n```\n:::\n\n\nPlot flower:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain[100,,,] |>\n  image_to_array() |>\n  as.raster() |>\n  plot()\n```\n\n::: {.cell-output-display}\n![](C3-ConvolutionalNeuralNetworks_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n**Tip:** Take a look at the dataset chapter.\n\n\n<div class='webex-solution'><button>Click here to see the solution for a minimal example</button>\n\n\nBuild model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel = keras_model_sequential(shape(80L, 80L, 3L))\nmodel |> \n  layer_conv_2d(filters = 4L, kernel_size = 2L) |> \n  layer_max_pooling_2d() |> \n  layer_flatten() |> \n  layer_dense(units = 5L, activation = \"softmax\")\n\n### Model fitting ###\n\nmodel |> \n  compile(loss = loss_categorical_crossentropy, \n          optimizer = optimizer_adamax(learning_rate = 0.01))\n\nmodel |> \n  fit(x = train, y = keras::k_one_hot(labels, 5L))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 methods overwritten by 'keras':\n  method                               from  \n  as.data.frame.keras_training_history keras3\n  plot.keras_training_history          keras3\n  print.keras_training_history         keras3\n  r_to_py.R6ClassGenerator             keras3\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n95/95 - 1s - 9ms/step - loss: 1.6725\n```\n:::\n:::\n\n\nPredictions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prediction on training data:\npred = apply(model |> predict(train), 1, which.max)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n95/95 - 0s - 3ms/step\n```\n:::\n\n```{.r .cell-code}\nMetrics::accuracy(pred - 1L, labels)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5858419\n```\n:::\n\n```{.r .cell-code}\ntable(pred)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npred\n  1   2   3   4   5 \n421 956 409 620 617 \n```\n:::\n\n```{.r .cell-code}\n# Prediction for the submission server:\npred = model |> predict(test) |> apply(1, which.max) - 1L\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n41/41 - 0s - 3ms/step\n```\n:::\n\n```{.r .cell-code}\ntable(pred)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npred\n  0   1   2   3   4 \n159 402 176 279 284 \n```\n:::\n:::\n\n\nSubmission:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(data.frame(y = pred), file = \"cnn.csv\")\n```\n:::\n\n\n\n</div>\n\n:::\n\n## Advanced Training Techniques\n\n### Data Augmentation\n\nHaving to train a convolutional neural network using very little data is a common problem. Data augmentation helps to artificially increase the number of images.\n\nThe idea is that a convolutional neural network learns specific structures such as edges from images. Rotating, adding noise, and zooming in and out will preserve the overall key structure we are interested in, but the model will see new images and has to search once again for the key structures.\n\nLuckily, it is very easy to use data augmentation in Keras.\n\nTo show this, we will use our flower data set. We have to define a generator object (a specific object which infinitely draws samples from our data set). In the generator we can turn on the data augmentation.\n\n::: panel-tabset\n## Keras\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreticulate::use_virtualenv(\"r-keras\")\nlibrary(keras3)\nlibrary(tensorflow)\nlibrary(tfdatasets)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'tfdatasets'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:torch':\n\n    as_iterator\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:keras3':\n\n    shape\n```\n:::\n\n```{.r .cell-code}\ndata = EcoData::dataset_flower()\ntrain = data$train/255\nlabels = data$labels\n\n\n# data augemention model\naug = keras_model_sequential()\naug |>\n  layer_random_flip() %>% \n  layer_random_rotation(factor = 1.0)\n\n# Prepare datasets\ndataset = tfdatasets::tensor_slices_dataset(list(train, to_categorical(labels)))\ndataset <- dataset %>%\n  dataset_map(function(x, y) list(aug(x), y))\n\nbatch_size <- 64\n\ntrain_ds <- dataset |>\n  dataset_batch(batch_size) |>\n  dataset_prefetch() %>% \n  dataset_prefetch(buffer_size = tf$data$AUTOTUNE)\n\n# test!\nbatch <- train_ds |>\n  dataset_take(1) |>\n  as_iterator() |>\n  iter_next()\n\nas.array(batch[[1]][1,,,]) |>\n  image_to_array() |>\n  as.raster() |>\n  plot()\n```\n\n::: {.cell-output-display}\n![](C3-ConvolutionalNeuralNetworks_files/figure-html/chunk_chapter5_25-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# model fitting\nmodel = keras_model_sequential(shape(80L, 80L, 3L))\nmodel |> \n  layer_conv_2d(filters = 4L, kernel_size = 2L) |> \n  layer_max_pooling_2d() |> \n  layer_flatten() |> \n  layer_dense(units = 5L, activation = \"softmax\")\n\n\nmodel |>\n  keras3::compile(loss = keras3::loss_categorical_crossentropy,\n                  optimizer = keras3::optimizer_adamax(learning_rate = 0.01))\n\n\nmodel %>% fit(train_ds, epochs = 2L)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEpoch 1/2\n48/48 - 2s - 51ms/step - loss: 15.8788\nEpoch 2/2\n48/48 - 2s - 51ms/step - loss: 25.0211\n```\n:::\n:::\n\n\nUsing data augmentation we can artificially increase the number of images.\n\n## Torch\n\nIn Torch, we have to change the transform function (but only for the train dataloader):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(torch)\ntorch_manual_seed(321L)\nset.seed(123)\n\ntrain_transforms = function(img){\n  img |>\n    transform_to_tensor() |>\n    transform_random_horizontal_flip(p = 0.3) |>\n    transform_random_resized_crop(size = c(28L, 28L)) |>\n    transform_random_vertical_flip(0.3)\n}\n\ntrain_ds = mnist_dataset(\".\", download = TRUE, train = TRUE,\n                         transform = train_transforms)\ntest_ds = mnist_dataset(\".\", download = TRUE, train = FALSE,\n                        transform = transform_to_tensor)\n\ntrain_dl = dataloader(train_ds, batch_size = 100L, shuffle = TRUE)\ntest_dl = dataloader(test_ds, batch_size = 100L)\n\nmodel_torch = net()\nopt = optim_adam(params = model_torch$parameters, lr = 0.01)\n\nfor(e in 1:1){\n  losses = c()\n  coro::loop(\n    for(batch in train_dl){\n      opt$zero_grad()\n      pred = model_torch(batch[[1]])\n      loss = nnf_cross_entropy(pred, batch[[2]], reduction = \"mean\")\n      loss$backward()\n      opt$step()\n      losses = c(losses, loss$item())\n    }\n  )\n  \n  cat(sprintf(\"Loss at epoch %d: %3f\\n\", e, mean(losses)))\n}\n\nmodel_torch$eval()\n\ntest_losses = c()\ntotal = 0\ncorrect = 0\n\ncoro::loop(\n  for(batch in test_dl){\n    output = model_torch(batch[[1]])\n    labels = batch[[2]]\n    loss = nnf_cross_entropy(output, labels)\n    test_losses = c(test_losses, loss$item())\n    predicted = torch_max(output$data(), dim = 2)[[2]]\n    total = total + labels$size(1)\n    correct = correct + (predicted == labels)$sum()$item()\n  }\n)\n\ntest_accuracy =  correct/total\nprint(test_accuracy)\n```\n:::\n\n:::\n\n### Transfer Learning {#sec-transfer}\n\nAnother approach to reduce the necessary number of images or to speed up convergence of the models is the use of transfer learning.\n\nThe main idea of transfer learning is that all the convolutional layers have mainly one task - learning to identify highly correlated neighboring features. This knowledge is then used for new tasks. The convolutional layers learn structures such as edges in images and only the top layer, the dense layer is the actual classifier of the convolutional neural network for a specific task. Thus, one could think that we could only train the top layer as classifier. To do so, it will be confronted by sets of different edges/structures and has to decide the label based on these.\n\nAgain, this sounds very complicated but it is again quite easy with Keras and Torch.\n\n::: panel-tabset\n## Keras\n\nWe will do this now with the CIFAR10 data set, so we have to prepare the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tensorflow)\nlibrary(keras3)\n\ndata = keras3::dataset_cifar10()\ntrain = data$train\ntest = data$test\n\nrm(data)\n\nimage = train$x[5,,,]\nimage %>%\n  image_to_array() %>% \n  `/`(., 255) %>%\n  as.raster() %>%\n  plot()\n```\n\n::: {.cell-output-display}\n![](C3-ConvolutionalNeuralNetworks_files/figure-html/chunk_chapter5_27-1.png){width=672}\n:::\n\n```{.r .cell-code}\ntrain_x = array(train$x/255, c(dim(train$x)))\ntest_x = array(test$x/255, c(dim(test$x)))\ntrain_y = keras3::to_categorical(train$y)\ntest_y = keras3::to_categorical(test$y)\n\nrm(train, test)\n```\n:::\n\n\nKeras provides download functions for all famous architectures/convolutional neural network models which are already trained on the imagenet data set (another famous data set). These trained networks come already without their top layer, so we have to set include_top to false and change the input shape.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndensenet = keras3::application_densenet201(include_top = FALSE,\n                                   input_shape  = c(32L, 32L, 3L))\n```\n:::\n\n\nNow, we will not use a sequential model but just a \"keras_model\" where we can specify the inputs and outputs. Thereby, the output is our own top layer, but the inputs are the densenet inputs, as these are already pre-trained.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel = keras3::keras_model(\n  inputs = densenet$input,\n  outputs = layer_flatten(\n    layer_dense(densenet$output, units = 10L, activation = \"softmax\")\n  )\n)\n\n# Notice that this snippet just creates one (!) new layer.\n# The densenet's inputs are connected with the model's inputs.\n# The densenet's outputs are connected with our own layer (with 10 nodes).\n# This layer is also the output layer of the model.\n```\n:::\n\n\nIn the next step we want to freeze all layers except for our own last layer. Freezing means that these are not trained: We do not want to train the complete model, we only want to train the last layer. You can check the number of trainable weights via summary(model).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel |> keras3::freeze_weights(from = 1, to = length(model$layers) - 2)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModel: \"functional_17\"\n┏━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━┓\n┃ Layer (type)       ┃ Output Shape     ┃    Param # ┃ Connected to    ┃ Trai… ┃\n┡━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━┩\n│ input_layer_4      │ (None, 32, 32,   │          0 │ -               │   -   │\n│ (InputLayer)       │ 3)               │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ zero_padding2d     │ (None, 38, 38,   │          0 │ input_layer_4[… │   -   │\n│ (ZeroPadding2D)    │ 3)               │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv1_conv         │ (None, 16, 16,   │      9,408 │ zero_padding2d… │   N   │\n│ (Conv2D)           │ 64)              │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv1_bn           │ (None, 16, 16,   │        256 │ conv1_conv[0][… │   N   │\n│ (BatchNormalizati… │ 64)              │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv1_relu         │ (None, 16, 16,   │          0 │ conv1_bn[0][0]  │   -   │\n│ (Activation)       │ 64)              │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ zero_padding2d_1   │ (None, 18, 18,   │          0 │ conv1_relu[0][… │   -   │\n│ (ZeroPadding2D)    │ 64)              │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool1              │ (None, 8, 8, 64) │          0 │ zero_padding2d… │   -   │\n│ (MaxPooling2D)     │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block1_0_bn  │ (None, 8, 8, 64) │        256 │ pool1[0][0]     │   N   │\n│ (BatchNormalizati… │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block1_0_re… │ (None, 8, 8, 64) │          0 │ conv2_block1_0… │   -   │\n│ (Activation)       │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block1_1_co… │ (None, 8, 8,     │      8,192 │ conv2_block1_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block1_1_bn  │ (None, 8, 8,     │        512 │ conv2_block1_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block1_1_re… │ (None, 8, 8,     │          0 │ conv2_block1_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block1_2_co… │ (None, 8, 8, 32) │     36,864 │ conv2_block1_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block1_conc… │ (None, 8, 8, 96) │          0 │ pool1[0][0],    │   -   │\n│ (Concatenate)      │                  │            │ conv2_block1_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block2_0_bn  │ (None, 8, 8, 96) │        384 │ conv2_block1_c… │   N   │\n│ (BatchNormalizati… │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block2_0_re… │ (None, 8, 8, 96) │          0 │ conv2_block2_0… │   -   │\n│ (Activation)       │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block2_1_co… │ (None, 8, 8,     │     12,288 │ conv2_block2_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block2_1_bn  │ (None, 8, 8,     │        512 │ conv2_block2_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block2_1_re… │ (None, 8, 8,     │          0 │ conv2_block2_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block2_2_co… │ (None, 8, 8, 32) │     36,864 │ conv2_block2_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block2_conc… │ (None, 8, 8,     │          0 │ conv2_block1_c… │   -   │\n│ (Concatenate)      │ 128)             │            │ conv2_block2_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block3_0_bn  │ (None, 8, 8,     │        512 │ conv2_block2_c… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block3_0_re… │ (None, 8, 8,     │          0 │ conv2_block3_0… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block3_1_co… │ (None, 8, 8,     │     16,384 │ conv2_block3_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block3_1_bn  │ (None, 8, 8,     │        512 │ conv2_block3_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block3_1_re… │ (None, 8, 8,     │          0 │ conv2_block3_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block3_2_co… │ (None, 8, 8, 32) │     36,864 │ conv2_block3_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block3_conc… │ (None, 8, 8,     │          0 │ conv2_block2_c… │   -   │\n│ (Concatenate)      │ 160)             │            │ conv2_block3_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block4_0_bn  │ (None, 8, 8,     │        640 │ conv2_block3_c… │   N   │\n│ (BatchNormalizati… │ 160)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block4_0_re… │ (None, 8, 8,     │          0 │ conv2_block4_0… │   -   │\n│ (Activation)       │ 160)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block4_1_co… │ (None, 8, 8,     │     20,480 │ conv2_block4_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block4_1_bn  │ (None, 8, 8,     │        512 │ conv2_block4_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block4_1_re… │ (None, 8, 8,     │          0 │ conv2_block4_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block4_2_co… │ (None, 8, 8, 32) │     36,864 │ conv2_block4_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block4_conc… │ (None, 8, 8,     │          0 │ conv2_block3_c… │   -   │\n│ (Concatenate)      │ 192)             │            │ conv2_block4_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block5_0_bn  │ (None, 8, 8,     │        768 │ conv2_block4_c… │   N   │\n│ (BatchNormalizati… │ 192)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block5_0_re… │ (None, 8, 8,     │          0 │ conv2_block5_0… │   -   │\n│ (Activation)       │ 192)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block5_1_co… │ (None, 8, 8,     │     24,576 │ conv2_block5_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block5_1_bn  │ (None, 8, 8,     │        512 │ conv2_block5_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block5_1_re… │ (None, 8, 8,     │          0 │ conv2_block5_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block5_2_co… │ (None, 8, 8, 32) │     36,864 │ conv2_block5_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block5_conc… │ (None, 8, 8,     │          0 │ conv2_block4_c… │   -   │\n│ (Concatenate)      │ 224)             │            │ conv2_block5_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block6_0_bn  │ (None, 8, 8,     │        896 │ conv2_block5_c… │   N   │\n│ (BatchNormalizati… │ 224)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block6_0_re… │ (None, 8, 8,     │          0 │ conv2_block6_0… │   -   │\n│ (Activation)       │ 224)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block6_1_co… │ (None, 8, 8,     │     28,672 │ conv2_block6_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block6_1_bn  │ (None, 8, 8,     │        512 │ conv2_block6_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block6_1_re… │ (None, 8, 8,     │          0 │ conv2_block6_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block6_2_co… │ (None, 8, 8, 32) │     36,864 │ conv2_block6_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv2_block6_conc… │ (None, 8, 8,     │          0 │ conv2_block5_c… │   -   │\n│ (Concatenate)      │ 256)             │            │ conv2_block6_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool2_bn           │ (None, 8, 8,     │      1,024 │ conv2_block6_c… │   N   │\n│ (BatchNormalizati… │ 256)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool2_relu         │ (None, 8, 8,     │          0 │ pool2_bn[0][0]  │   -   │\n│ (Activation)       │ 256)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool2_conv         │ (None, 8, 8,     │     32,768 │ pool2_relu[0][… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool2_pool         │ (None, 4, 4,     │          0 │ pool2_conv[0][… │   -   │\n│ (AveragePooling2D) │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block1_0_bn  │ (None, 4, 4,     │        512 │ pool2_pool[0][… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block1_0_re… │ (None, 4, 4,     │          0 │ conv3_block1_0… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block1_1_co… │ (None, 4, 4,     │     16,384 │ conv3_block1_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block1_1_bn  │ (None, 4, 4,     │        512 │ conv3_block1_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block1_1_re… │ (None, 4, 4,     │          0 │ conv3_block1_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block1_2_co… │ (None, 4, 4, 32) │     36,864 │ conv3_block1_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block1_conc… │ (None, 4, 4,     │          0 │ pool2_pool[0][… │   -   │\n│ (Concatenate)      │ 160)             │            │ conv3_block1_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block2_0_bn  │ (None, 4, 4,     │        640 │ conv3_block1_c… │   N   │\n│ (BatchNormalizati… │ 160)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block2_0_re… │ (None, 4, 4,     │          0 │ conv3_block2_0… │   -   │\n│ (Activation)       │ 160)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block2_1_co… │ (None, 4, 4,     │     20,480 │ conv3_block2_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block2_1_bn  │ (None, 4, 4,     │        512 │ conv3_block2_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block2_1_re… │ (None, 4, 4,     │          0 │ conv3_block2_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block2_2_co… │ (None, 4, 4, 32) │     36,864 │ conv3_block2_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block2_conc… │ (None, 4, 4,     │          0 │ conv3_block1_c… │   -   │\n│ (Concatenate)      │ 192)             │            │ conv3_block2_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block3_0_bn  │ (None, 4, 4,     │        768 │ conv3_block2_c… │   N   │\n│ (BatchNormalizati… │ 192)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block3_0_re… │ (None, 4, 4,     │          0 │ conv3_block3_0… │   -   │\n│ (Activation)       │ 192)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block3_1_co… │ (None, 4, 4,     │     24,576 │ conv3_block3_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block3_1_bn  │ (None, 4, 4,     │        512 │ conv3_block3_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block3_1_re… │ (None, 4, 4,     │          0 │ conv3_block3_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block3_2_co… │ (None, 4, 4, 32) │     36,864 │ conv3_block3_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block3_conc… │ (None, 4, 4,     │          0 │ conv3_block2_c… │   -   │\n│ (Concatenate)      │ 224)             │            │ conv3_block3_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block4_0_bn  │ (None, 4, 4,     │        896 │ conv3_block3_c… │   N   │\n│ (BatchNormalizati… │ 224)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block4_0_re… │ (None, 4, 4,     │          0 │ conv3_block4_0… │   -   │\n│ (Activation)       │ 224)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block4_1_co… │ (None, 4, 4,     │     28,672 │ conv3_block4_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block4_1_bn  │ (None, 4, 4,     │        512 │ conv3_block4_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block4_1_re… │ (None, 4, 4,     │          0 │ conv3_block4_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block4_2_co… │ (None, 4, 4, 32) │     36,864 │ conv3_block4_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block4_conc… │ (None, 4, 4,     │          0 │ conv3_block3_c… │   -   │\n│ (Concatenate)      │ 256)             │            │ conv3_block4_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block5_0_bn  │ (None, 4, 4,     │      1,024 │ conv3_block4_c… │   N   │\n│ (BatchNormalizati… │ 256)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block5_0_re… │ (None, 4, 4,     │          0 │ conv3_block5_0… │   -   │\n│ (Activation)       │ 256)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block5_1_co… │ (None, 4, 4,     │     32,768 │ conv3_block5_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block5_1_bn  │ (None, 4, 4,     │        512 │ conv3_block5_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block5_1_re… │ (None, 4, 4,     │          0 │ conv3_block5_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block5_2_co… │ (None, 4, 4, 32) │     36,864 │ conv3_block5_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block5_conc… │ (None, 4, 4,     │          0 │ conv3_block4_c… │   -   │\n│ (Concatenate)      │ 288)             │            │ conv3_block5_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block6_0_bn  │ (None, 4, 4,     │      1,152 │ conv3_block5_c… │   N   │\n│ (BatchNormalizati… │ 288)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block6_0_re… │ (None, 4, 4,     │          0 │ conv3_block6_0… │   -   │\n│ (Activation)       │ 288)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block6_1_co… │ (None, 4, 4,     │     36,864 │ conv3_block6_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block6_1_bn  │ (None, 4, 4,     │        512 │ conv3_block6_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block6_1_re… │ (None, 4, 4,     │          0 │ conv3_block6_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block6_2_co… │ (None, 4, 4, 32) │     36,864 │ conv3_block6_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block6_conc… │ (None, 4, 4,     │          0 │ conv3_block5_c… │   -   │\n│ (Concatenate)      │ 320)             │            │ conv3_block6_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block7_0_bn  │ (None, 4, 4,     │      1,280 │ conv3_block6_c… │   N   │\n│ (BatchNormalizati… │ 320)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block7_0_re… │ (None, 4, 4,     │          0 │ conv3_block7_0… │   -   │\n│ (Activation)       │ 320)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block7_1_co… │ (None, 4, 4,     │     40,960 │ conv3_block7_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block7_1_bn  │ (None, 4, 4,     │        512 │ conv3_block7_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block7_1_re… │ (None, 4, 4,     │          0 │ conv3_block7_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block7_2_co… │ (None, 4, 4, 32) │     36,864 │ conv3_block7_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block7_conc… │ (None, 4, 4,     │          0 │ conv3_block6_c… │   -   │\n│ (Concatenate)      │ 352)             │            │ conv3_block7_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block8_0_bn  │ (None, 4, 4,     │      1,408 │ conv3_block7_c… │   N   │\n│ (BatchNormalizati… │ 352)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block8_0_re… │ (None, 4, 4,     │          0 │ conv3_block8_0… │   -   │\n│ (Activation)       │ 352)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block8_1_co… │ (None, 4, 4,     │     45,056 │ conv3_block8_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block8_1_bn  │ (None, 4, 4,     │        512 │ conv3_block8_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block8_1_re… │ (None, 4, 4,     │          0 │ conv3_block8_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block8_2_co… │ (None, 4, 4, 32) │     36,864 │ conv3_block8_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block8_conc… │ (None, 4, 4,     │          0 │ conv3_block7_c… │   -   │\n│ (Concatenate)      │ 384)             │            │ conv3_block8_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block9_0_bn  │ (None, 4, 4,     │      1,536 │ conv3_block8_c… │   N   │\n│ (BatchNormalizati… │ 384)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block9_0_re… │ (None, 4, 4,     │          0 │ conv3_block9_0… │   -   │\n│ (Activation)       │ 384)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block9_1_co… │ (None, 4, 4,     │     49,152 │ conv3_block9_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block9_1_bn  │ (None, 4, 4,     │        512 │ conv3_block9_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block9_1_re… │ (None, 4, 4,     │          0 │ conv3_block9_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block9_2_co… │ (None, 4, 4, 32) │     36,864 │ conv3_block9_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block9_conc… │ (None, 4, 4,     │          0 │ conv3_block8_c… │   -   │\n│ (Concatenate)      │ 416)             │            │ conv3_block9_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block10_0_bn │ (None, 4, 4,     │      1,664 │ conv3_block9_c… │   N   │\n│ (BatchNormalizati… │ 416)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block10_0_r… │ (None, 4, 4,     │          0 │ conv3_block10_… │   -   │\n│ (Activation)       │ 416)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block10_1_c… │ (None, 4, 4,     │     53,248 │ conv3_block10_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block10_1_bn │ (None, 4, 4,     │        512 │ conv3_block10_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block10_1_r… │ (None, 4, 4,     │          0 │ conv3_block10_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block10_2_c… │ (None, 4, 4, 32) │     36,864 │ conv3_block10_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block10_con… │ (None, 4, 4,     │          0 │ conv3_block9_c… │   -   │\n│ (Concatenate)      │ 448)             │            │ conv3_block10_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block11_0_bn │ (None, 4, 4,     │      1,792 │ conv3_block10_… │   N   │\n│ (BatchNormalizati… │ 448)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block11_0_r… │ (None, 4, 4,     │          0 │ conv3_block11_… │   -   │\n│ (Activation)       │ 448)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block11_1_c… │ (None, 4, 4,     │     57,344 │ conv3_block11_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block11_1_bn │ (None, 4, 4,     │        512 │ conv3_block11_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block11_1_r… │ (None, 4, 4,     │          0 │ conv3_block11_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block11_2_c… │ (None, 4, 4, 32) │     36,864 │ conv3_block11_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block11_con… │ (None, 4, 4,     │          0 │ conv3_block10_… │   -   │\n│ (Concatenate)      │ 480)             │            │ conv3_block11_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block12_0_bn │ (None, 4, 4,     │      1,920 │ conv3_block11_… │   N   │\n│ (BatchNormalizati… │ 480)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block12_0_r… │ (None, 4, 4,     │          0 │ conv3_block12_… │   -   │\n│ (Activation)       │ 480)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block12_1_c… │ (None, 4, 4,     │     61,440 │ conv3_block12_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block12_1_bn │ (None, 4, 4,     │        512 │ conv3_block12_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block12_1_r… │ (None, 4, 4,     │          0 │ conv3_block12_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block12_2_c… │ (None, 4, 4, 32) │     36,864 │ conv3_block12_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv3_block12_con… │ (None, 4, 4,     │          0 │ conv3_block11_… │   -   │\n│ (Concatenate)      │ 512)             │            │ conv3_block12_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool3_bn           │ (None, 4, 4,     │      2,048 │ conv3_block12_… │   N   │\n│ (BatchNormalizati… │ 512)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool3_relu         │ (None, 4, 4,     │          0 │ pool3_bn[0][0]  │   -   │\n│ (Activation)       │ 512)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool3_conv         │ (None, 4, 4,     │    131,072 │ pool3_relu[0][… │   N   │\n│ (Conv2D)           │ 256)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool3_pool         │ (None, 2, 2,     │          0 │ pool3_conv[0][… │   -   │\n│ (AveragePooling2D) │ 256)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block1_0_bn  │ (None, 2, 2,     │      1,024 │ pool3_pool[0][… │   N   │\n│ (BatchNormalizati… │ 256)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block1_0_re… │ (None, 2, 2,     │          0 │ conv4_block1_0… │   -   │\n│ (Activation)       │ 256)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block1_1_co… │ (None, 2, 2,     │     32,768 │ conv4_block1_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block1_1_bn  │ (None, 2, 2,     │        512 │ conv4_block1_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block1_1_re… │ (None, 2, 2,     │          0 │ conv4_block1_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block1_2_co… │ (None, 2, 2, 32) │     36,864 │ conv4_block1_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block1_conc… │ (None, 2, 2,     │          0 │ pool3_pool[0][… │   -   │\n│ (Concatenate)      │ 288)             │            │ conv4_block1_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block2_0_bn  │ (None, 2, 2,     │      1,152 │ conv4_block1_c… │   N   │\n│ (BatchNormalizati… │ 288)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block2_0_re… │ (None, 2, 2,     │          0 │ conv4_block2_0… │   -   │\n│ (Activation)       │ 288)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block2_1_co… │ (None, 2, 2,     │     36,864 │ conv4_block2_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block2_1_bn  │ (None, 2, 2,     │        512 │ conv4_block2_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block2_1_re… │ (None, 2, 2,     │          0 │ conv4_block2_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block2_2_co… │ (None, 2, 2, 32) │     36,864 │ conv4_block2_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block2_conc… │ (None, 2, 2,     │          0 │ conv4_block1_c… │   -   │\n│ (Concatenate)      │ 320)             │            │ conv4_block2_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block3_0_bn  │ (None, 2, 2,     │      1,280 │ conv4_block2_c… │   N   │\n│ (BatchNormalizati… │ 320)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block3_0_re… │ (None, 2, 2,     │          0 │ conv4_block3_0… │   -   │\n│ (Activation)       │ 320)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block3_1_co… │ (None, 2, 2,     │     40,960 │ conv4_block3_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block3_1_bn  │ (None, 2, 2,     │        512 │ conv4_block3_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block3_1_re… │ (None, 2, 2,     │          0 │ conv4_block3_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block3_2_co… │ (None, 2, 2, 32) │     36,864 │ conv4_block3_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block3_conc… │ (None, 2, 2,     │          0 │ conv4_block2_c… │   -   │\n│ (Concatenate)      │ 352)             │            │ conv4_block3_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block4_0_bn  │ (None, 2, 2,     │      1,408 │ conv4_block3_c… │   N   │\n│ (BatchNormalizati… │ 352)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block4_0_re… │ (None, 2, 2,     │          0 │ conv4_block4_0… │   -   │\n│ (Activation)       │ 352)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block4_1_co… │ (None, 2, 2,     │     45,056 │ conv4_block4_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block4_1_bn  │ (None, 2, 2,     │        512 │ conv4_block4_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block4_1_re… │ (None, 2, 2,     │          0 │ conv4_block4_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block4_2_co… │ (None, 2, 2, 32) │     36,864 │ conv4_block4_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block4_conc… │ (None, 2, 2,     │          0 │ conv4_block3_c… │   -   │\n│ (Concatenate)      │ 384)             │            │ conv4_block4_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block5_0_bn  │ (None, 2, 2,     │      1,536 │ conv4_block4_c… │   N   │\n│ (BatchNormalizati… │ 384)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block5_0_re… │ (None, 2, 2,     │          0 │ conv4_block5_0… │   -   │\n│ (Activation)       │ 384)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block5_1_co… │ (None, 2, 2,     │     49,152 │ conv4_block5_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block5_1_bn  │ (None, 2, 2,     │        512 │ conv4_block5_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block5_1_re… │ (None, 2, 2,     │          0 │ conv4_block5_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block5_2_co… │ (None, 2, 2, 32) │     36,864 │ conv4_block5_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block5_conc… │ (None, 2, 2,     │          0 │ conv4_block4_c… │   -   │\n│ (Concatenate)      │ 416)             │            │ conv4_block5_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block6_0_bn  │ (None, 2, 2,     │      1,664 │ conv4_block5_c… │   N   │\n│ (BatchNormalizati… │ 416)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block6_0_re… │ (None, 2, 2,     │          0 │ conv4_block6_0… │   -   │\n│ (Activation)       │ 416)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block6_1_co… │ (None, 2, 2,     │     53,248 │ conv4_block6_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block6_1_bn  │ (None, 2, 2,     │        512 │ conv4_block6_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block6_1_re… │ (None, 2, 2,     │          0 │ conv4_block6_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block6_2_co… │ (None, 2, 2, 32) │     36,864 │ conv4_block6_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block6_conc… │ (None, 2, 2,     │          0 │ conv4_block5_c… │   -   │\n│ (Concatenate)      │ 448)             │            │ conv4_block6_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block7_0_bn  │ (None, 2, 2,     │      1,792 │ conv4_block6_c… │   N   │\n│ (BatchNormalizati… │ 448)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block7_0_re… │ (None, 2, 2,     │          0 │ conv4_block7_0… │   -   │\n│ (Activation)       │ 448)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block7_1_co… │ (None, 2, 2,     │     57,344 │ conv4_block7_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block7_1_bn  │ (None, 2, 2,     │        512 │ conv4_block7_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block7_1_re… │ (None, 2, 2,     │          0 │ conv4_block7_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block7_2_co… │ (None, 2, 2, 32) │     36,864 │ conv4_block7_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block7_conc… │ (None, 2, 2,     │          0 │ conv4_block6_c… │   -   │\n│ (Concatenate)      │ 480)             │            │ conv4_block7_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block8_0_bn  │ (None, 2, 2,     │      1,920 │ conv4_block7_c… │   N   │\n│ (BatchNormalizati… │ 480)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block8_0_re… │ (None, 2, 2,     │          0 │ conv4_block8_0… │   -   │\n│ (Activation)       │ 480)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block8_1_co… │ (None, 2, 2,     │     61,440 │ conv4_block8_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block8_1_bn  │ (None, 2, 2,     │        512 │ conv4_block8_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block8_1_re… │ (None, 2, 2,     │          0 │ conv4_block8_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block8_2_co… │ (None, 2, 2, 32) │     36,864 │ conv4_block8_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block8_conc… │ (None, 2, 2,     │          0 │ conv4_block7_c… │   -   │\n│ (Concatenate)      │ 512)             │            │ conv4_block8_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block9_0_bn  │ (None, 2, 2,     │      2,048 │ conv4_block8_c… │   N   │\n│ (BatchNormalizati… │ 512)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block9_0_re… │ (None, 2, 2,     │          0 │ conv4_block9_0… │   -   │\n│ (Activation)       │ 512)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block9_1_co… │ (None, 2, 2,     │     65,536 │ conv4_block9_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block9_1_bn  │ (None, 2, 2,     │        512 │ conv4_block9_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block9_1_re… │ (None, 2, 2,     │          0 │ conv4_block9_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block9_2_co… │ (None, 2, 2, 32) │     36,864 │ conv4_block9_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block9_conc… │ (None, 2, 2,     │          0 │ conv4_block8_c… │   -   │\n│ (Concatenate)      │ 544)             │            │ conv4_block9_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block10_0_bn │ (None, 2, 2,     │      2,176 │ conv4_block9_c… │   N   │\n│ (BatchNormalizati… │ 544)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block10_0_r… │ (None, 2, 2,     │          0 │ conv4_block10_… │   -   │\n│ (Activation)       │ 544)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block10_1_c… │ (None, 2, 2,     │     69,632 │ conv4_block10_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block10_1_bn │ (None, 2, 2,     │        512 │ conv4_block10_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block10_1_r… │ (None, 2, 2,     │          0 │ conv4_block10_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block10_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block10_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block10_con… │ (None, 2, 2,     │          0 │ conv4_block9_c… │   -   │\n│ (Concatenate)      │ 576)             │            │ conv4_block10_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block11_0_bn │ (None, 2, 2,     │      2,304 │ conv4_block10_… │   N   │\n│ (BatchNormalizati… │ 576)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block11_0_r… │ (None, 2, 2,     │          0 │ conv4_block11_… │   -   │\n│ (Activation)       │ 576)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block11_1_c… │ (None, 2, 2,     │     73,728 │ conv4_block11_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block11_1_bn │ (None, 2, 2,     │        512 │ conv4_block11_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block11_1_r… │ (None, 2, 2,     │          0 │ conv4_block11_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block11_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block11_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block11_con… │ (None, 2, 2,     │          0 │ conv4_block10_… │   -   │\n│ (Concatenate)      │ 608)             │            │ conv4_block11_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block12_0_bn │ (None, 2, 2,     │      2,432 │ conv4_block11_… │   N   │\n│ (BatchNormalizati… │ 608)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block12_0_r… │ (None, 2, 2,     │          0 │ conv4_block12_… │   -   │\n│ (Activation)       │ 608)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block12_1_c… │ (None, 2, 2,     │     77,824 │ conv4_block12_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block12_1_bn │ (None, 2, 2,     │        512 │ conv4_block12_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block12_1_r… │ (None, 2, 2,     │          0 │ conv4_block12_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block12_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block12_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block12_con… │ (None, 2, 2,     │          0 │ conv4_block11_… │   -   │\n│ (Concatenate)      │ 640)             │            │ conv4_block12_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block13_0_bn │ (None, 2, 2,     │      2,560 │ conv4_block12_… │   N   │\n│ (BatchNormalizati… │ 640)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block13_0_r… │ (None, 2, 2,     │          0 │ conv4_block13_… │   -   │\n│ (Activation)       │ 640)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block13_1_c… │ (None, 2, 2,     │     81,920 │ conv4_block13_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block13_1_bn │ (None, 2, 2,     │        512 │ conv4_block13_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block13_1_r… │ (None, 2, 2,     │          0 │ conv4_block13_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block13_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block13_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block13_con… │ (None, 2, 2,     │          0 │ conv4_block12_… │   -   │\n│ (Concatenate)      │ 672)             │            │ conv4_block13_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block14_0_bn │ (None, 2, 2,     │      2,688 │ conv4_block13_… │   N   │\n│ (BatchNormalizati… │ 672)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block14_0_r… │ (None, 2, 2,     │          0 │ conv4_block14_… │   -   │\n│ (Activation)       │ 672)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block14_1_c… │ (None, 2, 2,     │     86,016 │ conv4_block14_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block14_1_bn │ (None, 2, 2,     │        512 │ conv4_block14_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block14_1_r… │ (None, 2, 2,     │          0 │ conv4_block14_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block14_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block14_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block14_con… │ (None, 2, 2,     │          0 │ conv4_block13_… │   -   │\n│ (Concatenate)      │ 704)             │            │ conv4_block14_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block15_0_bn │ (None, 2, 2,     │      2,816 │ conv4_block14_… │   N   │\n│ (BatchNormalizati… │ 704)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block15_0_r… │ (None, 2, 2,     │          0 │ conv4_block15_… │   -   │\n│ (Activation)       │ 704)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block15_1_c… │ (None, 2, 2,     │     90,112 │ conv4_block15_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block15_1_bn │ (None, 2, 2,     │        512 │ conv4_block15_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block15_1_r… │ (None, 2, 2,     │          0 │ conv4_block15_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block15_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block15_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block15_con… │ (None, 2, 2,     │          0 │ conv4_block14_… │   -   │\n│ (Concatenate)      │ 736)             │            │ conv4_block15_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block16_0_bn │ (None, 2, 2,     │      2,944 │ conv4_block15_… │   N   │\n│ (BatchNormalizati… │ 736)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block16_0_r… │ (None, 2, 2,     │          0 │ conv4_block16_… │   -   │\n│ (Activation)       │ 736)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block16_1_c… │ (None, 2, 2,     │     94,208 │ conv4_block16_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block16_1_bn │ (None, 2, 2,     │        512 │ conv4_block16_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block16_1_r… │ (None, 2, 2,     │          0 │ conv4_block16_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block16_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block16_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block16_con… │ (None, 2, 2,     │          0 │ conv4_block15_… │   -   │\n│ (Concatenate)      │ 768)             │            │ conv4_block16_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block17_0_bn │ (None, 2, 2,     │      3,072 │ conv4_block16_… │   N   │\n│ (BatchNormalizati… │ 768)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block17_0_r… │ (None, 2, 2,     │          0 │ conv4_block17_… │   -   │\n│ (Activation)       │ 768)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block17_1_c… │ (None, 2, 2,     │     98,304 │ conv4_block17_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block17_1_bn │ (None, 2, 2,     │        512 │ conv4_block17_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block17_1_r… │ (None, 2, 2,     │          0 │ conv4_block17_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block17_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block17_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block17_con… │ (None, 2, 2,     │          0 │ conv4_block16_… │   -   │\n│ (Concatenate)      │ 800)             │            │ conv4_block17_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block18_0_bn │ (None, 2, 2,     │      3,200 │ conv4_block17_… │   N   │\n│ (BatchNormalizati… │ 800)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block18_0_r… │ (None, 2, 2,     │          0 │ conv4_block18_… │   -   │\n│ (Activation)       │ 800)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block18_1_c… │ (None, 2, 2,     │    102,400 │ conv4_block18_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block18_1_bn │ (None, 2, 2,     │        512 │ conv4_block18_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block18_1_r… │ (None, 2, 2,     │          0 │ conv4_block18_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block18_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block18_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block18_con… │ (None, 2, 2,     │          0 │ conv4_block17_… │   -   │\n│ (Concatenate)      │ 832)             │            │ conv4_block18_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block19_0_bn │ (None, 2, 2,     │      3,328 │ conv4_block18_… │   N   │\n│ (BatchNormalizati… │ 832)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block19_0_r… │ (None, 2, 2,     │          0 │ conv4_block19_… │   -   │\n│ (Activation)       │ 832)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block19_1_c… │ (None, 2, 2,     │    106,496 │ conv4_block19_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block19_1_bn │ (None, 2, 2,     │        512 │ conv4_block19_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block19_1_r… │ (None, 2, 2,     │          0 │ conv4_block19_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block19_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block19_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block19_con… │ (None, 2, 2,     │          0 │ conv4_block18_… │   -   │\n│ (Concatenate)      │ 864)             │            │ conv4_block19_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block20_0_bn │ (None, 2, 2,     │      3,456 │ conv4_block19_… │   N   │\n│ (BatchNormalizati… │ 864)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block20_0_r… │ (None, 2, 2,     │          0 │ conv4_block20_… │   -   │\n│ (Activation)       │ 864)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block20_1_c… │ (None, 2, 2,     │    110,592 │ conv4_block20_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block20_1_bn │ (None, 2, 2,     │        512 │ conv4_block20_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block20_1_r… │ (None, 2, 2,     │          0 │ conv4_block20_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block20_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block20_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block20_con… │ (None, 2, 2,     │          0 │ conv4_block19_… │   -   │\n│ (Concatenate)      │ 896)             │            │ conv4_block20_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block21_0_bn │ (None, 2, 2,     │      3,584 │ conv4_block20_… │   N   │\n│ (BatchNormalizati… │ 896)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block21_0_r… │ (None, 2, 2,     │          0 │ conv4_block21_… │   -   │\n│ (Activation)       │ 896)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block21_1_c… │ (None, 2, 2,     │    114,688 │ conv4_block21_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block21_1_bn │ (None, 2, 2,     │        512 │ conv4_block21_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block21_1_r… │ (None, 2, 2,     │          0 │ conv4_block21_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block21_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block21_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block21_con… │ (None, 2, 2,     │          0 │ conv4_block20_… │   -   │\n│ (Concatenate)      │ 928)             │            │ conv4_block21_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block22_0_bn │ (None, 2, 2,     │      3,712 │ conv4_block21_… │   N   │\n│ (BatchNormalizati… │ 928)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block22_0_r… │ (None, 2, 2,     │          0 │ conv4_block22_… │   -   │\n│ (Activation)       │ 928)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block22_1_c… │ (None, 2, 2,     │    118,784 │ conv4_block22_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block22_1_bn │ (None, 2, 2,     │        512 │ conv4_block22_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block22_1_r… │ (None, 2, 2,     │          0 │ conv4_block22_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block22_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block22_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block22_con… │ (None, 2, 2,     │          0 │ conv4_block21_… │   -   │\n│ (Concatenate)      │ 960)             │            │ conv4_block22_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block23_0_bn │ (None, 2, 2,     │      3,840 │ conv4_block22_… │   N   │\n│ (BatchNormalizati… │ 960)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block23_0_r… │ (None, 2, 2,     │          0 │ conv4_block23_… │   -   │\n│ (Activation)       │ 960)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block23_1_c… │ (None, 2, 2,     │    122,880 │ conv4_block23_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block23_1_bn │ (None, 2, 2,     │        512 │ conv4_block23_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block23_1_r… │ (None, 2, 2,     │          0 │ conv4_block23_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block23_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block23_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block23_con… │ (None, 2, 2,     │          0 │ conv4_block22_… │   -   │\n│ (Concatenate)      │ 992)             │            │ conv4_block23_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block24_0_bn │ (None, 2, 2,     │      3,968 │ conv4_block23_… │   N   │\n│ (BatchNormalizati… │ 992)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block24_0_r… │ (None, 2, 2,     │          0 │ conv4_block24_… │   -   │\n│ (Activation)       │ 992)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block24_1_c… │ (None, 2, 2,     │    126,976 │ conv4_block24_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block24_1_bn │ (None, 2, 2,     │        512 │ conv4_block24_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block24_1_r… │ (None, 2, 2,     │          0 │ conv4_block24_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block24_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block24_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block24_con… │ (None, 2, 2,     │          0 │ conv4_block23_… │   -   │\n│ (Concatenate)      │ 1024)            │            │ conv4_block24_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block25_0_bn │ (None, 2, 2,     │      4,096 │ conv4_block24_… │   N   │\n│ (BatchNormalizati… │ 1024)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block25_0_r… │ (None, 2, 2,     │          0 │ conv4_block25_… │   -   │\n│ (Activation)       │ 1024)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block25_1_c… │ (None, 2, 2,     │    131,072 │ conv4_block25_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block25_1_bn │ (None, 2, 2,     │        512 │ conv4_block25_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block25_1_r… │ (None, 2, 2,     │          0 │ conv4_block25_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block25_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block25_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block25_con… │ (None, 2, 2,     │          0 │ conv4_block24_… │   -   │\n│ (Concatenate)      │ 1056)            │            │ conv4_block25_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block26_0_bn │ (None, 2, 2,     │      4,224 │ conv4_block25_… │   N   │\n│ (BatchNormalizati… │ 1056)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block26_0_r… │ (None, 2, 2,     │          0 │ conv4_block26_… │   -   │\n│ (Activation)       │ 1056)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block26_1_c… │ (None, 2, 2,     │    135,168 │ conv4_block26_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block26_1_bn │ (None, 2, 2,     │        512 │ conv4_block26_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block26_1_r… │ (None, 2, 2,     │          0 │ conv4_block26_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block26_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block26_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block26_con… │ (None, 2, 2,     │          0 │ conv4_block25_… │   -   │\n│ (Concatenate)      │ 1088)            │            │ conv4_block26_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block27_0_bn │ (None, 2, 2,     │      4,352 │ conv4_block26_… │   N   │\n│ (BatchNormalizati… │ 1088)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block27_0_r… │ (None, 2, 2,     │          0 │ conv4_block27_… │   -   │\n│ (Activation)       │ 1088)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block27_1_c… │ (None, 2, 2,     │    139,264 │ conv4_block27_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block27_1_bn │ (None, 2, 2,     │        512 │ conv4_block27_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block27_1_r… │ (None, 2, 2,     │          0 │ conv4_block27_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block27_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block27_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block27_con… │ (None, 2, 2,     │          0 │ conv4_block26_… │   -   │\n│ (Concatenate)      │ 1120)            │            │ conv4_block27_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block28_0_bn │ (None, 2, 2,     │      4,480 │ conv4_block27_… │   N   │\n│ (BatchNormalizati… │ 1120)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block28_0_r… │ (None, 2, 2,     │          0 │ conv4_block28_… │   -   │\n│ (Activation)       │ 1120)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block28_1_c… │ (None, 2, 2,     │    143,360 │ conv4_block28_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block28_1_bn │ (None, 2, 2,     │        512 │ conv4_block28_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block28_1_r… │ (None, 2, 2,     │          0 │ conv4_block28_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block28_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block28_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block28_con… │ (None, 2, 2,     │          0 │ conv4_block27_… │   -   │\n│ (Concatenate)      │ 1152)            │            │ conv4_block28_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block29_0_bn │ (None, 2, 2,     │      4,608 │ conv4_block28_… │   N   │\n│ (BatchNormalizati… │ 1152)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block29_0_r… │ (None, 2, 2,     │          0 │ conv4_block29_… │   -   │\n│ (Activation)       │ 1152)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block29_1_c… │ (None, 2, 2,     │    147,456 │ conv4_block29_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block29_1_bn │ (None, 2, 2,     │        512 │ conv4_block29_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block29_1_r… │ (None, 2, 2,     │          0 │ conv4_block29_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block29_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block29_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block29_con… │ (None, 2, 2,     │          0 │ conv4_block28_… │   -   │\n│ (Concatenate)      │ 1184)            │            │ conv4_block29_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block30_0_bn │ (None, 2, 2,     │      4,736 │ conv4_block29_… │   N   │\n│ (BatchNormalizati… │ 1184)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block30_0_r… │ (None, 2, 2,     │          0 │ conv4_block30_… │   -   │\n│ (Activation)       │ 1184)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block30_1_c… │ (None, 2, 2,     │    151,552 │ conv4_block30_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block30_1_bn │ (None, 2, 2,     │        512 │ conv4_block30_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block30_1_r… │ (None, 2, 2,     │          0 │ conv4_block30_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block30_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block30_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block30_con… │ (None, 2, 2,     │          0 │ conv4_block29_… │   -   │\n│ (Concatenate)      │ 1216)            │            │ conv4_block30_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block31_0_bn │ (None, 2, 2,     │      4,864 │ conv4_block30_… │   N   │\n│ (BatchNormalizati… │ 1216)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block31_0_r… │ (None, 2, 2,     │          0 │ conv4_block31_… │   -   │\n│ (Activation)       │ 1216)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block31_1_c… │ (None, 2, 2,     │    155,648 │ conv4_block31_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block31_1_bn │ (None, 2, 2,     │        512 │ conv4_block31_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block31_1_r… │ (None, 2, 2,     │          0 │ conv4_block31_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block31_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block31_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block31_con… │ (None, 2, 2,     │          0 │ conv4_block30_… │   -   │\n│ (Concatenate)      │ 1248)            │            │ conv4_block31_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block32_0_bn │ (None, 2, 2,     │      4,992 │ conv4_block31_… │   N   │\n│ (BatchNormalizati… │ 1248)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block32_0_r… │ (None, 2, 2,     │          0 │ conv4_block32_… │   -   │\n│ (Activation)       │ 1248)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block32_1_c… │ (None, 2, 2,     │    159,744 │ conv4_block32_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block32_1_bn │ (None, 2, 2,     │        512 │ conv4_block32_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block32_1_r… │ (None, 2, 2,     │          0 │ conv4_block32_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block32_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block32_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block32_con… │ (None, 2, 2,     │          0 │ conv4_block31_… │   -   │\n│ (Concatenate)      │ 1280)            │            │ conv4_block32_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block33_0_bn │ (None, 2, 2,     │      5,120 │ conv4_block32_… │   N   │\n│ (BatchNormalizati… │ 1280)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block33_0_r… │ (None, 2, 2,     │          0 │ conv4_block33_… │   -   │\n│ (Activation)       │ 1280)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block33_1_c… │ (None, 2, 2,     │    163,840 │ conv4_block33_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block33_1_bn │ (None, 2, 2,     │        512 │ conv4_block33_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block33_1_r… │ (None, 2, 2,     │          0 │ conv4_block33_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block33_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block33_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block33_con… │ (None, 2, 2,     │          0 │ conv4_block32_… │   -   │\n│ (Concatenate)      │ 1312)            │            │ conv4_block33_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block34_0_bn │ (None, 2, 2,     │      5,248 │ conv4_block33_… │   N   │\n│ (BatchNormalizati… │ 1312)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block34_0_r… │ (None, 2, 2,     │          0 │ conv4_block34_… │   -   │\n│ (Activation)       │ 1312)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block34_1_c… │ (None, 2, 2,     │    167,936 │ conv4_block34_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block34_1_bn │ (None, 2, 2,     │        512 │ conv4_block34_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block34_1_r… │ (None, 2, 2,     │          0 │ conv4_block34_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block34_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block34_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block34_con… │ (None, 2, 2,     │          0 │ conv4_block33_… │   -   │\n│ (Concatenate)      │ 1344)            │            │ conv4_block34_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block35_0_bn │ (None, 2, 2,     │      5,376 │ conv4_block34_… │   N   │\n│ (BatchNormalizati… │ 1344)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block35_0_r… │ (None, 2, 2,     │          0 │ conv4_block35_… │   -   │\n│ (Activation)       │ 1344)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block35_1_c… │ (None, 2, 2,     │    172,032 │ conv4_block35_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block35_1_bn │ (None, 2, 2,     │        512 │ conv4_block35_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block35_1_r… │ (None, 2, 2,     │          0 │ conv4_block35_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block35_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block35_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block35_con… │ (None, 2, 2,     │          0 │ conv4_block34_… │   -   │\n│ (Concatenate)      │ 1376)            │            │ conv4_block35_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block36_0_bn │ (None, 2, 2,     │      5,504 │ conv4_block35_… │   N   │\n│ (BatchNormalizati… │ 1376)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block36_0_r… │ (None, 2, 2,     │          0 │ conv4_block36_… │   -   │\n│ (Activation)       │ 1376)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block36_1_c… │ (None, 2, 2,     │    176,128 │ conv4_block36_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block36_1_bn │ (None, 2, 2,     │        512 │ conv4_block36_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block36_1_r… │ (None, 2, 2,     │          0 │ conv4_block36_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block36_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block36_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block36_con… │ (None, 2, 2,     │          0 │ conv4_block35_… │   -   │\n│ (Concatenate)      │ 1408)            │            │ conv4_block36_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block37_0_bn │ (None, 2, 2,     │      5,632 │ conv4_block36_… │   N   │\n│ (BatchNormalizati… │ 1408)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block37_0_r… │ (None, 2, 2,     │          0 │ conv4_block37_… │   -   │\n│ (Activation)       │ 1408)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block37_1_c… │ (None, 2, 2,     │    180,224 │ conv4_block37_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block37_1_bn │ (None, 2, 2,     │        512 │ conv4_block37_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block37_1_r… │ (None, 2, 2,     │          0 │ conv4_block37_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block37_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block37_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block37_con… │ (None, 2, 2,     │          0 │ conv4_block36_… │   -   │\n│ (Concatenate)      │ 1440)            │            │ conv4_block37_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block38_0_bn │ (None, 2, 2,     │      5,760 │ conv4_block37_… │   N   │\n│ (BatchNormalizati… │ 1440)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block38_0_r… │ (None, 2, 2,     │          0 │ conv4_block38_… │   -   │\n│ (Activation)       │ 1440)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block38_1_c… │ (None, 2, 2,     │    184,320 │ conv4_block38_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block38_1_bn │ (None, 2, 2,     │        512 │ conv4_block38_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block38_1_r… │ (None, 2, 2,     │          0 │ conv4_block38_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block38_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block38_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block38_con… │ (None, 2, 2,     │          0 │ conv4_block37_… │   -   │\n│ (Concatenate)      │ 1472)            │            │ conv4_block38_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block39_0_bn │ (None, 2, 2,     │      5,888 │ conv4_block38_… │   N   │\n│ (BatchNormalizati… │ 1472)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block39_0_r… │ (None, 2, 2,     │          0 │ conv4_block39_… │   -   │\n│ (Activation)       │ 1472)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block39_1_c… │ (None, 2, 2,     │    188,416 │ conv4_block39_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block39_1_bn │ (None, 2, 2,     │        512 │ conv4_block39_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block39_1_r… │ (None, 2, 2,     │          0 │ conv4_block39_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block39_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block39_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block39_con… │ (None, 2, 2,     │          0 │ conv4_block38_… │   -   │\n│ (Concatenate)      │ 1504)            │            │ conv4_block39_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block40_0_bn │ (None, 2, 2,     │      6,016 │ conv4_block39_… │   N   │\n│ (BatchNormalizati… │ 1504)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block40_0_r… │ (None, 2, 2,     │          0 │ conv4_block40_… │   -   │\n│ (Activation)       │ 1504)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block40_1_c… │ (None, 2, 2,     │    192,512 │ conv4_block40_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block40_1_bn │ (None, 2, 2,     │        512 │ conv4_block40_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block40_1_r… │ (None, 2, 2,     │          0 │ conv4_block40_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block40_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block40_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block40_con… │ (None, 2, 2,     │          0 │ conv4_block39_… │   -   │\n│ (Concatenate)      │ 1536)            │            │ conv4_block40_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block41_0_bn │ (None, 2, 2,     │      6,144 │ conv4_block40_… │   N   │\n│ (BatchNormalizati… │ 1536)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block41_0_r… │ (None, 2, 2,     │          0 │ conv4_block41_… │   -   │\n│ (Activation)       │ 1536)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block41_1_c… │ (None, 2, 2,     │    196,608 │ conv4_block41_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block41_1_bn │ (None, 2, 2,     │        512 │ conv4_block41_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block41_1_r… │ (None, 2, 2,     │          0 │ conv4_block41_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block41_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block41_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block41_con… │ (None, 2, 2,     │          0 │ conv4_block40_… │   -   │\n│ (Concatenate)      │ 1568)            │            │ conv4_block41_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block42_0_bn │ (None, 2, 2,     │      6,272 │ conv4_block41_… │   N   │\n│ (BatchNormalizati… │ 1568)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block42_0_r… │ (None, 2, 2,     │          0 │ conv4_block42_… │   -   │\n│ (Activation)       │ 1568)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block42_1_c… │ (None, 2, 2,     │    200,704 │ conv4_block42_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block42_1_bn │ (None, 2, 2,     │        512 │ conv4_block42_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block42_1_r… │ (None, 2, 2,     │          0 │ conv4_block42_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block42_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block42_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block42_con… │ (None, 2, 2,     │          0 │ conv4_block41_… │   -   │\n│ (Concatenate)      │ 1600)            │            │ conv4_block42_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block43_0_bn │ (None, 2, 2,     │      6,400 │ conv4_block42_… │   N   │\n│ (BatchNormalizati… │ 1600)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block43_0_r… │ (None, 2, 2,     │          0 │ conv4_block43_… │   -   │\n│ (Activation)       │ 1600)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block43_1_c… │ (None, 2, 2,     │    204,800 │ conv4_block43_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block43_1_bn │ (None, 2, 2,     │        512 │ conv4_block43_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block43_1_r… │ (None, 2, 2,     │          0 │ conv4_block43_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block43_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block43_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block43_con… │ (None, 2, 2,     │          0 │ conv4_block42_… │   -   │\n│ (Concatenate)      │ 1632)            │            │ conv4_block43_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block44_0_bn │ (None, 2, 2,     │      6,528 │ conv4_block43_… │   N   │\n│ (BatchNormalizati… │ 1632)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block44_0_r… │ (None, 2, 2,     │          0 │ conv4_block44_… │   -   │\n│ (Activation)       │ 1632)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block44_1_c… │ (None, 2, 2,     │    208,896 │ conv4_block44_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block44_1_bn │ (None, 2, 2,     │        512 │ conv4_block44_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block44_1_r… │ (None, 2, 2,     │          0 │ conv4_block44_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block44_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block44_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block44_con… │ (None, 2, 2,     │          0 │ conv4_block43_… │   -   │\n│ (Concatenate)      │ 1664)            │            │ conv4_block44_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block45_0_bn │ (None, 2, 2,     │      6,656 │ conv4_block44_… │   N   │\n│ (BatchNormalizati… │ 1664)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block45_0_r… │ (None, 2, 2,     │          0 │ conv4_block45_… │   -   │\n│ (Activation)       │ 1664)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block45_1_c… │ (None, 2, 2,     │    212,992 │ conv4_block45_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block45_1_bn │ (None, 2, 2,     │        512 │ conv4_block45_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block45_1_r… │ (None, 2, 2,     │          0 │ conv4_block45_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block45_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block45_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block45_con… │ (None, 2, 2,     │          0 │ conv4_block44_… │   -   │\n│ (Concatenate)      │ 1696)            │            │ conv4_block45_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block46_0_bn │ (None, 2, 2,     │      6,784 │ conv4_block45_… │   N   │\n│ (BatchNormalizati… │ 1696)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block46_0_r… │ (None, 2, 2,     │          0 │ conv4_block46_… │   -   │\n│ (Activation)       │ 1696)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block46_1_c… │ (None, 2, 2,     │    217,088 │ conv4_block46_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block46_1_bn │ (None, 2, 2,     │        512 │ conv4_block46_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block46_1_r… │ (None, 2, 2,     │          0 │ conv4_block46_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block46_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block46_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block46_con… │ (None, 2, 2,     │          0 │ conv4_block45_… │   -   │\n│ (Concatenate)      │ 1728)            │            │ conv4_block46_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block47_0_bn │ (None, 2, 2,     │      6,912 │ conv4_block46_… │   N   │\n│ (BatchNormalizati… │ 1728)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block47_0_r… │ (None, 2, 2,     │          0 │ conv4_block47_… │   -   │\n│ (Activation)       │ 1728)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block47_1_c… │ (None, 2, 2,     │    221,184 │ conv4_block47_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block47_1_bn │ (None, 2, 2,     │        512 │ conv4_block47_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block47_1_r… │ (None, 2, 2,     │          0 │ conv4_block47_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block47_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block47_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block47_con… │ (None, 2, 2,     │          0 │ conv4_block46_… │   -   │\n│ (Concatenate)      │ 1760)            │            │ conv4_block47_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block48_0_bn │ (None, 2, 2,     │      7,040 │ conv4_block47_… │   N   │\n│ (BatchNormalizati… │ 1760)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block48_0_r… │ (None, 2, 2,     │          0 │ conv4_block48_… │   -   │\n│ (Activation)       │ 1760)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block48_1_c… │ (None, 2, 2,     │    225,280 │ conv4_block48_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block48_1_bn │ (None, 2, 2,     │        512 │ conv4_block48_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block48_1_r… │ (None, 2, 2,     │          0 │ conv4_block48_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block48_2_c… │ (None, 2, 2, 32) │     36,864 │ conv4_block48_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv4_block48_con… │ (None, 2, 2,     │          0 │ conv4_block47_… │   -   │\n│ (Concatenate)      │ 1792)            │            │ conv4_block48_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool4_bn           │ (None, 2, 2,     │      7,168 │ conv4_block48_… │   N   │\n│ (BatchNormalizati… │ 1792)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool4_relu         │ (None, 2, 2,     │          0 │ pool4_bn[0][0]  │   -   │\n│ (Activation)       │ 1792)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool4_conv         │ (None, 2, 2,     │  1,605,632 │ pool4_relu[0][… │   N   │\n│ (Conv2D)           │ 896)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ pool4_pool         │ (None, 1, 1,     │          0 │ pool4_conv[0][… │   -   │\n│ (AveragePooling2D) │ 896)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block1_0_bn  │ (None, 1, 1,     │      3,584 │ pool4_pool[0][… │   N   │\n│ (BatchNormalizati… │ 896)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block1_0_re… │ (None, 1, 1,     │          0 │ conv5_block1_0… │   -   │\n│ (Activation)       │ 896)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block1_1_co… │ (None, 1, 1,     │    114,688 │ conv5_block1_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block1_1_bn  │ (None, 1, 1,     │        512 │ conv5_block1_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block1_1_re… │ (None, 1, 1,     │          0 │ conv5_block1_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block1_2_co… │ (None, 1, 1, 32) │     36,864 │ conv5_block1_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block1_conc… │ (None, 1, 1,     │          0 │ pool4_pool[0][… │   -   │\n│ (Concatenate)      │ 928)             │            │ conv5_block1_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block2_0_bn  │ (None, 1, 1,     │      3,712 │ conv5_block1_c… │   N   │\n│ (BatchNormalizati… │ 928)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block2_0_re… │ (None, 1, 1,     │          0 │ conv5_block2_0… │   -   │\n│ (Activation)       │ 928)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block2_1_co… │ (None, 1, 1,     │    118,784 │ conv5_block2_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block2_1_bn  │ (None, 1, 1,     │        512 │ conv5_block2_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block2_1_re… │ (None, 1, 1,     │          0 │ conv5_block2_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block2_2_co… │ (None, 1, 1, 32) │     36,864 │ conv5_block2_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block2_conc… │ (None, 1, 1,     │          0 │ conv5_block1_c… │   -   │\n│ (Concatenate)      │ 960)             │            │ conv5_block2_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block3_0_bn  │ (None, 1, 1,     │      3,840 │ conv5_block2_c… │   N   │\n│ (BatchNormalizati… │ 960)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block3_0_re… │ (None, 1, 1,     │          0 │ conv5_block3_0… │   -   │\n│ (Activation)       │ 960)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block3_1_co… │ (None, 1, 1,     │    122,880 │ conv5_block3_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block3_1_bn  │ (None, 1, 1,     │        512 │ conv5_block3_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block3_1_re… │ (None, 1, 1,     │          0 │ conv5_block3_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block3_2_co… │ (None, 1, 1, 32) │     36,864 │ conv5_block3_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block3_conc… │ (None, 1, 1,     │          0 │ conv5_block2_c… │   -   │\n│ (Concatenate)      │ 992)             │            │ conv5_block3_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block4_0_bn  │ (None, 1, 1,     │      3,968 │ conv5_block3_c… │   N   │\n│ (BatchNormalizati… │ 992)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block4_0_re… │ (None, 1, 1,     │          0 │ conv5_block4_0… │   -   │\n│ (Activation)       │ 992)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block4_1_co… │ (None, 1, 1,     │    126,976 │ conv5_block4_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block4_1_bn  │ (None, 1, 1,     │        512 │ conv5_block4_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block4_1_re… │ (None, 1, 1,     │          0 │ conv5_block4_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block4_2_co… │ (None, 1, 1, 32) │     36,864 │ conv5_block4_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block4_conc… │ (None, 1, 1,     │          0 │ conv5_block3_c… │   -   │\n│ (Concatenate)      │ 1024)            │            │ conv5_block4_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block5_0_bn  │ (None, 1, 1,     │      4,096 │ conv5_block4_c… │   N   │\n│ (BatchNormalizati… │ 1024)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block5_0_re… │ (None, 1, 1,     │          0 │ conv5_block5_0… │   -   │\n│ (Activation)       │ 1024)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block5_1_co… │ (None, 1, 1,     │    131,072 │ conv5_block5_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block5_1_bn  │ (None, 1, 1,     │        512 │ conv5_block5_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block5_1_re… │ (None, 1, 1,     │          0 │ conv5_block5_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block5_2_co… │ (None, 1, 1, 32) │     36,864 │ conv5_block5_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block5_conc… │ (None, 1, 1,     │          0 │ conv5_block4_c… │   -   │\n│ (Concatenate)      │ 1056)            │            │ conv5_block5_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block6_0_bn  │ (None, 1, 1,     │      4,224 │ conv5_block5_c… │   N   │\n│ (BatchNormalizati… │ 1056)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block6_0_re… │ (None, 1, 1,     │          0 │ conv5_block6_0… │   -   │\n│ (Activation)       │ 1056)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block6_1_co… │ (None, 1, 1,     │    135,168 │ conv5_block6_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block6_1_bn  │ (None, 1, 1,     │        512 │ conv5_block6_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block6_1_re… │ (None, 1, 1,     │          0 │ conv5_block6_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block6_2_co… │ (None, 1, 1, 32) │     36,864 │ conv5_block6_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block6_conc… │ (None, 1, 1,     │          0 │ conv5_block5_c… │   -   │\n│ (Concatenate)      │ 1088)            │            │ conv5_block6_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block7_0_bn  │ (None, 1, 1,     │      4,352 │ conv5_block6_c… │   N   │\n│ (BatchNormalizati… │ 1088)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block7_0_re… │ (None, 1, 1,     │          0 │ conv5_block7_0… │   -   │\n│ (Activation)       │ 1088)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block7_1_co… │ (None, 1, 1,     │    139,264 │ conv5_block7_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block7_1_bn  │ (None, 1, 1,     │        512 │ conv5_block7_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block7_1_re… │ (None, 1, 1,     │          0 │ conv5_block7_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block7_2_co… │ (None, 1, 1, 32) │     36,864 │ conv5_block7_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block7_conc… │ (None, 1, 1,     │          0 │ conv5_block6_c… │   -   │\n│ (Concatenate)      │ 1120)            │            │ conv5_block7_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block8_0_bn  │ (None, 1, 1,     │      4,480 │ conv5_block7_c… │   N   │\n│ (BatchNormalizati… │ 1120)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block8_0_re… │ (None, 1, 1,     │          0 │ conv5_block8_0… │   -   │\n│ (Activation)       │ 1120)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block8_1_co… │ (None, 1, 1,     │    143,360 │ conv5_block8_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block8_1_bn  │ (None, 1, 1,     │        512 │ conv5_block8_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block8_1_re… │ (None, 1, 1,     │          0 │ conv5_block8_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block8_2_co… │ (None, 1, 1, 32) │     36,864 │ conv5_block8_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block8_conc… │ (None, 1, 1,     │          0 │ conv5_block7_c… │   -   │\n│ (Concatenate)      │ 1152)            │            │ conv5_block8_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block9_0_bn  │ (None, 1, 1,     │      4,608 │ conv5_block8_c… │   N   │\n│ (BatchNormalizati… │ 1152)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block9_0_re… │ (None, 1, 1,     │          0 │ conv5_block9_0… │   -   │\n│ (Activation)       │ 1152)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block9_1_co… │ (None, 1, 1,     │    147,456 │ conv5_block9_0… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block9_1_bn  │ (None, 1, 1,     │        512 │ conv5_block9_1… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block9_1_re… │ (None, 1, 1,     │          0 │ conv5_block9_1… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block9_2_co… │ (None, 1, 1, 32) │     36,864 │ conv5_block9_1… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block9_conc… │ (None, 1, 1,     │          0 │ conv5_block8_c… │   -   │\n│ (Concatenate)      │ 1184)            │            │ conv5_block9_2… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block10_0_bn │ (None, 1, 1,     │      4,736 │ conv5_block9_c… │   N   │\n│ (BatchNormalizati… │ 1184)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block10_0_r… │ (None, 1, 1,     │          0 │ conv5_block10_… │   -   │\n│ (Activation)       │ 1184)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block10_1_c… │ (None, 1, 1,     │    151,552 │ conv5_block10_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block10_1_bn │ (None, 1, 1,     │        512 │ conv5_block10_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block10_1_r… │ (None, 1, 1,     │          0 │ conv5_block10_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block10_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block10_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block10_con… │ (None, 1, 1,     │          0 │ conv5_block9_c… │   -   │\n│ (Concatenate)      │ 1216)            │            │ conv5_block10_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block11_0_bn │ (None, 1, 1,     │      4,864 │ conv5_block10_… │   N   │\n│ (BatchNormalizati… │ 1216)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block11_0_r… │ (None, 1, 1,     │          0 │ conv5_block11_… │   -   │\n│ (Activation)       │ 1216)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block11_1_c… │ (None, 1, 1,     │    155,648 │ conv5_block11_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block11_1_bn │ (None, 1, 1,     │        512 │ conv5_block11_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block11_1_r… │ (None, 1, 1,     │          0 │ conv5_block11_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block11_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block11_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block11_con… │ (None, 1, 1,     │          0 │ conv5_block10_… │   -   │\n│ (Concatenate)      │ 1248)            │            │ conv5_block11_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block12_0_bn │ (None, 1, 1,     │      4,992 │ conv5_block11_… │   N   │\n│ (BatchNormalizati… │ 1248)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block12_0_r… │ (None, 1, 1,     │          0 │ conv5_block12_… │   -   │\n│ (Activation)       │ 1248)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block12_1_c… │ (None, 1, 1,     │    159,744 │ conv5_block12_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block12_1_bn │ (None, 1, 1,     │        512 │ conv5_block12_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block12_1_r… │ (None, 1, 1,     │          0 │ conv5_block12_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block12_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block12_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block12_con… │ (None, 1, 1,     │          0 │ conv5_block11_… │   -   │\n│ (Concatenate)      │ 1280)            │            │ conv5_block12_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block13_0_bn │ (None, 1, 1,     │      5,120 │ conv5_block12_… │   N   │\n│ (BatchNormalizati… │ 1280)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block13_0_r… │ (None, 1, 1,     │          0 │ conv5_block13_… │   -   │\n│ (Activation)       │ 1280)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block13_1_c… │ (None, 1, 1,     │    163,840 │ conv5_block13_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block13_1_bn │ (None, 1, 1,     │        512 │ conv5_block13_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block13_1_r… │ (None, 1, 1,     │          0 │ conv5_block13_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block13_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block13_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block13_con… │ (None, 1, 1,     │          0 │ conv5_block12_… │   -   │\n│ (Concatenate)      │ 1312)            │            │ conv5_block13_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block14_0_bn │ (None, 1, 1,     │      5,248 │ conv5_block13_… │   N   │\n│ (BatchNormalizati… │ 1312)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block14_0_r… │ (None, 1, 1,     │          0 │ conv5_block14_… │   -   │\n│ (Activation)       │ 1312)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block14_1_c… │ (None, 1, 1,     │    167,936 │ conv5_block14_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block14_1_bn │ (None, 1, 1,     │        512 │ conv5_block14_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block14_1_r… │ (None, 1, 1,     │          0 │ conv5_block14_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block14_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block14_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block14_con… │ (None, 1, 1,     │          0 │ conv5_block13_… │   -   │\n│ (Concatenate)      │ 1344)            │            │ conv5_block14_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block15_0_bn │ (None, 1, 1,     │      5,376 │ conv5_block14_… │   N   │\n│ (BatchNormalizati… │ 1344)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block15_0_r… │ (None, 1, 1,     │          0 │ conv5_block15_… │   -   │\n│ (Activation)       │ 1344)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block15_1_c… │ (None, 1, 1,     │    172,032 │ conv5_block15_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block15_1_bn │ (None, 1, 1,     │        512 │ conv5_block15_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block15_1_r… │ (None, 1, 1,     │          0 │ conv5_block15_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block15_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block15_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block15_con… │ (None, 1, 1,     │          0 │ conv5_block14_… │   -   │\n│ (Concatenate)      │ 1376)            │            │ conv5_block15_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block16_0_bn │ (None, 1, 1,     │      5,504 │ conv5_block15_… │   N   │\n│ (BatchNormalizati… │ 1376)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block16_0_r… │ (None, 1, 1,     │          0 │ conv5_block16_… │   -   │\n│ (Activation)       │ 1376)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block16_1_c… │ (None, 1, 1,     │    176,128 │ conv5_block16_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block16_1_bn │ (None, 1, 1,     │        512 │ conv5_block16_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block16_1_r… │ (None, 1, 1,     │          0 │ conv5_block16_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block16_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block16_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block16_con… │ (None, 1, 1,     │          0 │ conv5_block15_… │   -   │\n│ (Concatenate)      │ 1408)            │            │ conv5_block16_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block17_0_bn │ (None, 1, 1,     │      5,632 │ conv5_block16_… │   N   │\n│ (BatchNormalizati… │ 1408)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block17_0_r… │ (None, 1, 1,     │          0 │ conv5_block17_… │   -   │\n│ (Activation)       │ 1408)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block17_1_c… │ (None, 1, 1,     │    180,224 │ conv5_block17_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block17_1_bn │ (None, 1, 1,     │        512 │ conv5_block17_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block17_1_r… │ (None, 1, 1,     │          0 │ conv5_block17_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block17_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block17_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block17_con… │ (None, 1, 1,     │          0 │ conv5_block16_… │   -   │\n│ (Concatenate)      │ 1440)            │            │ conv5_block17_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block18_0_bn │ (None, 1, 1,     │      5,760 │ conv5_block17_… │   N   │\n│ (BatchNormalizati… │ 1440)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block18_0_r… │ (None, 1, 1,     │          0 │ conv5_block18_… │   -   │\n│ (Activation)       │ 1440)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block18_1_c… │ (None, 1, 1,     │    184,320 │ conv5_block18_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block18_1_bn │ (None, 1, 1,     │        512 │ conv5_block18_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block18_1_r… │ (None, 1, 1,     │          0 │ conv5_block18_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block18_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block18_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block18_con… │ (None, 1, 1,     │          0 │ conv5_block17_… │   -   │\n│ (Concatenate)      │ 1472)            │            │ conv5_block18_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block19_0_bn │ (None, 1, 1,     │      5,888 │ conv5_block18_… │   N   │\n│ (BatchNormalizati… │ 1472)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block19_0_r… │ (None, 1, 1,     │          0 │ conv5_block19_… │   -   │\n│ (Activation)       │ 1472)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block19_1_c… │ (None, 1, 1,     │    188,416 │ conv5_block19_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block19_1_bn │ (None, 1, 1,     │        512 │ conv5_block19_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block19_1_r… │ (None, 1, 1,     │          0 │ conv5_block19_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block19_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block19_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block19_con… │ (None, 1, 1,     │          0 │ conv5_block18_… │   -   │\n│ (Concatenate)      │ 1504)            │            │ conv5_block19_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block20_0_bn │ (None, 1, 1,     │      6,016 │ conv5_block19_… │   N   │\n│ (BatchNormalizati… │ 1504)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block20_0_r… │ (None, 1, 1,     │          0 │ conv5_block20_… │   -   │\n│ (Activation)       │ 1504)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block20_1_c… │ (None, 1, 1,     │    192,512 │ conv5_block20_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block20_1_bn │ (None, 1, 1,     │        512 │ conv5_block20_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block20_1_r… │ (None, 1, 1,     │          0 │ conv5_block20_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block20_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block20_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block20_con… │ (None, 1, 1,     │          0 │ conv5_block19_… │   -   │\n│ (Concatenate)      │ 1536)            │            │ conv5_block20_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block21_0_bn │ (None, 1, 1,     │      6,144 │ conv5_block20_… │   N   │\n│ (BatchNormalizati… │ 1536)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block21_0_r… │ (None, 1, 1,     │          0 │ conv5_block21_… │   -   │\n│ (Activation)       │ 1536)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block21_1_c… │ (None, 1, 1,     │    196,608 │ conv5_block21_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block21_1_bn │ (None, 1, 1,     │        512 │ conv5_block21_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block21_1_r… │ (None, 1, 1,     │          0 │ conv5_block21_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block21_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block21_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block21_con… │ (None, 1, 1,     │          0 │ conv5_block20_… │   -   │\n│ (Concatenate)      │ 1568)            │            │ conv5_block21_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block22_0_bn │ (None, 1, 1,     │      6,272 │ conv5_block21_… │   N   │\n│ (BatchNormalizati… │ 1568)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block22_0_r… │ (None, 1, 1,     │          0 │ conv5_block22_… │   -   │\n│ (Activation)       │ 1568)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block22_1_c… │ (None, 1, 1,     │    200,704 │ conv5_block22_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block22_1_bn │ (None, 1, 1,     │        512 │ conv5_block22_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block22_1_r… │ (None, 1, 1,     │          0 │ conv5_block22_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block22_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block22_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block22_con… │ (None, 1, 1,     │          0 │ conv5_block21_… │   -   │\n│ (Concatenate)      │ 1600)            │            │ conv5_block22_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block23_0_bn │ (None, 1, 1,     │      6,400 │ conv5_block22_… │   N   │\n│ (BatchNormalizati… │ 1600)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block23_0_r… │ (None, 1, 1,     │          0 │ conv5_block23_… │   -   │\n│ (Activation)       │ 1600)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block23_1_c… │ (None, 1, 1,     │    204,800 │ conv5_block23_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block23_1_bn │ (None, 1, 1,     │        512 │ conv5_block23_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block23_1_r… │ (None, 1, 1,     │          0 │ conv5_block23_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block23_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block23_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block23_con… │ (None, 1, 1,     │          0 │ conv5_block22_… │   -   │\n│ (Concatenate)      │ 1632)            │            │ conv5_block23_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block24_0_bn │ (None, 1, 1,     │      6,528 │ conv5_block23_… │   N   │\n│ (BatchNormalizati… │ 1632)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block24_0_r… │ (None, 1, 1,     │          0 │ conv5_block24_… │   -   │\n│ (Activation)       │ 1632)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block24_1_c… │ (None, 1, 1,     │    208,896 │ conv5_block24_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block24_1_bn │ (None, 1, 1,     │        512 │ conv5_block24_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block24_1_r… │ (None, 1, 1,     │          0 │ conv5_block24_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block24_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block24_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block24_con… │ (None, 1, 1,     │          0 │ conv5_block23_… │   -   │\n│ (Concatenate)      │ 1664)            │            │ conv5_block24_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block25_0_bn │ (None, 1, 1,     │      6,656 │ conv5_block24_… │   N   │\n│ (BatchNormalizati… │ 1664)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block25_0_r… │ (None, 1, 1,     │          0 │ conv5_block25_… │   -   │\n│ (Activation)       │ 1664)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block25_1_c… │ (None, 1, 1,     │    212,992 │ conv5_block25_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block25_1_bn │ (None, 1, 1,     │        512 │ conv5_block25_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block25_1_r… │ (None, 1, 1,     │          0 │ conv5_block25_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block25_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block25_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block25_con… │ (None, 1, 1,     │          0 │ conv5_block24_… │   -   │\n│ (Concatenate)      │ 1696)            │            │ conv5_block25_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block26_0_bn │ (None, 1, 1,     │      6,784 │ conv5_block25_… │   N   │\n│ (BatchNormalizati… │ 1696)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block26_0_r… │ (None, 1, 1,     │          0 │ conv5_block26_… │   -   │\n│ (Activation)       │ 1696)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block26_1_c… │ (None, 1, 1,     │    217,088 │ conv5_block26_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block26_1_bn │ (None, 1, 1,     │        512 │ conv5_block26_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block26_1_r… │ (None, 1, 1,     │          0 │ conv5_block26_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block26_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block26_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block26_con… │ (None, 1, 1,     │          0 │ conv5_block25_… │   -   │\n│ (Concatenate)      │ 1728)            │            │ conv5_block26_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block27_0_bn │ (None, 1, 1,     │      6,912 │ conv5_block26_… │   N   │\n│ (BatchNormalizati… │ 1728)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block27_0_r… │ (None, 1, 1,     │          0 │ conv5_block27_… │   -   │\n│ (Activation)       │ 1728)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block27_1_c… │ (None, 1, 1,     │    221,184 │ conv5_block27_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block27_1_bn │ (None, 1, 1,     │        512 │ conv5_block27_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block27_1_r… │ (None, 1, 1,     │          0 │ conv5_block27_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block27_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block27_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block27_con… │ (None, 1, 1,     │          0 │ conv5_block26_… │   -   │\n│ (Concatenate)      │ 1760)            │            │ conv5_block27_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block28_0_bn │ (None, 1, 1,     │      7,040 │ conv5_block27_… │   N   │\n│ (BatchNormalizati… │ 1760)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block28_0_r… │ (None, 1, 1,     │          0 │ conv5_block28_… │   -   │\n│ (Activation)       │ 1760)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block28_1_c… │ (None, 1, 1,     │    225,280 │ conv5_block28_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block28_1_bn │ (None, 1, 1,     │        512 │ conv5_block28_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block28_1_r… │ (None, 1, 1,     │          0 │ conv5_block28_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block28_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block28_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block28_con… │ (None, 1, 1,     │          0 │ conv5_block27_… │   -   │\n│ (Concatenate)      │ 1792)            │            │ conv5_block28_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block29_0_bn │ (None, 1, 1,     │      7,168 │ conv5_block28_… │   N   │\n│ (BatchNormalizati… │ 1792)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block29_0_r… │ (None, 1, 1,     │          0 │ conv5_block29_… │   -   │\n│ (Activation)       │ 1792)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block29_1_c… │ (None, 1, 1,     │    229,376 │ conv5_block29_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block29_1_bn │ (None, 1, 1,     │        512 │ conv5_block29_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block29_1_r… │ (None, 1, 1,     │          0 │ conv5_block29_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block29_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block29_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block29_con… │ (None, 1, 1,     │          0 │ conv5_block28_… │   -   │\n│ (Concatenate)      │ 1824)            │            │ conv5_block29_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block30_0_bn │ (None, 1, 1,     │      7,296 │ conv5_block29_… │   N   │\n│ (BatchNormalizati… │ 1824)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block30_0_r… │ (None, 1, 1,     │          0 │ conv5_block30_… │   -   │\n│ (Activation)       │ 1824)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block30_1_c… │ (None, 1, 1,     │    233,472 │ conv5_block30_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block30_1_bn │ (None, 1, 1,     │        512 │ conv5_block30_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block30_1_r… │ (None, 1, 1,     │          0 │ conv5_block30_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block30_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block30_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block30_con… │ (None, 1, 1,     │          0 │ conv5_block29_… │   -   │\n│ (Concatenate)      │ 1856)            │            │ conv5_block30_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block31_0_bn │ (None, 1, 1,     │      7,424 │ conv5_block30_… │   N   │\n│ (BatchNormalizati… │ 1856)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block31_0_r… │ (None, 1, 1,     │          0 │ conv5_block31_… │   -   │\n│ (Activation)       │ 1856)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block31_1_c… │ (None, 1, 1,     │    237,568 │ conv5_block31_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block31_1_bn │ (None, 1, 1,     │        512 │ conv5_block31_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block31_1_r… │ (None, 1, 1,     │          0 │ conv5_block31_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block31_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block31_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block31_con… │ (None, 1, 1,     │          0 │ conv5_block30_… │   -   │\n│ (Concatenate)      │ 1888)            │            │ conv5_block31_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block32_0_bn │ (None, 1, 1,     │      7,552 │ conv5_block31_… │   N   │\n│ (BatchNormalizati… │ 1888)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block32_0_r… │ (None, 1, 1,     │          0 │ conv5_block32_… │   -   │\n│ (Activation)       │ 1888)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block32_1_c… │ (None, 1, 1,     │    241,664 │ conv5_block32_… │   N   │\n│ (Conv2D)           │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block32_1_bn │ (None, 1, 1,     │        512 │ conv5_block32_… │   N   │\n│ (BatchNormalizati… │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block32_1_r… │ (None, 1, 1,     │          0 │ conv5_block32_… │   -   │\n│ (Activation)       │ 128)             │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block32_2_c… │ (None, 1, 1, 32) │     36,864 │ conv5_block32_… │   N   │\n│ (Conv2D)           │                  │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ conv5_block32_con… │ (None, 1, 1,     │          0 │ conv5_block31_… │   -   │\n│ (Concatenate)      │ 1920)            │            │ conv5_block32_… │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ bn                 │ (None, 1, 1,     │      7,680 │ conv5_block32_… │   N   │\n│ (BatchNormalizati… │ 1920)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ relu (Activation)  │ (None, 1, 1,     │          0 │ bn[0][0]        │   -   │\n│                    │ 1920)            │            │                 │       │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ dense_4 (Dense)    │ (None, 1, 1, 10) │     19,210 │ relu[0][0]      │   Y   │\n├────────────────────┼──────────────────┼────────────┼─────────────────┼───────┤\n│ flatten_3          │ (None, 10)       │          0 │ dense_4[0][0]   │   -   │\n│ (Flatten)          │                  │            │                 │       │\n└────────────────────┴──────────────────┴────────────┴─────────────────┴───────┘\n Total params: 18,341,194 (69.97 MB)\n Trainable params: 19,210 (75.04 KB)\n Non-trainable params: 18,321,984 (69.89 MB)\n```\n:::\n:::\n\n\nAnd then the usual training:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tensorflow)\nlibrary(keras3)\n\nmodel |>\n  keras3::compile(loss = keras3::loss_categorical_crossentropy, \n                 optimizer = optimizer_adamax())\n\nmodel |>\n  fit(\n    x = train_x, \n    y = train_y,\n    epochs = 1L,\n    batch_size = 32L,\n    shuffle = TRUE,\n    validation_split = 0.2\n  )\n```\n:::\n\n\nWe have seen, that transfer learning can easily be done using Keras.\n\n## Torch\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(torchvision)\nlibrary(torch)\ntorch_manual_seed(321L)\nset.seed(123)\n\ntrain_ds = cifar10_dataset(\".\", download = TRUE, train = TRUE,\n                           transform = transform_to_tensor)\ntest_ds = cifar10_dataset(\".\", download = TRUE, train = FALSE,\n                          transform = transform_to_tensor)\n\ntrain_dl = dataloader(train_ds, batch_size = 100L, shuffle = TRUE)\ntest_dl = dataloader(test_ds, batch_size = 100L)\n\nmodel_torch = model_resnet18(pretrained = TRUE)\n\n# We will set all model parameters to constant values:\nmodel_torch$parameters |>\n  purrr::walk(function(param) param$requires_grad_(FALSE))\n\n# Let's replace the last layer (last layer is named 'fc') with our own layer:\ninFeat = model_torch$fc$in_features\nmodel_torch$fc = nn_linear(inFeat, out_features = 10L)\n\nopt = optim_adam(params = model_torch$parameters, lr = 0.01)\n\nfor(e in 1:1){\n  losses = c()\n  coro::loop(\n    for(batch in train_dl){\n      opt$zero_grad()\n      pred = model_torch(batch[[1]])\n      loss = nnf_cross_entropy(pred, batch[[2]], reduction = \"mean\")\n      loss$backward()\n      opt$step()\n      losses = c(losses, loss$item())\n    }\n  )\n  \n  cat(sprintf(\"Loss at epoch %d: %3f\\n\", e, mean(losses)))\n}\n\nmodel_torch$eval()\n\ntest_losses = c()\ntotal = 0\ncorrect = 0\n\ncoro::loop(\n  for(batch in test_dl){\n    output = model_torch(batch[[1]])\n    labels = batch[[2]]\n    loss = nnf_cross_entropy(output, labels)\n    test_losses = c(test_losses, loss$item())\n    predicted = torch_max(output$data(), dim = 2)[[2]]\n    total = total + labels$size(1)\n    correct = correct + (predicted == labels)$sum()$item()\n  }\n)\n\ntest_accuracy =  correct/total\nprint(test_accuracy)\n```\n:::\n\n:::\n\n### Example: Flower dataset\n\nLet's do that with our flower data set:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(keras3)\nlibrary(tensorflow)\n\ndata = EcoData::dataset_flower()\n\ntrain = data$train/127.5 - 1 \ntest = data$test/127.5 - 1\nlabels = data$labels\n\n\n# Transfer learning\n\n# weights were trained to imagenet\npretrained_model = keras3::application_efficientnet_b1(include_top = FALSE,\n                                                      input_shape = c(80L, 80L, 3L))\n# pretrained_model\n\nkeras3::freeze_weights(pretrained_model)\npretrained_model\n\n# Build model\n\ndnn = pretrained_model$output |> \n  layer_flatten() |> \n  layer_dropout(0.2) |> \n  layer_dense(units = 5L, activation = \"softmax\")\ndnn\n\nmodel = keras_model(inputs = pretrained_model$input,\n                    outputs = dnn\n                    )\nmodel |>\n  keras3::compile(loss = loss_categorical_crossentropy,\n                 optimizer = keras3::optimizer_rmsprop(learning_rate = 0.0005))\n\n\nmodel |> \n  fit(x = train, y = k_one_hot(labels, 5L), validation_split = 0.2, epochs = 5L)\n\n\n\n# Data augmentation\n# Transfer learning\n\n# weights were trained to imagenet\npretrained_model = keras3::application_efficientnet_b1(include_top = FALSE,\n                                                      input_shape = c(80L, 80L, 3L))\n# pretrained_model\n\nkeras3::freeze_weights(pretrained_model)\npretrained_model\n\n# Build model\n\ndnn = pretrained_model$output |> \n  layer_flatten() |> \n  layer_dropout(0.2) |> \n  layer_dense(units = 5L, activation = \"softmax\")\ndnn\n\nmodel = keras_model(inputs = pretrained_model$input,\n                    outputs = dnn\n)\n\n### Set up augmentation\naug = keras::image_data_generator(rotation_range = 180, zoom_range = 0.4,\n                           width_shift_range = 0.2, height_shift_range = 0.2,\n                           vertical_flip = TRUE, horizontal_flip = TRUE)\n\n\n### Set up the data\nindices = sample.int(nrow(train), 0.1 * nrow(train)) # for validation\ngenerator = keras::flow_images_from_data(x = train[-indices,,,],\n                                  y = k_one_hot(labels[-indices], 5L),\n                                  generator = aug\n                                  )\ngenerator\n\n\nmodel |>\n  keras3::compile(loss = keras3::loss_categorical_crossentropy,\n                 optimizer = keras::optimizer_rmsprop(learning_rate = 0.0005))\n\nsteps_per_epoch = nrow(train[-indices,,,]) /45\nsteps_per_epoch = floor(steps_per_epoch)\n\nmodel %>% \n  fit(generator, epochs = 5L, batch_size = 45L, steps_per_epoch = steps_per_epoch, \n      validation_data = list(train[indices,,,], k_one_hot(labels[indices], 5L))\n      )\n\npred = predict(model, test)\npred = apply(pred, 1, which.max) - 1\npred\n```\n:::\n",
    "supporting": [
      "C3-ConvolutionalNeuralNetworks_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}