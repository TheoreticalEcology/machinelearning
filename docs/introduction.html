<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Introduction to Machine Learning | A Minimal Book Example</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Introduction to Machine Learning | A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Introduction to Machine Learning | A Minimal Book Example" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Maximilian Pichler and Florian Hartig" />


<meta name="date" content="2021-04-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="fund.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction to Machine Learning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#supervised-learning-regression-and-classification"><i class="fa fa-check"></i><b>2.1</b> Supervised learning: regression and classification</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#supervised-learning-using-random-forest"><i class="fa fa-check"></i><b>2.1.1</b> Supervised learning using Random Forest</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fund.html"><a href="fund.html"><i class="fa fa-check"></i><b>3</b> Fundamental principles and techniques</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Introduction to Machine Learning</h1>
<p>In this lesson, we introduce the three basic ML tasks: supervised regression and classification, and unsupervised learning.</p>
<p>In ML, we distinguish 3 basic learning paradigms:</p>
<ul>
<li>Supervised learning</li>
<li>Unsupervised learning</li>
<li>Reinforcement learning
We will speak about reinforcement learning at the end of the course. Now, we want to look at examples of supervised and unsupervised learning. Before you start with the code, here a video to remind you of what we talked about in the class:</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/watch?v=1AVrWvRvfxs" frameborder="0" allow="accelerometer; autoplay; encrypted-media;
  gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="supervised-learning-regression-and-classification" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Supervised learning: regression and classification</h2>
<p>Two two main subbranches of supervised learning are regression and classification. Here a video that explains again the difference</p>
<iframe width="560" height="315" src="https://www.youtube.com/watch?v=i04Pfrb71vk" frameborder="0" allow="accelerometer; autoplay; encrypted-media;
  gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="supervised-learning-using-random-forest" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Supervised learning using Random Forest</h3>
<p>The random forest (RF) algorithm is possibly the most widely used ML algorithm and can be used for regression and classification. We will talk more about the algorithm on Day 2. Here an example of a regression:</p>
<p>Visualization of the data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="introduction.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris, <span class="at">col =</span> iris<span class="sc">$</span>Species)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Fitting the model</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="introduction.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb2-2"><a href="introduction.html#cb2-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Sepal.Length <span class="sc">~</span> ., <span class="at">data =</span> iris)</span>
<span id="cb2-3"><a href="introduction.html#cb2-3" aria-hidden="true" tabindex="-1"></a>m1</span></code></pre></div>
<pre><code>## 
## Call:
##  randomForest(formula = Sepal.Length ~ ., data = iris) 
##                Type of random forest: regression
##                      Number of trees: 500
## No. of variables tried at each split: 1
## 
##           Mean of squared residuals: 0.138578
##                     % Var explained: 79.65</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="introduction.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(m1)</span></code></pre></div>
<pre><code>## List of 18
##  $ call           : language randomForest(formula = Sepal.Length ~ ., data = iris)
##  $ type           : chr &quot;regression&quot;
##  $ predicted      : Named num [1:150] 5.05 4.79 4.82 4.9 5.05 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:150] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ mse            : num [1:500] 0.279 0.248 0.206 0.209 0.19 ...
##  $ rsq            : num [1:500] 0.59 0.635 0.697 0.693 0.721 ...
##  $ oob.times      : int [1:150] 187 174 179 190 197 187 193 202 193 174 ...
##  $ importance     : num [1:4, 1] 9.43 36.01 24.29 18.52
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:4] &quot;Sepal.Width&quot; &quot;Petal.Length&quot; &quot;Petal.Width&quot; &quot;Species&quot;
##   .. ..$ : chr &quot;IncNodePurity&quot;
##  $ importanceSD   : NULL
##  $ localImportance: NULL
##  $ proximity      : NULL
##  $ ntree          : num 500
##  $ mtry           : num 1
##  $ forest         :List of 11
##   ..$ ndbigtree    : int [1:500] 25 33 45 11 47 45 55 39 59 69 ...
##   ..$ nodestatus   : int [1:87, 1:500] -3 -1 -3 -3 -3 -1 -1 -1 -3 -1 ...
##   ..$ leftDaughter : int [1:87, 1:500] 2 0 4 6 8 0 0 0 10 0 ...
##   ..$ rightDaughter: int [1:87, 1:500] 3 0 5 7 9 0 0 0 11 0 ...
##   ..$ nodepred     : num [1:87, 1:500] 5.83 5.01 6.27 5.81 6.64 ...
##   ..$ bestvar      : int [1:87, 1:500] 4 0 3 4 4 0 0 0 3 0 ...
##   ..$ xbestsplit   : num [1:87, 1:500] 1 0 1.55 3 3 0 0 0 1.7 0 ...
##   ..$ ncat         : Named int [1:4] 1 1 1 3
##   .. ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;Sepal.Width&quot; &quot;Petal.Length&quot; &quot;Petal.Width&quot; &quot;Species&quot;
##   ..$ nrnodes      : int 87
##   ..$ ntree        : num 500
##   ..$ xlevels      :List of 4
##   .. ..$ Sepal.Width : num 0
##   .. ..$ Petal.Length: num 0
##   .. ..$ Petal.Width : num 0
##   .. ..$ Species     : chr [1:3] &quot;setosa&quot; &quot;versicolor&quot; &quot;virginica&quot;
##  $ coefs          : NULL
##  $ y              : Named num [1:150] 5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:150] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ test           : NULL
##  $ inbag          : NULL
##  $ terms          :Classes &#39;terms&#39;, &#39;formula&#39;  language Sepal.Length ~ Sepal.Width + Petal.Length + Petal.Width + Species
##   .. ..- attr(*, &quot;variables&quot;)= language list(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width, Species)
##   .. ..- attr(*, &quot;factors&quot;)= int [1:5, 1:4] 0 1 0 0 0 0 0 1 0 0 ...
##   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. ..$ : chr [1:5] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot; &quot;Petal.Length&quot; &quot;Petal.Width&quot; ...
##   .. .. .. ..$ : chr [1:4] &quot;Sepal.Width&quot; &quot;Petal.Length&quot; &quot;Petal.Width&quot; &quot;Species&quot;
##   .. ..- attr(*, &quot;term.labels&quot;)= chr [1:4] &quot;Sepal.Width&quot; &quot;Petal.Length&quot; &quot;Petal.Width&quot; &quot;Species&quot;
##   .. ..- attr(*, &quot;order&quot;)= int [1:4] 1 1 1 1
##   .. ..- attr(*, &quot;intercept&quot;)= num 0
##   .. ..- attr(*, &quot;response&quot;)= int 1
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. ..- attr(*, &quot;predvars&quot;)= language list(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width, Species)
##   .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:5] &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot; &quot;Petal.Length&quot; &quot;Petal.Width&quot; ...
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;randomForest.formula&quot; &quot;randomForest&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="introduction.html#cb6-1" aria-hidden="true" tabindex="-1"></a>m1<span class="sc">$</span>type</span></code></pre></div>
<pre><code>## [1] &quot;regression&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="introduction.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m1)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8        9       10       11       12       13       14       15       16       17       18       19 
## 5.048227 4.791602 4.821321 4.896872 5.046528 5.258342 5.051487 5.045918 4.886781 4.831721 5.069927 5.050196 4.785942 4.840265 5.136063 5.227834 5.219323 5.014908 5.121200 
##       20       21       22       23       24       25       26       27       28       29       30       31       32       33       34       35       36       37       38 
## 5.158064 5.016156 5.239965 5.078575 5.037571 5.143319 4.835697 5.158667 5.051940 4.962399 4.876937 4.858977 5.106878 5.183368 5.174308 4.856386 4.780313 4.979490 5.001454 
##       39       40       41       42       43       44       45       46       47       48       49       50       51       52       53       54       55       56       57 
## 4.830984 5.022337 5.049430 4.885854 4.827345 5.154166 5.277677 4.809647 5.155668 4.876257 5.106157 4.858944 6.362823 6.255644 6.367712 5.789459 6.135997 6.099845 6.445500 
##       58       59       60       61       62       63       64       65       66       67       68       69       70       71       72       73       74       75       76 
## 5.375279 6.068433 5.890296 5.533434 5.883066 5.471623 6.368282 5.698698 6.236297 6.100867 5.611500 5.944680 5.507799 6.527189 5.743231 6.173480 6.079231 5.930815 6.048527 
##       77       78       79       80       81       82       83       84       85       86       87       88       89       90       91       92       93       94       95 
## 6.192645 6.205715 6.055249 5.307513 5.503438 5.495045 5.610894 6.247933 6.117162 6.276979 6.441353 5.810871 5.877433 5.723043 5.970091 6.314950 5.674296 5.327069 5.782938 
##       96       97       98       99      100      101      102      103      104      105      106      107      108      109      110      111      112      113      114 
## 5.809813 5.883817 5.992149 5.356657 5.815680 6.922531 6.229740 6.714294 6.471507 6.829021 7.194308 6.217358 6.998392 6.361898 7.118721 6.528975 6.186144 6.650292 6.254084 
##      115      116      117      118      119      120      121      122      123      124      125      126      127      128      129      130      131      132      133 
## 6.507916 6.678694 6.427751 7.171490 6.778061 6.078018 6.661702 6.442837 7.015055 6.149190 6.755917 6.731781 6.263003 6.322429 6.504487 6.408359 6.861088 7.088942 6.508262 
##      134      135      136      137      138      139      140      141      142      143      144      145      146      147      148      149      150 
## 6.194025 6.275319 6.986006 6.579855 6.558599 6.331613 6.623549 6.581921 6.542212 6.243421 6.792504 6.631026 6.596481 6.047706 6.516051 6.658395 6.393134</code></pre>
<p>Visualization of the results</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="introduction.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb10-2"><a href="introduction.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predict</span>(m1), iris<span class="sc">$</span>Sepal.Length, <span class="at">xlab =</span> <span class="st">&quot;predicted&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;observed&quot;</span>)</span>
<span id="cb10-3"><a href="introduction.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb10-4"><a href="introduction.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(m1)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>This is a nice visualization of the RF structure, but requires to load a package from GitHub</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="introduction.html#cb11-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;araastat/reprtree&#39;</span>)</span></code></pre></div>
<pre><code>## Skipping install of &#39;reprtree&#39; from a github remote, the SHA1 (5cff507b) has not changed since last install.
##   Use `force = TRUE` to force installation</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="introduction.html#cb13-1" aria-hidden="true" tabindex="-1"></a>reprtree<span class="sc">:::</span><span class="fu">plot.getTree</span>(m1, iris)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fund.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
