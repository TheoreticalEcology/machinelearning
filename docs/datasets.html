<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Datasets | Machine Learning and AI in TensorFlow and R</title>
  <meta name="description" content="7 Datasets | Machine Learning and AI in TensorFlow and R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Datasets | Machine Learning and AI in TensorFlow and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="7 Datasets | Machine Learning and AI in TensorFlow and R" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Datasets | Machine Learning and AI in TensorFlow and R" />
  
  <meta name="twitter:description" content="7 Datasets | Machine Learning and AI in TensorFlow and R" />
  

<meta name="author" content="Maximilian Pichler and Florian Hartig" />


<meta name="date" content="2021-05-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gans-vaes-and-reinforcement-learning.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction to Machine Learning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#unsupervised-learning"><i class="fa fa-check"></i><b>2.1</b> Unsupervised learning</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#hierarchical-clustering"><i class="fa fa-check"></i><b>2.1.1</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#k-means-clustering"><i class="fa fa-check"></i><b>2.1.2</b> k-means clustering</a></li>
<li class="chapter" data-level="2.1.3" data-path="introduction.html"><a href="introduction.html#density-based-clustering"><i class="fa fa-check"></i><b>2.1.3</b> Density-based clustering</a></li>
<li class="chapter" data-level="2.1.4" data-path="introduction.html"><a href="introduction.html#model-based-clustering"><i class="fa fa-check"></i><b>2.1.4</b> Model-based clustering</a></li>
<li class="chapter" data-level="2.1.5" data-path="introduction.html"><a href="introduction.html#ordination"><i class="fa fa-check"></i><b>2.1.5</b> Ordination</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#supervised-learning-regression-and-classification"><i class="fa fa-check"></i><b>2.2</b> Supervised learning: regression and classification</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#supervised-regression-using-random-forest"><i class="fa fa-check"></i><b>2.2.1</b> Supervised regression using Random Forest</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction.html"><a href="introduction.html#supervised-classification-using-random-forest"><i class="fa fa-check"></i><b>2.2.2</b> Supervised classification using Random Forest</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#introduction-to-tensorflow"><i class="fa fa-check"></i><b>2.3</b> Introduction to Tensorflow</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#tensorflow-data-containers"><i class="fa fa-check"></i><b>2.3.1</b> Tensorflow data containers</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#tensorflow-data-types---good-practise-with-r-tf"><i class="fa fa-check"></i><b>2.3.2</b> Tensorflow data types - good practise with R-TF</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#introduction-to-pytorch"><i class="fa fa-check"></i><b>2.4</b> Introduction to PyTorch</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction.html"><a href="introduction.html#pytorch-data-containers"><i class="fa fa-check"></i><b>2.4.1</b> PyTorch data containers</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction.html"><a href="introduction.html#torch-data-types---good-practise-with-r-tf"><i class="fa fa-check"></i><b>2.4.2</b> Torch data types - good practise with R-TF</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#first-steps-with-the-keras-framework"><i class="fa fa-check"></i><b>2.5</b> First steps with the keras framework</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction.html"><a href="introduction.html#example-workflow-in-keras"><i class="fa fa-check"></i><b>2.5.1</b> Example workflow in keras</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fund.html"><a href="fund.html"><i class="fa fa-check"></i><b>3</b> Fundamental principles and techniques</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fund.html"><a href="fund.html#machine-learning-principles"><i class="fa fa-check"></i><b>3.1</b> Machine learning principles</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="fund.html"><a href="fund.html#optimization"><i class="fa fa-check"></i><b>3.1.1</b> Optimization</a></li>
<li class="chapter" data-level="3.1.2" data-path="fund.html"><a href="fund.html#regularization"><i class="fa fa-check"></i><b>3.1.2</b> Regularization</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fund.html"><a href="fund.html#tree-based-ml-algorithms"><i class="fa fa-check"></i><b>3.2</b> Tree-based ML algorithms</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="fund.html"><a href="fund.html#classification-and-regression-trees"><i class="fa fa-check"></i><b>3.2.1</b> Classification and Regression Trees</a></li>
<li class="chapter" data-level="3.2.2" data-path="fund.html"><a href="fund.html#random-forest"><i class="fa fa-check"></i><b>3.2.2</b> Random Forest</a></li>
<li class="chapter" data-level="3.2.3" data-path="fund.html"><a href="fund.html#boosted-regression-trees"><i class="fa fa-check"></i><b>3.2.3</b> Boosted regression trees</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="fund.html"><a href="fund.html#distance-based-algorithms"><i class="fa fa-check"></i><b>3.3</b> Distance-based algorithms</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="fund.html"><a href="fund.html#k-nearest-neighbor"><i class="fa fa-check"></i><b>3.3.1</b> k-nearest-neighbor</a></li>
<li class="chapter" data-level="3.3.2" data-path="fund.html"><a href="fund.html#support-vector-machines-svm"><i class="fa fa-check"></i><b>3.3.2</b> Support Vector Machines (SVM)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="fund.html"><a href="fund.html#artificial-neural-networks"><i class="fa fa-check"></i><b>3.4</b> Artificial neural networks</a></li>
<li class="chapter" data-level="3.5" data-path="fund.html"><a href="fund.html#the-standard-ml-pipeline-at-the-example-of-the-titanic-dataset"><i class="fa fa-check"></i><b>3.5</b> The standard ML pipeline at the example of the titanic dataset</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="fund.html"><a href="fund.html#data-cleaning"><i class="fa fa-check"></i><b>3.5.1</b> Data cleaning</a></li>
<li class="chapter" data-level="3.5.2" data-path="fund.html"><a href="fund.html#pre-processing-and-feature-selection"><i class="fa fa-check"></i><b>3.5.2</b> Pre-processing and feature selection</a></li>
<li class="chapter" data-level="3.5.3" data-path="fund.html"><a href="fund.html#split-data-for-training-and-testing"><i class="fa fa-check"></i><b>3.5.3</b> Split data for training and testing</a></li>
<li class="chapter" data-level="3.5.4" data-path="fund.html"><a href="fund.html#model-fitting"><i class="fa fa-check"></i><b>3.5.4</b> Model fitting</a></li>
<li class="chapter" data-level="3.5.5" data-path="fund.html"><a href="fund.html#model-evaluation"><i class="fa fa-check"></i><b>3.5.5</b> Model evaluation</a></li>
<li class="chapter" data-level="3.5.6" data-path="fund.html"><a href="fund.html#predictions-and-submission"><i class="fa fa-check"></i><b>3.5.6</b> Predictions and submission</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="fund.html"><a href="fund.html#mlr"><i class="fa fa-check"></i><b>3.6</b> Bonus - ML pipelines with mlr3</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="fund.html"><a href="fund.html#mlr3---the-basic-workflow"><i class="fa fa-check"></i><b>3.6.1</b> mlr3 - the basic workflow</a></li>
<li class="chapter" data-level="3.6.2" data-path="fund.html"><a href="fund.html#mlr3---hyper-parameter-tuning"><i class="fa fa-check"></i><b>3.6.2</b> mlr3 - hyper-parameter tuning</a></li>
<li class="chapter" data-level="3.6.3" data-path="fund.html"><a href="fund.html#mlr3---hyper-parameter-tuning-with-oversampling"><i class="fa fa-check"></i><b>3.6.3</b> mlr3 - hyper-parameter tuning with oversampling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Deep.html"><a href="Deep.html"><i class="fa fa-check"></i><b>4</b> Deep learning</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Deep.html"><a href="Deep.html#network-architectures"><i class="fa fa-check"></i><b>4.1</b> Network architectures</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="Deep.html"><a href="Deep.html#deep-neural-networks-dnns"><i class="fa fa-check"></i><b>4.1.1</b> Deep neural networks (DNNs)</a></li>
<li class="chapter" data-level="4.1.2" data-path="Deep.html"><a href="Deep.html#convolutional-neural-networks-dnns"><i class="fa fa-check"></i><b>4.1.2</b> Convolutional neural networks (DNNs)</a></li>
<li class="chapter" data-level="4.1.3" data-path="Deep.html"><a href="Deep.html#recurrent-neural-networks-rnns"><i class="fa fa-check"></i><b>4.1.3</b> Recurrent neural networks (RNNs)</a></li>
<li class="chapter" data-level="4.1.4" data-path="Deep.html"><a href="Deep.html#natural-language-processing-nlp"><i class="fa fa-check"></i><b>4.1.4</b> Natural language processing (NLP)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Deep.html"><a href="Deep.html#case-study-dropout-and-early-stopping-in-a-deep-neural-network"><i class="fa fa-check"></i><b>4.2</b> Case study: dropout and early stopping in a deep neural network</a></li>
<li class="chapter" data-level="4.3" data-path="Deep.html"><a href="Deep.html#case-study---fitting-a-convolutional-neural-networks-on-mnist"><i class="fa fa-check"></i><b>4.3</b> Case study - fitting a Convolutional Neural Networks on MNIST</a></li>
<li class="chapter" data-level="4.4" data-path="Deep.html"><a href="Deep.html#advanced-training-techniques"><i class="fa fa-check"></i><b>4.4</b> Advanced training techniques</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="Deep.html"><a href="Deep.html#data-augmentation"><i class="fa fa-check"></i><b>4.4.1</b> Data Augmentation</a></li>
<li class="chapter" data-level="4.4.2" data-path="Deep.html"><a href="Deep.html#transfer"><i class="fa fa-check"></i><b>4.4.2</b> Transfer learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html"><i class="fa fa-check"></i><b>5</b> Interpretation and causality with machine learning</a>
<ul>
<li class="chapter" data-level="5.1" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#explainable-ai"><i class="fa fa-check"></i><b>5.1</b> Explainable AI</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#a-practical-example"><i class="fa fa-check"></i><b>5.1.1</b> A practical example</a></li>
<li class="chapter" data-level="5.1.2" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#feature-importance"><i class="fa fa-check"></i><b>5.1.2</b> Feature Importance</a></li>
<li class="chapter" data-level="5.1.3" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#partial-dependencies"><i class="fa fa-check"></i><b>5.1.3</b> Partial dependencies</a></li>
<li class="chapter" data-level="5.1.4" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#accumulated-local-effects"><i class="fa fa-check"></i><b>5.1.4</b> Accumulated local effects</a></li>
<li class="chapter" data-level="5.1.5" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#friedmans-h-statistic"><i class="fa fa-check"></i><b>5.1.5</b> Friedmans H-statistic</a></li>
<li class="chapter" data-level="5.1.6" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#global-explainer---simplifying-the-ml-model"><i class="fa fa-check"></i><b>5.1.6</b> Global explainer - Simplifying the ML model</a></li>
<li class="chapter" data-level="5.1.7" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#local-explainer---lime-explaining-single-instances-observations"><i class="fa fa-check"></i><b>5.1.7</b> Local explainer - LIME explaining single instances (observations)</a></li>
<li class="chapter" data-level="5.1.8" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#local-explainer---shapley"><i class="fa fa-check"></i><b>5.1.8</b> Local explainer - Shapley</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#causal-inference-and-machine-learning"><i class="fa fa-check"></i><b>5.2</b> Causal inference and machine learning</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#causal-inference-on-static-data"><i class="fa fa-check"></i><b>5.2.1</b> Causal inference on static data</a></li>
<li class="chapter" data-level="5.2.2" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#structural-equation-models"><i class="fa fa-check"></i><b>5.2.2</b> Structural equation models</a></li>
<li class="chapter" data-level="5.2.3" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#automatic-causal-discovery"><i class="fa fa-check"></i><b>5.2.3</b> Automatic causal discovery</a></li>
<li class="chapter" data-level="5.2.4" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#causal-inference-on-dynamic-data"><i class="fa fa-check"></i><b>5.2.4</b> Causal inference on dynamic data</a></li>
<li class="chapter" data-level="5.2.5" data-path="interpretation-and-causality-with-machine-learning.html"><a href="interpretation-and-causality-with-machine-learning.html#outlook-for-machine-learning"><i class="fa fa-check"></i><b>5.2.5</b> Outlook for machine learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html"><i class="fa fa-check"></i><b>6</b> GANs, VAEs, and Reinforcement learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#generative-adversarial-network-gans"><i class="fa fa-check"></i><b>6.1</b> Generative adversarial network (GANs)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#mnist---gan-based-on-dnns"><i class="fa fa-check"></i><b>6.1.1</b> MNIST - GAN based on DNNs</a></li>
<li class="chapter" data-level="6.1.2" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#flower---gan"><i class="fa fa-check"></i><b>6.1.2</b> Flower - GAN</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#autoencoder"><i class="fa fa-check"></i><b>6.2</b> Autoencoder</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#autoencoder---mnist-cnn"><i class="fa fa-check"></i><b>6.2.1</b> Autoencoder - MNIST CNN</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#varational-autoencoder"><i class="fa fa-check"></i><b>6.3</b> Varational Autoencoder</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>7</b> Datasets</a>
<ul>
<li class="chapter" data-level="7.1" data-path="datasets.html"><a href="datasets.html#titanic"><i class="fa fa-check"></i><b>7.1</b> Titanic</a></li>
<li class="chapter" data-level="7.2" data-path="datasets.html"><a href="datasets.html#plant-pollinator-database"><i class="fa fa-check"></i><b>7.2</b> Plant-pollinator database</a></li>
<li class="chapter" data-level="7.3" data-path="datasets.html"><a href="datasets.html#wine"><i class="fa fa-check"></i><b>7.3</b> Wine</a></li>
<li class="chapter" data-level="7.4" data-path="datasets.html"><a href="datasets.html#nasa"><i class="fa fa-check"></i><b>7.4</b> Nasa</a></li>
<li class="chapter" data-level="7.5" data-path="datasets.html"><a href="datasets.html#flower"><i class="fa fa-check"></i><b>7.5</b> Flower</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning and AI in TensorFlow and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datasets" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Datasets</h1>
<p>You can download the datasets we use in the course <a href="http://rhsbio7.uni-regensburg.de:8500">here</a> (ignore browser warnings) or by installing the EcoData package:</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="datasets.html#cb420-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="at">repo =</span> <span class="st">&quot;florianhartig/EcoData&quot;</span>, <span class="at">subdir =</span> <span class="st">&quot;EcoData&quot;</span>, </span>
<span id="cb420-2"><a href="datasets.html#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="at">dependencies =</span> <span class="cn">TRUE</span>, <span class="at">build_vignettes =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div id="titanic" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Titanic</h2>
<p>The dataset is a collection of titanic passengers with information about their age, class, sex, and their survival status. The competition here is simple: train a ML model and predict the survival probability.</p>
<p>The titanic dataset is very well explored and serves as a stepping stone in many ML careers. For inspiration and data exploration notebooks, check out this kaggle competition: <a href="https://www.kaggle.com/c/titanic/data"></a></p>
<p><strong>Response variable:</strong> ‘survived’</p>
<p>A minimal working example:</p>
<ol style="list-style-type: decimal">
<li>Load dataset</li>
</ol>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="datasets.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load(&quot;datasets.RData&quot;)</span></span>
<span id="cb421-2"><a href="datasets.html#cb421-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EcoData)</span>
<span id="cb421-3"><a href="datasets.html#cb421-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(titanic_ml)</span>
<span id="cb421-4"><a href="datasets.html#cb421-4" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">=</span> titanic_ml</span>
<span id="cb421-5"><a href="datasets.html#cb421-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(titanic)</span></code></pre></div>
<pre><code>##      pclass         survived          name               sex           age              sibsp            parch            ticket          fare        
##  Min.   :1.000   Min.   :0.0000   Length:1309        female:466   Min.   : 0.1667   Min.   :0.0000   Min.   :0.000   CA. 2343:  11   Min.   :  0.000  
##  1st Qu.:2.000   1st Qu.:0.0000   Class :character   male  :843   1st Qu.:21.0000   1st Qu.:0.0000   1st Qu.:0.000   1601    :   8   1st Qu.:  7.896  
##  Median :3.000   Median :0.0000   Mode  :character                Median :28.0000   Median :0.0000   Median :0.000   CA 2144 :   8   Median : 14.454  
##  Mean   :2.295   Mean   :0.3853                                   Mean   :29.8811   Mean   :0.4989   Mean   :0.385   3101295 :   7   Mean   : 33.295  
##  3rd Qu.:3.000   3rd Qu.:1.0000                                   3rd Qu.:39.0000   3rd Qu.:1.0000   3rd Qu.:0.000   347077  :   7   3rd Qu.: 31.275  
##  Max.   :3.000   Max.   :1.0000                                   Max.   :80.0000   Max.   :8.0000   Max.   :9.000   347082  :   7   Max.   :512.329  
##                  NA&#39;s   :655                                      NA&#39;s   :263                                        (Other) :1261   NA&#39;s   :1        
##              cabin      embarked      boat          body                      home.dest  
##                 :1014    :  2           :823   Min.   :  1.0                       :564  
##  C23 C25 C27    :   6   C:270    13     : 39   1st Qu.: 72.0   New York, NY        : 64  
##  B57 B59 B63 B66:   5   Q:123    C      : 38   Median :155.0   London              : 14  
##  G6             :   5   S:914    15     : 37   Mean   :160.8   Montreal, PQ        : 10  
##  B96 B98        :   4            14     : 33   3rd Qu.:256.0   Cornwall / Akron, OH:  9  
##  C22 C26        :   4            4      : 31   Max.   :328.0   Paris, France       :  9  
##  (Other)        : 271            (Other):308   NA&#39;s   :1188    (Other)             :639</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Impute missing values (not our response variable!)</li>
</ol>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="datasets.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb423-2"><a href="datasets.html#cb423-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb423-3"><a href="datasets.html#cb423-3" aria-hidden="true" tabindex="-1"></a>titanic_imputed <span class="ot">=</span> titanic <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>name, <span class="sc">-</span>ticket, <span class="sc">-</span>cabin, <span class="sc">-</span>boat, <span class="sc">-</span>home.dest)</span>
<span id="cb423-4"><a href="datasets.html#cb423-4" aria-hidden="true" tabindex="-1"></a>titanic_imputed <span class="ot">=</span> missRanger<span class="sc">::</span><span class="fu">missRanger</span>(<span class="at">data =</span> titanic_imputed <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>survived))</span></code></pre></div>
<pre><code>## 
## Missing value imputation by random forests
## 
##   Variables to impute:       age, fare, body
##   Variables used to impute:  pclass, sex, age, sibsp, parch, fare, embarked, body
## iter 1:  ...
## iter 2:  ...
## iter 3:  ...</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="datasets.html#cb425-1" aria-hidden="true" tabindex="-1"></a>titanic_imputed<span class="sc">$</span>survived <span class="ot">=</span> titanic<span class="sc">$</span>survived</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Split into training and testing</li>
</ol>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="datasets.html#cb426-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> titanic_imputed[<span class="sc">!</span><span class="fu">is.na</span>(titanic<span class="sc">$</span>survived), ]</span>
<span id="cb426-2"><a href="datasets.html#cb426-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> titanic_imputed[<span class="fu">is.na</span>(titanic<span class="sc">$</span>survived), ]</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Train model</li>
</ol>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="datasets.html#cb427-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">glm</span>(survived<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">family =</span> <span class="fu">binomial</span>())</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="datasets.html#cb428-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(model, <span class="at">data =</span> test, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb428-2"><a href="datasets.html#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<pre><code>##        561        321       1177       1098       1252       1170 
## 0.79350595 0.30982388 0.01400816 0.12405376 0.14107743 0.11799810</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="datasets.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;glm.csv&quot;</span>)</span></code></pre></div>
<p>And submit the csv on <a href="http://rhsbio7.uni-regensburg.de:8500"></a></p>
</div>
<div id="plant-pollinator-database" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Plant-pollinator database</h2>
<p>The plant-pollinator database is a collection of plant-pollinator interactions with traits for plants and pollinators. The idea is pollinators interact with plants when their traits fit (e.g. the tongue of a bee needs to match the shape of a flower).
We explored the advantage of ML algorithms over traditional statistical models in predicting species interactions in our paper. If you are interested you can have a look <img src="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.13329" alt="here" />.</p>
<p><img src="images/TM.png" width="699" /></p>
<p><strong>Response variable:</strong> ‘interaction’</p>
<p>A minimal working example:</p>
<ol style="list-style-type: decimal">
<li>Load dataset</li>
</ol>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="datasets.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;datasets.RData&quot;</span>)</span>
<span id="cb431-2"><a href="datasets.html#cb431-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(EcoData)</span></span>
<span id="cb431-3"><a href="datasets.html#cb431-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data(plantPollinator_df)</span></span>
<span id="cb431-4"><a href="datasets.html#cb431-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plant_poll = plantPollinator_df</span></span>
<span id="cb431-5"><a href="datasets.html#cb431-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plant_poll)</span></code></pre></div>
<pre><code>##                     X                           Y             type              season             diameter        corolla             colour             nectar         
##  Vaccinium_corymbosum:  256   Andrena_wilkella   :   80   Length:20480       Length:20480       Min.   :  2.00   Length:20480       Length:20480       Length:20480      
##  Brassica_napus      :  256   Andrena_barbilabris:   80   Class :character   Class :character   1st Qu.:  5.00   Class :character   Class :character   Class :character  
##  Carum_carvi         :  256   Andrena_cineraria  :   80   Mode  :character   Mode  :character   Median : 19.00   Mode  :character   Mode  :character   Mode  :character  
##  Coriandrum_sativum  :  256   Andrena_flavipes   :   80                                         Mean   : 27.03                                                           
##  Daucus_carota       :  256   Andrena_gravida    :   80                                         3rd Qu.: 25.00                                                           
##  Malus_domestica     :  256   Andrena_haemorrhoa :   80                                         Max.   :150.00                                                           
##  (Other)             :18944   (Other)            :20000                                         NA&#39;s   :9472                                                             
##    b.system         s.pollination      inflorescence       composite            guild               tongue            body        sociality           feeding         
##  Length:20480       Length:20480       Length:20480       Length:20480       Length:20480       Min.   : 2.000   Min.   : 2.00   Length:20480       Length:20480      
##  Class :character   Class :character   Class :character   Class :character   Class :character   1st Qu.: 4.800   1st Qu.: 8.00   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character   Mode  :character   Median : 6.600   Median :10.50   Mode  :character   Mode  :character  
##                                                                                                 Mean   : 8.104   Mean   :10.66                                        
##                                                                                                 3rd Qu.:10.500   3rd Qu.:13.00                                        
##                                                                                                 Max.   :26.400   Max.   :25.00                                        
##                                                                                                 NA&#39;s   :17040    NA&#39;s   :6160                                         
##  interaction 
##  0   :14095  
##  1   :  595  
##  NA&#39;s: 5790  
##              
##              
##              
## </code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Impute missing values (not our response variable!)
We will select only a few predictors here (you can work with all predictors ofc).</li>
</ol>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="datasets.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb433-2"><a href="datasets.html#cb433-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb433-3"><a href="datasets.html#cb433-3" aria-hidden="true" tabindex="-1"></a>plant_poll_imputed <span class="ot">=</span> plant_poll <span class="sc">%&gt;%</span> <span class="fu">select</span>(diameter, corolla, tongue, body, interaction)</span>
<span id="cb433-4"><a href="datasets.html#cb433-4" aria-hidden="true" tabindex="-1"></a>plant_poll_imputed <span class="ot">=</span> missRanger<span class="sc">::</span><span class="fu">missRanger</span>(<span class="at">data =</span> plant_poll_imputed <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>interaction))</span></code></pre></div>
<pre><code>## 
## Missing value imputation by random forests
## 
##   Variables to impute:       diameter, corolla, tongue, body
##   Variables used to impute:  diameter, corolla, tongue, body
## iter 1:  ....
## iter 2:  ....
## iter 3:  ....
## iter 4:  ....</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="datasets.html#cb435-1" aria-hidden="true" tabindex="-1"></a>plant_poll_imputed<span class="sc">$</span>interaction <span class="ot">=</span> plant_poll<span class="sc">$</span>interaction</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Split into training and testing</li>
</ol>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="datasets.html#cb436-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> plant_poll_imputed[<span class="sc">!</span><span class="fu">is.na</span>(plant_poll_imputed<span class="sc">$</span>interaction), ]</span>
<span id="cb436-2"><a href="datasets.html#cb436-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> plant_poll_imputed[<span class="fu">is.na</span>(plant_poll_imputed<span class="sc">$</span>interaction), ]</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Train model</li>
</ol>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="datasets.html#cb437-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">glm</span>(interaction<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">family =</span> <span class="fu">binomial</span>())</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="datasets.html#cb438-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(model, <span class="at">data =</span> test, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb438-2"><a href="datasets.html#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<pre><code>##       3871       3872       3873       3874       3875       3876 
## 0.03850223 0.03726134 0.03917270 0.04460708 0.04456360 0.03910827</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="datasets.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;glm.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="wine" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Wine</h2>
<p>The dataset is a collection of wines of different quality. The aim is to predict the quality of the wine based on physochemical predictors.</p>
<p>For inspiration and data exploration notebooks, check out this kaggle competition: <a href="https://www.kaggle.com/uciml/red-wine-quality-cortez-et-al-2009"></a>
For instance, check out this very nice <a href="https://www.kaggle.com/aditimulye/red-wine-quality-assesment-starter-pack">notebook</a> which removes a few problems from the data.</p>
<p><strong>Response variable:</strong> ‘quality’</p>
<p>We could use theoretically a regression model for this task but we will stick with a classification model</p>
<p>A minimal working example:</p>
<ol style="list-style-type: decimal">
<li>Load dataset</li>
</ol>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="datasets.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;datasets.RData&quot;</span>)</span>
<span id="cb441-2"><a href="datasets.html#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(EcoData)</span></span>
<span id="cb441-3"><a href="datasets.html#cb441-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data(wine)</span></span>
<span id="cb441-4"><a href="datasets.html#cb441-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine)</span></code></pre></div>
<pre><code>##  fixed.acidity    volatile.acidity  citric.acid     residual.sugar     chlorides       free.sulfur.dioxide total.sulfur.dioxide    density             pH       
##  Min.   : 4.600   Min.   :0.1200   Min.   :0.0000   Min.   : 0.900   Min.   :0.01200   Min.   : 1.00       Min.   :  6.00       Min.   :0.9901   Min.   :2.740  
##  1st Qu.: 7.100   1st Qu.:0.3900   1st Qu.:0.0900   1st Qu.: 1.900   1st Qu.:0.07000   1st Qu.: 7.00       1st Qu.: 22.00       1st Qu.:0.9956   1st Qu.:3.210  
##  Median : 7.900   Median :0.5200   Median :0.2600   Median : 2.200   Median :0.07900   Median :14.00       Median : 38.00       Median :0.9968   Median :3.310  
##  Mean   : 8.335   Mean   :0.5284   Mean   :0.2705   Mean   : 2.533   Mean   :0.08747   Mean   :15.83       Mean   : 46.23       Mean   :0.9968   Mean   :3.311  
##  3rd Qu.: 9.300   3rd Qu.:0.6400   3rd Qu.:0.4200   3rd Qu.: 2.600   3rd Qu.:0.09000   3rd Qu.:21.00       3rd Qu.: 62.00       3rd Qu.:0.9979   3rd Qu.:3.400  
##  Max.   :15.900   Max.   :1.5800   Max.   :1.0000   Max.   :15.500   Max.   :0.61100   Max.   :72.00       Max.   :289.00       Max.   :1.0037   Max.   :4.010  
##  NA&#39;s   :70       NA&#39;s   :48       NA&#39;s   :41       NA&#39;s   :60       NA&#39;s   :37        NA&#39;s   :78          NA&#39;s   :78           NA&#39;s   :78       NA&#39;s   :25     
##    sulphates         alcohol         quality     
##  Min.   :0.3300   Min.   : 8.40   Min.   :3.000  
##  1st Qu.:0.5500   1st Qu.: 9.50   1st Qu.:5.000  
##  Median :0.6200   Median :10.20   Median :6.000  
##  Mean   :0.6572   Mean   :10.42   Mean   :5.596  
##  3rd Qu.:0.7300   3rd Qu.:11.10   3rd Qu.:6.000  
##  Max.   :2.0000   Max.   :14.90   Max.   :8.000  
##  NA&#39;s   :51                       NA&#39;s   :905</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Impute missing values (not our response variable!)</li>
</ol>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="datasets.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb443-2"><a href="datasets.html#cb443-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb443-3"><a href="datasets.html#cb443-3" aria-hidden="true" tabindex="-1"></a><span class="co">#wine_imputed = titanic %&gt;% select(-name, -ticket, -cabin, -boat, -home.dest)</span></span>
<span id="cb443-4"><a href="datasets.html#cb443-4" aria-hidden="true" tabindex="-1"></a>wine_imputed <span class="ot">=</span> missRanger<span class="sc">::</span><span class="fu">missRanger</span>(<span class="at">data =</span> wine <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>quality))</span></code></pre></div>
<pre><code>## 
## Missing value imputation by random forests
## 
##   Variables to impute:       fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, total.sulfur.dioxide, density, pH, sulphates
##   Variables used to impute:  fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, total.sulfur.dioxide, density, pH, sulphates, alcohol
## iter 1:  ..........
## iter 2:  ..........
## iter 3:  ..........
## iter 4:  ..........
## iter 5:  ..........</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="datasets.html#cb445-1" aria-hidden="true" tabindex="-1"></a>wine_imputed<span class="sc">$</span>quality <span class="ot">=</span> wine<span class="sc">$</span>quality</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Split into training and testing</li>
</ol>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="datasets.html#cb446-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> wine_imputed[<span class="sc">!</span><span class="fu">is.na</span>(wine<span class="sc">$</span>quality), ]</span>
<span id="cb446-2"><a href="datasets.html#cb446-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> wine_imputed[<span class="fu">is.na</span>(wine<span class="sc">$</span>quality), ]</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Train model</li>
</ol>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="datasets.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span>
<span id="cb447-2"><a href="datasets.html#cb447-2" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">=</span> <span class="fu">ranger</span>(quality<span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">classification =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="datasets.html#cb448-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(rf, <span class="at">data =</span> test)<span class="sc">$</span>predictions</span>
<span id="cb448-2"><a href="datasets.html#cb448-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<pre><code>## [1] 6 5 5 7 6 6</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="datasets.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;rf.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="nasa" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Nasa</h2>
<p>A collection about asteroids and their characteristics from kaggle. The aim is to predict whether the asteroids are hazardous or not.
For inspiration and data exploration notebooks, check out the kaggle competition: <a href="https://www.kaggle.com/shrutimehta/nasa-asteroids-classification"></a></p>
<p><strong>Response variable:</strong> ‘Hazardous’
1. Load dataset</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="datasets.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;datasets.RData&quot;</span>)</span>
<span id="cb451-2"><a href="datasets.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(EcoData)</span></span>
<span id="cb451-3"><a href="datasets.html#cb451-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data(nasa)</span></span>
<span id="cb451-4"><a href="datasets.html#cb451-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nasa)</span></code></pre></div>
<pre><code>##  Neo.Reference.ID       Name         Absolute.Magnitude Est.Dia.in.KM.min. Est.Dia.in.KM.max. Est.Dia.in.M.min.   Est.Dia.in.M.max.  Est.Dia.in.Miles.min.
##  Min.   :2000433   Min.   :2000433   Min.   :11.16      Min.   : 0.00101   Min.   : 0.00226   Min.   :    1.011   Min.   :    2.26   Min.   :0.00063      
##  1st Qu.:3102682   1st Qu.:3102683   1st Qu.:20.10      1st Qu.: 0.03346   1st Qu.: 0.07482   1st Qu.:   33.462   1st Qu.:   74.82   1st Qu.:0.02079      
##  Median :3514800   Median :3514800   Median :21.90      Median : 0.11080   Median : 0.24777   Median :  110.804   Median :  247.77   Median :0.06885      
##  Mean   :3272675   Mean   :3273113   Mean   :22.27      Mean   : 0.20523   Mean   : 0.45754   Mean   :  204.649   Mean   :  458.45   Mean   :0.12734      
##  3rd Qu.:3690987   3rd Qu.:3690385   3rd Qu.:24.50      3rd Qu.: 0.25384   3rd Qu.: 0.56760   3rd Qu.:  253.837   3rd Qu.:  567.60   3rd Qu.:0.15773      
##  Max.   :3781897   Max.   :3781897   Max.   :32.10      Max.   :15.57955   Max.   :34.83694   Max.   :15579.552   Max.   :34836.94   Max.   :9.68068      
##  NA&#39;s   :53        NA&#39;s   :57        NA&#39;s   :36         NA&#39;s   :60         NA&#39;s   :23         NA&#39;s   :29          NA&#39;s   :46         NA&#39;s   :42           
##  Est.Dia.in.Miles.max. Est.Dia.in.Feet.min. Est.Dia.in.Feet.max. Close.Approach.Date Epoch.Date.Close.Approach Relative.Velocity.km.per.sec Relative.Velocity.km.per.hr
##  Min.   : 0.00140      Min.   :    3.32     Min.   :     7.41    2016-07-22:  18     Min.   :7.889e+11         Min.   : 0.3355              Min.   :  1208             
##  1st Qu.: 0.04649      1st Qu.:  109.78     1st Qu.:   245.49    2015-01-15:  17     1st Qu.:1.016e+12         1st Qu.: 8.4497              1st Qu.: 30399             
##  Median : 0.15395      Median :  363.53     Median :   812.88    2015-02-15:  16     Median :1.203e+12         Median :12.9370              Median : 46532             
##  Mean   : 0.28486      Mean   :  670.44     Mean   :  1500.77    2007-11-08:  15     Mean   :1.180e+12         Mean   :13.9848              Mean   : 50298             
##  3rd Qu.: 0.35269      3rd Qu.:  832.80     3rd Qu.:  1862.19    2012-01-15:  15     3rd Qu.:1.356e+12         3rd Qu.:18.0774              3rd Qu.: 65068             
##  Max.   :21.64666      Max.   :51114.02     Max.   :114294.42    (Other)   :4577     Max.   :1.473e+12         Max.   :44.6337              Max.   :160681             
##  NA&#39;s   :50            NA&#39;s   :21           NA&#39;s   :46           NA&#39;s      :  29     NA&#39;s   :43                NA&#39;s   :27                   NA&#39;s   :28                 
##  Miles.per.hour    Miss.Dist..Astronomical. Miss.Dist..lunar.   Miss.Dist..kilometers. Miss.Dist..miles.  Orbiting.Body    Orbit.ID             Orbit.Determination.Date
##  Min.   :  750.5   Min.   :0.00018          Min.   :  0.06919   Min.   :   26610       Min.   :   16535   Earth:4665    Min.   :  1.00   2017-06-21 06:17:20:   9       
##  1st Qu.:18846.7   1st Qu.:0.13341          1st Qu.: 51.89874   1st Qu.:19964907       1st Qu.:12454813   NA&#39;s :  22    1st Qu.:  9.00   2017-04-06 08:57:13:   8       
##  Median :28893.7   Median :0.26497          Median :103.19415   Median :39685408       Median :24662435                 Median : 16.00   2017-04-06 09:24:24:   8       
##  Mean   :31228.0   Mean   :0.25690          Mean   : 99.91366   Mean   :38436154       Mean   :23885560                 Mean   : 28.34   2017-04-06 08:24:13:   7       
##  3rd Qu.:40436.9   3rd Qu.:0.38506          3rd Qu.:149.59244   3rd Qu.:57540318       3rd Qu.:35714721                 3rd Qu.: 31.00   2017-04-06 08:26:19:   7       
##  Max.   :99841.2   Max.   :0.49988          Max.   :194.45491   Max.   :74781600       Max.   :46467132                 Max.   :611.00   (Other)            :4622       
##  NA&#39;s   :38        NA&#39;s   :60               NA&#39;s   :30          NA&#39;s   :56             NA&#39;s   :27                       NA&#39;s   :33       NA&#39;s               :  26       
##  Orbit.Uncertainity Minimum.Orbit.Intersection Jupiter.Tisserand.Invariant Epoch.Osculation   Eccentricity     Semi.Major.Axis   Inclination       Asc.Node.Longitude
##  Min.   :0.000      Min.   :0.00000            Min.   :2.196               Min.   :2450164   Min.   :0.00752   Min.   :0.6159   Min.   : 0.01451   Min.   :  0.0019  
##  1st Qu.:0.000      1st Qu.:0.01435            1st Qu.:4.047               1st Qu.:2458000   1st Qu.:0.24086   1st Qu.:1.0012   1st Qu.: 4.93290   1st Qu.: 83.1849  
##  Median :3.000      Median :0.04653            Median :5.071               Median :2458000   Median :0.37251   Median :1.2422   Median :10.27694   Median :172.6347  
##  Mean   :3.521      Mean   :0.08191            Mean   :5.056               Mean   :2457723   Mean   :0.38267   Mean   :1.4009   Mean   :13.36159   Mean   :172.1717  
##  3rd Qu.:6.000      3rd Qu.:0.12150            3rd Qu.:6.017               3rd Qu.:2458000   3rd Qu.:0.51256   3rd Qu.:1.6782   3rd Qu.:19.47848   3rd Qu.:254.8804  
##  Max.   :9.000      Max.   :0.47789            Max.   :9.025               Max.   :2458020   Max.   :0.96026   Max.   :5.0720   Max.   :75.40667   Max.   :359.9059  
##  NA&#39;s   :49         NA&#39;s   :137                NA&#39;s   :56                  NA&#39;s   :60        NA&#39;s   :39        NA&#39;s   :53       NA&#39;s   :42         NA&#39;s   :60        
##  Orbital.Period   Perihelion.Distance Perihelion.Arg     Aphelion.Dist    Perihelion.Time    Mean.Anomaly       Mean.Motion       Equinox       Hazardous    
##  Min.   : 176.6   Min.   :0.08074     Min.   :  0.0069   Min.   :0.8038   Min.   :2450100   Min.   :  0.0032   Min.   :0.08628   J2000:4663   Min.   :0.000  
##  1st Qu.: 365.9   1st Qu.:0.63038     1st Qu.: 95.6430   1st Qu.:1.2661   1st Qu.:2457815   1st Qu.: 87.0069   1st Qu.:0.45147   NA&#39;s :  24   1st Qu.:0.000  
##  Median : 504.9   Median :0.83288     Median :189.7729   Median :1.6182   Median :2457972   Median :186.0219   Median :0.71137                Median :0.000  
##  Mean   : 635.5   Mean   :0.81316     Mean   :184.0185   Mean   :1.9864   Mean   :2457726   Mean   :181.2882   Mean   :0.73732                Mean   :0.176  
##  3rd Qu.: 793.1   3rd Qu.:0.99718     3rd Qu.:271.9535   3rd Qu.:2.4497   3rd Qu.:2458108   3rd Qu.:276.6418   3rd Qu.:0.98379                3rd Qu.:0.000  
##  Max.   :4172.2   Max.   :1.29983     Max.   :359.9931   Max.   :8.9839   Max.   :2458839   Max.   :359.9180   Max.   :2.03900                Max.   :1.000  
##  NA&#39;s   :46       NA&#39;s   :22          NA&#39;s   :48         NA&#39;s   :38       NA&#39;s   :59        NA&#39;s   :40         NA&#39;s   :48                     NA&#39;s   :4187</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Impute missing values (not our response variable!)</li>
</ol>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="datasets.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb453-2"><a href="datasets.html#cb453-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb453-3"><a href="datasets.html#cb453-3" aria-hidden="true" tabindex="-1"></a><span class="co">#wine_imputed = titanic %&gt;% select(-name, -ticket, -cabin, -boat, -home.dest)</span></span>
<span id="cb453-4"><a href="datasets.html#cb453-4" aria-hidden="true" tabindex="-1"></a>nasa_imputed <span class="ot">=</span> missRanger<span class="sc">::</span><span class="fu">missRanger</span>(<span class="at">data =</span> nasa <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Hazardous), <span class="at">maxiter =</span> <span class="dv">1</span>, <span class="at">num.trees=</span>5L)</span></code></pre></div>
<pre><code>## 
## Missing value imputation by random forests
## 
##   Variables to impute:       Neo.Reference.ID, Name, Absolute.Magnitude, Est.Dia.in.KM.min., Est.Dia.in.KM.max., Est.Dia.in.M.min., Est.Dia.in.M.max., Est.Dia.in.Miles.min., Est.Dia.in.Miles.max., Est.Dia.in.Feet.min., Est.Dia.in.Feet.max., Close.Approach.Date, Epoch.Date.Close.Approach, Relative.Velocity.km.per.sec, Relative.Velocity.km.per.hr, Miles.per.hour, Miss.Dist..Astronomical., Miss.Dist..lunar., Miss.Dist..kilometers., Miss.Dist..miles., Orbiting.Body, Orbit.ID, Orbit.Determination.Date, Orbit.Uncertainity, Minimum.Orbit.Intersection, Jupiter.Tisserand.Invariant, Epoch.Osculation, Eccentricity, Semi.Major.Axis, Inclination, Asc.Node.Longitude, Orbital.Period, Perihelion.Distance, Perihelion.Arg, Aphelion.Dist, Perihelion.Time, Mean.Anomaly, Mean.Motion, Equinox
##   Variables used to impute:  Neo.Reference.ID, Name, Absolute.Magnitude, Est.Dia.in.KM.min., Est.Dia.in.KM.max., Est.Dia.in.M.min., Est.Dia.in.M.max., Est.Dia.in.Miles.min., Est.Dia.in.Miles.max., Est.Dia.in.Feet.min., Est.Dia.in.Feet.max., Close.Approach.Date, Epoch.Date.Close.Approach, Relative.Velocity.km.per.sec, Relative.Velocity.km.per.hr, Miles.per.hour, Miss.Dist..Astronomical., Miss.Dist..lunar., Miss.Dist..kilometers., Miss.Dist..miles., Orbiting.Body, Orbit.ID, Orbit.Determination.Date, Orbit.Uncertainity, Minimum.Orbit.Intersection, Jupiter.Tisserand.Invariant, Epoch.Osculation, Eccentricity, Semi.Major.Axis, Inclination, Asc.Node.Longitude, Orbital.Period, Perihelion.Distance, Perihelion.Arg, Aphelion.Dist, Perihelion.Time, Mean.Anomaly, Mean.Motion, Equinox
## iter 1:  .....</code></pre>
<pre><code>## Warning: Dropped unused factor level(s) in dependent variable: 2017-04-06 08:35:59, 2017-04-06 09:06:29, 2017-04-06 09:10:05.</code></pre>
<pre><code>## ..................................</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="datasets.html#cb457-1" aria-hidden="true" tabindex="-1"></a>nasa_imputed<span class="sc">$</span>Hazardous <span class="ot">=</span> nasa<span class="sc">$</span>Hazardous</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Split into training and testing</li>
</ol>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="datasets.html#cb458-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> nasa_imputed[<span class="sc">!</span><span class="fu">is.na</span>(nasa<span class="sc">$</span>Hazardous), ]</span>
<span id="cb458-2"><a href="datasets.html#cb458-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> nasa_imputed[<span class="fu">is.na</span>(nasa<span class="sc">$</span>Hazardous), ]</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Train model</li>
</ol>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="datasets.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span>
<span id="cb459-2"><a href="datasets.html#cb459-2" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">=</span> <span class="fu">ranger</span>(Hazardous<span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">classification =</span> <span class="cn">TRUE</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="datasets.html#cb460-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(rf, <span class="at">data =</span> test)<span class="sc">$</span>predictions[,<span class="dv">2</span>]</span>
<span id="cb460-2"><a href="datasets.html#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<pre><code>## [1] 0.7266984 0.7744373 0.0015000 0.8139786 0.1496508 0.1784167</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="datasets.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;rf.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="flower" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Flower</h2>
<p>A collection of over 4000 flower images of 5 plant species. The dataset is from <a href="https://www.kaggle.com/alxmamaev/flowers-recognition">kaggle</a> but we downsampled the images from <span class="math inline">\(320*240\)</span> to <span class="math inline">\(80*80\)</span> pixels.
You can download the dataset <a href="http://rhsbio7.uni-regensburg.de:8500">here</a>.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>check out CNN notebooks on kaggle (they are often written in python but you can still copy the CNN architectures), e.g. <a href="https://www.kaggle.com/alirazaaliqadri/flower-recognition-tensorflow-keras-sequential">this one</a></li>
<li>Last year’s winner have used a transfer learning approach (they achieved around 70% accuracy), check out this <a href="https://www.kaggle.com/stpeteishii/flower-name-classify-densenet201">notebook</a>, see also the section about transfer learning <a href="Deep.html#transfer">4.4.2</a></li>
</ul>
<p><strong>Response variable:</strong> Plant species</p>
<ol style="list-style-type: decimal">
<li>Load dataset
The dataset requires pre-processing (we have to concatenate the train and test images):</li>
</ol>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="datasets.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keras)</span>
<span id="cb463-2"><a href="datasets.html#cb463-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb463-3"><a href="datasets.html#cb463-3" aria-hidden="true" tabindex="-1"></a>data_files <span class="ot">=</span> <span class="fu">list.files</span>(<span class="st">&quot;flower/&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb463-4"><a href="datasets.html#cb463-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> data_files[<span class="fu">str_detect</span>(data_files, <span class="st">&quot;train&quot;</span>)]</span>
<span id="cb463-5"><a href="datasets.html#cb463-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;flower/test.RDS&quot;</span>)</span>
<span id="cb463-6"><a href="datasets.html#cb463-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> <span class="fu">lapply</span>(train, readRDS)</span>
<span id="cb463-7"><a href="datasets.html#cb463-7" aria-hidden="true" tabindex="-1"></a>train_classes <span class="ot">=</span> <span class="fu">lapply</span>(train, <span class="cf">function</span>(d) <span class="fu">dim</span>(d)[<span class="dv">1</span>])</span>
<span id="cb463-8"><a href="datasets.html#cb463-8" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> abind<span class="sc">::</span><span class="fu">abind</span>(train, <span class="at">along =</span> 1L)</span>
<span id="cb463-9"><a href="datasets.html#cb463-9" aria-hidden="true" tabindex="-1"></a>labels_train <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">unlist</span>(train_classes))</span>
<span id="cb463-10"><a href="datasets.html#cb463-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-11"><a href="datasets.html#cb463-11" aria-hidden="true" tabindex="-1"></a>flower <span class="ot">=</span> EcoData<span class="sc">::</span><span class="fu">dataset_flower</span>()</span>
<span id="cb463-12"><a href="datasets.html#cb463-12" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> flower<span class="sc">$</span>train</span>
<span id="cb463-13"><a href="datasets.html#cb463-13" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> flower<span class="sc">$</span>test</span>
<span id="cb463-14"><a href="datasets.html#cb463-14" aria-hidden="true" tabindex="-1"></a>train_classes <span class="ot">=</span> flower<span class="sc">$</span>labels</span></code></pre></div>
<p>Let’s visualize a flower:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="datasets.html#cb464-1" aria-hidden="true" tabindex="-1"></a>train[<span class="dv">100</span>,,,] <span class="sc">%&gt;%</span> </span>
<span id="cb464-2"><a href="datasets.html#cb464-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">image_to_array</span>() <span class="sc">%&gt;%</span></span>
<span id="cb464-3"><a href="datasets.html#cb464-3" aria-hidden="true" tabindex="-1"></a> <span class="st">`</span><span class="at">/</span><span class="st">`</span>(., <span class="dv">255</span>) <span class="sc">%&gt;%</span></span>
<span id="cb464-4"><a href="datasets.html#cb464-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">as.raster</span>() <span class="sc">%&gt;%</span></span>
<span id="cb464-5"><a href="datasets.html#cb464-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Build &amp; train model:</li>
</ol>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="datasets.html#cb465-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">keras_model_sequential</span>()</span>
<span id="cb465-2"><a href="datasets.html#cb465-2" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> </span>
<span id="cb465-3"><a href="datasets.html#cb465-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_conv_2d</span>(<span class="at">filters =</span> 4L, <span class="at">kernel_size =</span> 2L, <span class="at">input_shape =</span> <span class="fu">list</span>( 80L, 80L, 3L)) <span class="sc">%&gt;%</span> </span>
<span id="cb465-4"><a href="datasets.html#cb465-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_max_pooling_2d</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb465-5"><a href="datasets.html#cb465-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_flatten</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb465-6"><a href="datasets.html#cb465-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> 5L, <span class="at">activation =</span> <span class="st">&quot;softmax&quot;</span>)</span>
<span id="cb465-7"><a href="datasets.html#cb465-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-8"><a href="datasets.html#cb465-8" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> </span>
<span id="cb465-9"><a href="datasets.html#cb465-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compile</span>(<span class="at">optimizer =</span> keras<span class="sc">::</span><span class="fu">optimizer_adamax</span>(<span class="fl">0.01</span>), <span class="at">loss =</span> keras<span class="sc">::</span>loss_categorical_crossentropy)</span>
<span id="cb465-10"><a href="datasets.html#cb465-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-11"><a href="datasets.html#cb465-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-12"><a href="datasets.html#cb465-12" aria-hidden="true" tabindex="-1"></a><span class="do">### Model fitting </span><span class="al">###</span></span>
<span id="cb465-13"><a href="datasets.html#cb465-13" aria-hidden="true" tabindex="-1"></a>epochs <span class="ot">=</span> 50L</span>
<span id="cb465-14"><a href="datasets.html#cb465-14" aria-hidden="true" tabindex="-1"></a>batch_size <span class="ot">=</span> 25L</span>
<span id="cb465-15"><a href="datasets.html#cb465-15" aria-hidden="true" tabindex="-1"></a>steps <span class="ot">=</span> <span class="fu">floor</span>(<span class="fu">dim</span>(train)[<span class="dv">1</span>]<span class="sc">/</span>batch_size)</span>
<span id="cb465-16"><a href="datasets.html#cb465-16" aria-hidden="true" tabindex="-1"></a>generator <span class="ot">=</span> keras<span class="sc">::</span><span class="fu">flow_images_from_data</span>(<span class="at">x =</span> train<span class="sc">/</span><span class="dv">255</span> , <span class="at">y =</span> keras<span class="sc">::</span><span class="fu">k_one_hot</span>(labels_train, 5L), <span class="at">batch_size =</span> batch_size)</span>
<span id="cb465-17"><a href="datasets.html#cb465-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-18"><a href="datasets.html#cb465-18" aria-hidden="true" tabindex="-1"></a>optim <span class="ot">=</span> <span class="fu">optimizer_adamax</span>(<span class="fl">0.01</span>)</span>
<span id="cb465-19"><a href="datasets.html#cb465-19" aria-hidden="true" tabindex="-1"></a>epoch_losses <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb465-20"><a href="datasets.html#cb465-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(e <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>epochs) {</span>
<span id="cb465-21"><a href="datasets.html#cb465-21" aria-hidden="true" tabindex="-1"></a>  epoch_loss <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb465-22"><a href="datasets.html#cb465-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>steps) {</span>
<span id="cb465-23"><a href="datasets.html#cb465-23" aria-hidden="true" tabindex="-1"></a>    batch <span class="ot">=</span> reticulate<span class="sc">::</span><span class="fu">iter_next</span>(generator)</span>
<span id="cb465-24"><a href="datasets.html#cb465-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">with</span>(tf<span class="sc">$</span><span class="fu">GradientTape</span>() <span class="sc">%as%</span> tape, {</span>
<span id="cb465-25"><a href="datasets.html#cb465-25" aria-hidden="true" tabindex="-1"></a>        pred <span class="ot">=</span> <span class="fu">model</span>(batch[[<span class="dv">1</span>]])</span>
<span id="cb465-26"><a href="datasets.html#cb465-26" aria-hidden="true" tabindex="-1"></a>        loss <span class="ot">=</span> keras<span class="sc">::</span><span class="fu">loss_categorical_crossentropy</span>(batch[[<span class="dv">2</span>]], pred)</span>
<span id="cb465-27"><a href="datasets.html#cb465-27" aria-hidden="true" tabindex="-1"></a>        loss <span class="ot">=</span> tf<span class="sc">$</span><span class="fu">reduce_mean</span>(loss)</span>
<span id="cb465-28"><a href="datasets.html#cb465-28" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb465-29"><a href="datasets.html#cb465-29" aria-hidden="true" tabindex="-1"></a>    gradients <span class="ot">=</span> tape<span class="sc">$</span><span class="fu">gradient</span>(<span class="at">target =</span> loss, <span class="at">sources =</span> model<span class="sc">$</span>weights)</span>
<span id="cb465-30"><a href="datasets.html#cb465-30" aria-hidden="true" tabindex="-1"></a>    optim<span class="sc">$</span><span class="fu">apply_gradients</span>(purrr<span class="sc">::</span><span class="fu">transpose</span>(<span class="fu">list</span>(gradients, model<span class="sc">$</span>weights)))</span>
<span id="cb465-31"><a href="datasets.html#cb465-31" aria-hidden="true" tabindex="-1"></a>    epoch_loss <span class="ot">=</span> <span class="fu">c</span>(epoch_loss, loss<span class="sc">$</span><span class="fu">numpy</span>())</span>
<span id="cb465-32"><a href="datasets.html#cb465-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb465-33"><a href="datasets.html#cb465-33" aria-hidden="true" tabindex="-1"></a>  epoch_losses <span class="ot">=</span> <span class="fu">c</span>(epoch_losses, epoch_loss)</span>
<span id="cb465-34"><a href="datasets.html#cb465-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Epoch: &quot;</span>, e, <span class="st">&quot; Loss: &quot;</span>, <span class="fu">mean</span>(epoch_losses), <span class="st">&quot; </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb465-35"><a href="datasets.html#cb465-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="datasets.html#cb466-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> model <span class="sc">%&gt;%</span> <span class="fu">predict</span>(test<span class="sc">/</span><span class="dv">255</span>)</span>
<span id="cb466-2"><a href="datasets.html#cb466-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">apply</span>(preds, <span class="dv">1</span>, which.max)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb466-3"><a href="datasets.html#cb466-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="datasets.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;cnn.csv&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gans-vaes-and-reinforcement-learning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
