<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Datasets | Machine Learning and AI in TensorFlow and R</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Datasets | Machine Learning and AI in TensorFlow and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Datasets | Machine Learning and AI in TensorFlow and R" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Maximilian Pichler and Florian Hartig" />


<meta name="date" content="2021-05-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gans-vaes-and-reinforcement-learning.html"/>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction to Machine Learning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#supervised-learning-regression-and-classification"><i class="fa fa-check"></i><b>2.1</b> Supervised learning: regression and classification</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#supervised-regression-using-random-forest"><i class="fa fa-check"></i><b>2.1.1</b> Supervised regression using Random Forest</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#supervised-classification-using-random-forest"><i class="fa fa-check"></i><b>2.1.2</b> Supervised classification using Random Forest</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#unsupervised-learning"><i class="fa fa-check"></i><b>2.2</b> Unsupervised learning</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#k-means-clustering"><i class="fa fa-check"></i><b>2.2.1</b> k-means clustering</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#introduction-to-tensorflow"><i class="fa fa-check"></i><b>2.3</b> Introduction to Tensorflow</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#tensorflow-data-containers"><i class="fa fa-check"></i><b>2.3.1</b> Tensorflow data containers</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#tensorflow-data-types---good-practise-with-r-tf"><i class="fa fa-check"></i><b>2.3.2</b> Tensorflow data types - good practise with R-TF</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#first-steps-with-the-keras-framework"><i class="fa fa-check"></i><b>2.4</b> First steps with the keras framework</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction.html"><a href="introduction.html#example-workflow-in-keras"><i class="fa fa-check"></i><b>2.4.1</b> Example workflow in keras</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fund.html"><a href="fund.html"><i class="fa fa-check"></i><b>3</b> Fundamental principles and techniques</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fund.html"><a href="fund.html#machine-learning-principles"><i class="fa fa-check"></i><b>3.1</b> Machine learning principles</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="fund.html"><a href="fund.html#optimization"><i class="fa fa-check"></i><b>3.1.1</b> Optimization</a></li>
<li class="chapter" data-level="3.1.2" data-path="fund.html"><a href="fund.html#regularization"><i class="fa fa-check"></i><b>3.1.2</b> Regularization</a></li>
<li class="chapter" data-level="3.1.3" data-path="fund.html"><a href="fund.html#classification-and-regression-trees"><i class="fa fa-check"></i><b>3.1.3</b> Classification and Regression Trees</a></li>
<li class="chapter" data-level="3.1.4" data-path="fund.html"><a href="fund.html#random-forest"><i class="fa fa-check"></i><b>3.1.4</b> Random Forest</a></li>
<li class="chapter" data-level="3.1.5" data-path="fund.html"><a href="fund.html#boosted-regression-trees"><i class="fa fa-check"></i><b>3.1.5</b> Boosted regression trees</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fund.html"><a href="fund.html#distance-based-algorithms"><i class="fa fa-check"></i><b>3.2</b> Distance-based algorithms</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="fund.html"><a href="fund.html#k-nearest-neighbor"><i class="fa fa-check"></i><b>3.2.1</b> k-nearest-neighbor</a></li>
<li class="chapter" data-level="3.2.2" data-path="fund.html"><a href="fund.html#support-vector-machines-svm"><i class="fa fa-check"></i><b>3.2.2</b> Support Vector Machines (SVM)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="fund.html"><a href="fund.html#artificial-neural-networks"><i class="fa fa-check"></i><b>3.3</b> Artificial neural networks</a></li>
<li class="chapter" data-level="3.4" data-path="fund.html"><a href="fund.html#the-standard-ml-pipeline-at-the-example-of-the-titanic-dataset"><i class="fa fa-check"></i><b>3.4</b> The standard ML pipeline at the example of the titanic dataset</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="fund.html"><a href="fund.html#data-cleaning"><i class="fa fa-check"></i><b>3.4.1</b> Data cleaning</a></li>
<li class="chapter" data-level="3.4.2" data-path="fund.html"><a href="fund.html#pre-processing-and-feature-selection"><i class="fa fa-check"></i><b>3.4.2</b> Pre-processing and feature selection</a></li>
<li class="chapter" data-level="3.4.3" data-path="fund.html"><a href="fund.html#split-data-for-training-and-testing"><i class="fa fa-check"></i><b>3.4.3</b> Split data for training and testing</a></li>
<li class="chapter" data-level="3.4.4" data-path="fund.html"><a href="fund.html#model-fitting"><i class="fa fa-check"></i><b>3.4.4</b> Model fitting</a></li>
<li class="chapter" data-level="3.4.5" data-path="fund.html"><a href="fund.html#model-evaluation"><i class="fa fa-check"></i><b>3.4.5</b> Model evaluation</a></li>
<li class="chapter" data-level="3.4.6" data-path="fund.html"><a href="fund.html#predictions-and-submission"><i class="fa fa-check"></i><b>3.4.6</b> Predictions and submission</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Deep.html"><a href="Deep.html"><i class="fa fa-check"></i><b>4</b> Deep learning</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Deep.html"><a href="Deep.html#deep-neural-networks"><i class="fa fa-check"></i><b>4.1</b> Deep Neural Networks</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="Deep.html"><a href="Deep.html#dropout-and-early-stopping"><i class="fa fa-check"></i><b>4.1.1</b> Dropout and Early stopping</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Deep.html"><a href="Deep.html#convolutional-neural-networks---mnist"><i class="fa fa-check"></i><b>4.2</b> Convolutional Neural Networks - MNIST</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="Deep.html"><a href="Deep.html#data-augmentation"><i class="fa fa-check"></i><b>4.2.1</b> Data Augmentation</a></li>
<li class="chapter" data-level="4.2.2" data-path="Deep.html"><a href="Deep.html#transfer"><i class="fa fa-check"></i><b>4.2.2</b> Transfer learning</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="Deep.html"><a href="Deep.html#flower-dataset"><i class="fa fa-check"></i><b>4.3</b> Flower dataset</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="xAI.html"><a href="xAI.html"><i class="fa fa-check"></i><b>5</b> Explainable AI (xAI), NLP, and RNNs</a>
<ul>
<li class="chapter" data-level="5.1" data-path="xAI.html"><a href="xAI.html#xai-methods"><i class="fa fa-check"></i><b>5.1</b> xAI Methods</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="xAI.html"><a href="xAI.html#variable-importance"><i class="fa fa-check"></i><b>5.1.1</b> Variable Importance</a></li>
<li class="chapter" data-level="5.1.2" data-path="xAI.html"><a href="xAI.html#partial-dependencies"><i class="fa fa-check"></i><b>5.1.2</b> Partial dependencies</a></li>
<li class="chapter" data-level="5.1.3" data-path="xAI.html"><a href="xAI.html#accumulated-local-effects"><i class="fa fa-check"></i><b>5.1.3</b> Accumulated local effects</a></li>
<li class="chapter" data-level="5.1.4" data-path="xAI.html"><a href="xAI.html#friedmans-h-statistic"><i class="fa fa-check"></i><b>5.1.4</b> Friedmans H-statistic</a></li>
<li class="chapter" data-level="5.1.5" data-path="xAI.html"><a href="xAI.html#global-explainer---simplifying-the-ml-model"><i class="fa fa-check"></i><b>5.1.5</b> Global explainer - Simplifying the ML model</a></li>
<li class="chapter" data-level="5.1.6" data-path="xAI.html"><a href="xAI.html#local-explainer---lime-explaining-single-instances-observations"><i class="fa fa-check"></i><b>5.1.6</b> Local explainer - LIME explaining single instances (observations)</a></li>
<li class="chapter" data-level="5.1.7" data-path="xAI.html"><a href="xAI.html#local-explainer---shapley"><i class="fa fa-check"></i><b>5.1.7</b> Local explainer - Shapley</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="xAI.html"><a href="xAI.html#natural-language-processing-nlp"><i class="fa fa-check"></i><b>5.2</b> Natural Language Processing (NLP)</a></li>
<li class="chapter" data-level="5.3" data-path="xAI.html"><a href="xAI.html#recurrent-neural-networks-rnns"><i class="fa fa-check"></i><b>5.3</b> Recurrent neural networks (RNNs)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html"><i class="fa fa-check"></i><b>6</b> GANs, VAEs, and Reinforcement learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#generative-adversarial-network-gans"><i class="fa fa-check"></i><b>6.1</b> Generative adversarial network (GANs)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#flower---gan"><i class="fa fa-check"></i><b>6.1.1</b> Flower - GAN</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#autoencoder"><i class="fa fa-check"></i><b>6.2</b> Autoencoder</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#autoencoder---mnist-cnn"><i class="fa fa-check"></i><b>6.2.1</b> Autoencoder - MNIST CNN</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="gans-vaes-and-reinforcement-learning.html"><a href="gans-vaes-and-reinforcement-learning.html#varational-autoencoder"><i class="fa fa-check"></i><b>6.3</b> Varational Autoencoder</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>7</b> Datasets</a>
<ul>
<li class="chapter" data-level="7.1" data-path="datasets.html"><a href="datasets.html#titanic"><i class="fa fa-check"></i><b>7.1</b> Titanic</a></li>
<li class="chapter" data-level="7.2" data-path="datasets.html"><a href="datasets.html#plant-pollinator-database"><i class="fa fa-check"></i><b>7.2</b> Plant-pollinator database</a></li>
<li class="chapter" data-level="7.3" data-path="datasets.html"><a href="datasets.html#wine"><i class="fa fa-check"></i><b>7.3</b> Wine</a></li>
<li class="chapter" data-level="7.4" data-path="datasets.html"><a href="datasets.html#nasa"><i class="fa fa-check"></i><b>7.4</b> Nasa</a></li>
<li class="chapter" data-level="7.5" data-path="datasets.html"><a href="datasets.html#flower"><i class="fa fa-check"></i><b>7.5</b> Flower</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning and AI in TensorFlow and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datasets" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Datasets</h1>
<p>You can download the datasets we use in the course <img src="http://rhsbio7.uni-regensburg.de:8500" alt="here" /> (ignore browser warnings)</p>
<div id="titanic" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Titanic</h2>
<p>The dataset is a collection of titanic passengers with information about their age, class, sex, and their survival status. The competition here is simple: train a ML model and predict the survival probability.</p>
<p>The titanic dataset is very well explored and serves as a stepping stone in many ML careers. For inspiration and data exploration notebooks, check out this kaggle competition: <img src="https://www.kaggle.com/c/titanic/data" /></p>
<p><strong>Response variable:</strong> ‘survived’</p>
<p>A minimal working example:</p>
<ol style="list-style-type: decimal">
<li>Load dataset</li>
</ol>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="datasets.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;datasets.RData&quot;</span>)</span>
<span id="cb238-2"><a href="datasets.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(titanic)</span></code></pre></div>
<pre><code>##      pclass         survived          name               sex           age              sibsp            parch            ticket    
##  Min.   :1.000   Min.   :0.0000   Length:1309        female:466   Min.   : 0.1667   Min.   :0.0000   Min.   :0.000   CA. 2343:  11  
##  1st Qu.:2.000   1st Qu.:0.0000   Class :character   male  :843   1st Qu.:21.0000   1st Qu.:0.0000   1st Qu.:0.000   1601    :   8  
##  Median :3.000   Median :0.0000   Mode  :character                Median :28.0000   Median :0.0000   Median :0.000   CA 2144 :   8  
##  Mean   :2.295   Mean   :0.3853                                   Mean   :29.8811   Mean   :0.4989   Mean   :0.385   3101295 :   7  
##  3rd Qu.:3.000   3rd Qu.:1.0000                                   3rd Qu.:39.0000   3rd Qu.:1.0000   3rd Qu.:0.000   347077  :   7  
##  Max.   :3.000   Max.   :1.0000                                   Max.   :80.0000   Max.   :8.0000   Max.   :9.000   347082  :   7  
##                  NA&#39;s   :655                                      NA&#39;s   :263                                        (Other) :1261  
##       fare                     cabin      embarked      boat          body                      home.dest  
##  Min.   :  0.000                  :1014    :  2           :823   Min.   :  1.0                       :564  
##  1st Qu.:  7.896   C23 C25 C27    :   6   C:270    13     : 39   1st Qu.: 72.0   New York, NY        : 64  
##  Median : 14.454   B57 B59 B63 B66:   5   Q:123    C      : 38   Median :155.0   London              : 14  
##  Mean   : 33.295   G6             :   5   S:914    15     : 37   Mean   :160.8   Montreal, PQ        : 10  
##  3rd Qu.: 31.275   B96 B98        :   4            14     : 33   3rd Qu.:256.0   Cornwall / Akron, OH:  9  
##  Max.   :512.329   C22 C26        :   4            4      : 31   Max.   :328.0   Paris, France       :  9  
##  NA&#39;s   :1         (Other)        : 271            (Other):308   NA&#39;s   :1188    (Other)             :639</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Impute missing values (not our response variable!)</li>
</ol>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="datasets.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb240-2"><a href="datasets.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb240-3"><a href="datasets.html#cb240-3" aria-hidden="true" tabindex="-1"></a>titanic_imputed <span class="ot">=</span> titanic <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>name, <span class="sc">-</span>ticket, <span class="sc">-</span>cabin, <span class="sc">-</span>boat, <span class="sc">-</span>home.dest)</span>
<span id="cb240-4"><a href="datasets.html#cb240-4" aria-hidden="true" tabindex="-1"></a>titanic_imputed <span class="ot">=</span> missRanger<span class="sc">::</span><span class="fu">missRanger</span>(<span class="at">data =</span> titanic_imputed <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>survived))</span></code></pre></div>
<pre><code>## 
## Missing value imputation by random forests
## 
##   Variables to impute:       age, fare, body
##   Variables used to impute:  pclass, sex, age, sibsp, parch, fare, embarked, body
## iter 1:  ...
## iter 2:  ...
## iter 3:  ...</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="datasets.html#cb242-1" aria-hidden="true" tabindex="-1"></a>titanic_imputed<span class="sc">$</span>survived <span class="ot">=</span> titanic<span class="sc">$</span>survived</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Split into training and testing</li>
</ol>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="datasets.html#cb243-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> titanic_imputed[<span class="sc">!</span><span class="fu">is.na</span>(titanic<span class="sc">$</span>survived), ]</span>
<span id="cb243-2"><a href="datasets.html#cb243-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> titanic_imputed[<span class="fu">is.na</span>(titanic<span class="sc">$</span>survived), ]</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Train model</li>
</ol>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="datasets.html#cb244-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">glm</span>(survived<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">family =</span> <span class="fu">binomial</span>())</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="datasets.html#cb245-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(model, <span class="at">data =</span> test, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb245-2"><a href="datasets.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<pre><code>##        561        321       1177       1098       1252       1170 
## 0.79272156 0.31122837 0.01379281 0.12119304 0.13886752 0.11602403</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="datasets.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;glm.csv&quot;</span>)</span></code></pre></div>
<p>And submit the csv on <img src="http://rhsbio7.uni-regensburg.de:8500" /></p>
</div>
<div id="plant-pollinator-database" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Plant-pollinator database</h2>
<p>The plant-pollinator database is a collection of plant-pollinator interactions with traits for plants and pollinators. The idea is pollinators interact with plants when their traits fit (e.g. the tongue of a bee needs to match the shape of a flower).
We explored the advantage of ML algorithms over traditional statistical models in predicting species interactions in our paper. If you are interested you can have a look <img src="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.13329" alt="here" />.</p>
<p><img src="images/TM.png" width="699" /></p>
<p><strong>Response variable:</strong> ‘interaction’</p>
<p>A minimal working example:</p>
<ol style="list-style-type: decimal">
<li>Load dataset</li>
</ol>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="datasets.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;datasets.RData&quot;</span>)</span>
<span id="cb248-2"><a href="datasets.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plant_poll)</span></code></pre></div>
<pre><code>##                     X                           Y             type              season             diameter        corolla         
##  Vaccinium_corymbosum:  256   Andrena_wilkella   :   80   Length:20480       Length:20480       Min.   :  2.00   Length:20480      
##  Brassica_napus      :  256   Andrena_barbilabris:   80   Class :character   Class :character   1st Qu.:  5.00   Class :character  
##  Carum_carvi         :  256   Andrena_cineraria  :   80   Mode  :character   Mode  :character   Median : 19.00   Mode  :character  
##  Coriandrum_sativum  :  256   Andrena_flavipes   :   80                                         Mean   : 27.03                     
##  Daucus_carota       :  256   Andrena_gravida    :   80                                         3rd Qu.: 25.00                     
##  Malus_domestica     :  256   Andrena_haemorrhoa :   80                                         Max.   :150.00                     
##  (Other)             :18944   (Other)            :20000                                         NA&#39;s   :9472                       
##     colour             nectar            b.system         s.pollination      inflorescence       composite            guild          
##  Length:20480       Length:20480       Length:20480       Length:20480       Length:20480       Length:20480       Length:20480      
##  Class :character   Class :character   Class :character   Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##                                                                                                                                      
##                                                                                                                                      
##                                                                                                                                      
##                                                                                                                                      
##      tongue            body        sociality           feeding          interaction 
##  Min.   : 2.000   Min.   : 2.00   Length:20480       Length:20480       0   :14095  
##  1st Qu.: 4.800   1st Qu.: 8.00   Class :character   Class :character   1   :  595  
##  Median : 6.600   Median :10.50   Mode  :character   Mode  :character   NA&#39;s: 5790  
##  Mean   : 8.104   Mean   :10.66                                                     
##  3rd Qu.:10.500   3rd Qu.:13.00                                                     
##  Max.   :26.400   Max.   :25.00                                                     
##  NA&#39;s   :17040    NA&#39;s   :6160</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Impute missing values (not our response variable!)
We will select only a few predictors here (you can work with all predictors ofc).</li>
</ol>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="datasets.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb250-2"><a href="datasets.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb250-3"><a href="datasets.html#cb250-3" aria-hidden="true" tabindex="-1"></a>plant_poll_imputed <span class="ot">=</span> plant_poll <span class="sc">%&gt;%</span> <span class="fu">select</span>(diameter, corolla, tongue, body, interaction)</span>
<span id="cb250-4"><a href="datasets.html#cb250-4" aria-hidden="true" tabindex="-1"></a>plant_poll_imputed <span class="ot">=</span> missRanger<span class="sc">::</span><span class="fu">missRanger</span>(<span class="at">data =</span> plant_poll_imputed <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>interaction))</span></code></pre></div>
<pre><code>## 
## Missing value imputation by random forests
## 
##   Variables to impute:       diameter, corolla, tongue, body
##   Variables used to impute:  diameter, corolla, tongue, body
## iter 1:  ....
## iter 2:  ....
## iter 3:  ....</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="datasets.html#cb252-1" aria-hidden="true" tabindex="-1"></a>plant_poll_imputed<span class="sc">$</span>interaction <span class="ot">=</span> plant_poll<span class="sc">$</span>interaction</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Split into training and testing</li>
</ol>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="datasets.html#cb253-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> plant_poll_imputed[<span class="sc">!</span><span class="fu">is.na</span>(plant_poll_imputed<span class="sc">$</span>interaction), ]</span>
<span id="cb253-2"><a href="datasets.html#cb253-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> plant_poll_imputed[<span class="fu">is.na</span>(plant_poll_imputed<span class="sc">$</span>interaction), ]</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Train model</li>
</ol>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="datasets.html#cb254-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">glm</span>(interaction<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">family =</span> <span class="fu">binomial</span>())</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="datasets.html#cb255-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(model, <span class="at">data =</span> test, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb255-2"><a href="datasets.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<pre><code>##       3871       3872       3873       3874       3875       3876 
## 0.03882583 0.03757548 0.03772374 0.04455096 0.04511771 0.03965961</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="datasets.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;glm.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="wine" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Wine</h2>
<p>The dataset is a collection of wines of different quality. The aim is to predict the quality of the wine based on physochemical predictors.</p>
<p>For inspiration and data exploration notebooks, check out this kaggle competition: <img src="https://www.kaggle.com/uciml/red-wine-quality-cortez-et-al-2009" />
For instance, check out this very nice <img src="https://www.kaggle.com/aditimulye/red-wine-quality-assesment-starter-pack" alt="notebook" /> which removes a few problems from the data.</p>
<p><strong>Response variable:</strong> ‘quality’</p>
<p>We could use theoretically a regression model for this task but we will stick with a classification model</p>
<p>A minimal working example:</p>
<ol style="list-style-type: decimal">
<li>Load dataset</li>
</ol>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="datasets.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;datasets.RData&quot;</span>)</span>
<span id="cb258-2"><a href="datasets.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine)</span></code></pre></div>
<pre><code>##  fixed.acidity    volatile.acidity  citric.acid     residual.sugar     chlorides       free.sulfur.dioxide total.sulfur.dioxide
##  Min.   : 4.600   Min.   :0.1200   Min.   :0.0000   Min.   : 0.900   Min.   :0.01200   Min.   : 1.00       Min.   :  6.00      
##  1st Qu.: 7.100   1st Qu.:0.3900   1st Qu.:0.0900   1st Qu.: 1.900   1st Qu.:0.07000   1st Qu.: 7.00       1st Qu.: 22.00      
##  Median : 7.900   Median :0.5200   Median :0.2600   Median : 2.200   Median :0.07900   Median :14.00       Median : 38.00      
##  Mean   : 8.335   Mean   :0.5284   Mean   :0.2705   Mean   : 2.533   Mean   :0.08747   Mean   :15.83       Mean   : 46.23      
##  3rd Qu.: 9.300   3rd Qu.:0.6400   3rd Qu.:0.4200   3rd Qu.: 2.600   3rd Qu.:0.09000   3rd Qu.:21.00       3rd Qu.: 62.00      
##  Max.   :15.900   Max.   :1.5800   Max.   :1.0000   Max.   :15.500   Max.   :0.61100   Max.   :72.00       Max.   :289.00      
##  NA&#39;s   :70       NA&#39;s   :48       NA&#39;s   :41       NA&#39;s   :60       NA&#39;s   :37        NA&#39;s   :78          NA&#39;s   :78          
##     density             pH          sulphates         alcohol         quality     
##  Min.   :0.9901   Min.   :2.740   Min.   :0.3300   Min.   : 8.40   Min.   :3.000  
##  1st Qu.:0.9956   1st Qu.:3.210   1st Qu.:0.5500   1st Qu.: 9.50   1st Qu.:5.000  
##  Median :0.9968   Median :3.310   Median :0.6200   Median :10.20   Median :6.000  
##  Mean   :0.9968   Mean   :3.311   Mean   :0.6572   Mean   :10.42   Mean   :5.596  
##  3rd Qu.:0.9979   3rd Qu.:3.400   3rd Qu.:0.7300   3rd Qu.:11.10   3rd Qu.:6.000  
##  Max.   :1.0037   Max.   :4.010   Max.   :2.0000   Max.   :14.90   Max.   :8.000  
##  NA&#39;s   :78       NA&#39;s   :25      NA&#39;s   :51                       NA&#39;s   :905</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Impute missing values (not our response variable!)</li>
</ol>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="datasets.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb260-2"><a href="datasets.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb260-3"><a href="datasets.html#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="co">#wine_imputed = titanic %&gt;% select(-name, -ticket, -cabin, -boat, -home.dest)</span></span>
<span id="cb260-4"><a href="datasets.html#cb260-4" aria-hidden="true" tabindex="-1"></a>wine_imputed <span class="ot">=</span> missRanger<span class="sc">::</span><span class="fu">missRanger</span>(<span class="at">data =</span> wine <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>quality))</span></code></pre></div>
<pre><code>## 
## Missing value imputation by random forests
## 
##   Variables to impute:       fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, total.sulfur.dioxide, density, pH, sulphates
##   Variables used to impute:  fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, total.sulfur.dioxide, density, pH, sulphates, alcohol
## iter 1:  ..........
## iter 2:  ..........
## iter 3:  ..........</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="datasets.html#cb262-1" aria-hidden="true" tabindex="-1"></a>wine_imputed<span class="sc">$</span>quality <span class="ot">=</span> wine<span class="sc">$</span>quality</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Split into training and testing</li>
</ol>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="datasets.html#cb263-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> wine_imputed[<span class="sc">!</span><span class="fu">is.na</span>(wine<span class="sc">$</span>quality), ]</span>
<span id="cb263-2"><a href="datasets.html#cb263-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> wine_imputed[<span class="fu">is.na</span>(wine<span class="sc">$</span>quality), ]</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Train model</li>
</ol>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="datasets.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span>
<span id="cb264-2"><a href="datasets.html#cb264-2" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">=</span> <span class="fu">ranger</span>(quality<span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">classification =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="datasets.html#cb265-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(rf, <span class="at">data =</span> test)<span class="sc">$</span>predictions</span>
<span id="cb265-2"><a href="datasets.html#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<pre><code>## [1] 6 5 5 7 6 6</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="datasets.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;rf.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="nasa" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Nasa</h2>
<p>A collection about asteroids and their characteristics from kaggle. The aim is to predict whether the asteroids are hazardous or not.
For inspiration and data exploration notebooks, check out the kaggle competition: <img src="https://www.kaggle.com/shrutimehta/nasa-asteroids-classification" /></p>
<p><strong>Response variable:</strong> ‘Hazardous’
1. Load dataset</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="datasets.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;datasets.RData&quot;</span>)</span>
<span id="cb268-2"><a href="datasets.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nasa)</span></code></pre></div>
<pre><code>##  Neo.Reference.ID       Name         Absolute.Magnitude Est.Dia.in.KM.min. Est.Dia.in.KM.max. Est.Dia.in.M.min.   Est.Dia.in.M.max. 
##  Min.   :2000433   Min.   :2000433   Min.   :11.16      Min.   : 0.00101   Min.   : 0.00226   Min.   :    1.011   Min.   :    2.26  
##  1st Qu.:3102682   1st Qu.:3102683   1st Qu.:20.10      1st Qu.: 0.03346   1st Qu.: 0.07482   1st Qu.:   33.462   1st Qu.:   74.82  
##  Median :3514800   Median :3514800   Median :21.90      Median : 0.11080   Median : 0.24777   Median :  110.804   Median :  247.77  
##  Mean   :3272675   Mean   :3273113   Mean   :22.27      Mean   : 0.20523   Mean   : 0.45754   Mean   :  204.649   Mean   :  458.45  
##  3rd Qu.:3690987   3rd Qu.:3690385   3rd Qu.:24.50      3rd Qu.: 0.25384   3rd Qu.: 0.56760   3rd Qu.:  253.837   3rd Qu.:  567.60  
##  Max.   :3781897   Max.   :3781897   Max.   :32.10      Max.   :15.57955   Max.   :34.83694   Max.   :15579.552   Max.   :34836.94  
##  NA&#39;s   :53        NA&#39;s   :57        NA&#39;s   :36         NA&#39;s   :60         NA&#39;s   :23         NA&#39;s   :29          NA&#39;s   :46        
##  Est.Dia.in.Miles.min. Est.Dia.in.Miles.max. Est.Dia.in.Feet.min. Est.Dia.in.Feet.max. Close.Approach.Date Epoch.Date.Close.Approach
##  Min.   :0.00063       Min.   : 0.00140      Min.   :    3.32     Min.   :     7.41    2016-07-22:  18     Min.   :7.889e+11        
##  1st Qu.:0.02079       1st Qu.: 0.04649      1st Qu.:  109.78     1st Qu.:   245.49    2015-01-15:  17     1st Qu.:1.016e+12        
##  Median :0.06885       Median : 0.15395      Median :  363.53     Median :   812.88    2015-02-15:  16     Median :1.203e+12        
##  Mean   :0.12734       Mean   : 0.28486      Mean   :  670.44     Mean   :  1500.77    2007-11-08:  15     Mean   :1.180e+12        
##  3rd Qu.:0.15773       3rd Qu.: 0.35269      3rd Qu.:  832.80     3rd Qu.:  1862.19    2012-01-15:  15     3rd Qu.:1.356e+12        
##  Max.   :9.68068       Max.   :21.64666      Max.   :51114.02     Max.   :114294.42    (Other)   :4577     Max.   :1.473e+12        
##  NA&#39;s   :42            NA&#39;s   :50            NA&#39;s   :21           NA&#39;s   :46           NA&#39;s      :  29     NA&#39;s   :43               
##  Relative.Velocity.km.per.sec Relative.Velocity.km.per.hr Miles.per.hour    Miss.Dist..Astronomical. Miss.Dist..lunar.  
##  Min.   : 0.3355              Min.   :  1208              Min.   :  750.5   Min.   :0.00018          Min.   :  0.06919  
##  1st Qu.: 8.4497              1st Qu.: 30399              1st Qu.:18846.7   1st Qu.:0.13341          1st Qu.: 51.89874  
##  Median :12.9370              Median : 46532              Median :28893.7   Median :0.26497          Median :103.19415  
##  Mean   :13.9848              Mean   : 50298              Mean   :31228.0   Mean   :0.25690          Mean   : 99.91366  
##  3rd Qu.:18.0774              3rd Qu.: 65068              3rd Qu.:40436.9   3rd Qu.:0.38506          3rd Qu.:149.59244  
##  Max.   :44.6337              Max.   :160681              Max.   :99841.2   Max.   :0.49988          Max.   :194.45491  
##  NA&#39;s   :27                   NA&#39;s   :28                  NA&#39;s   :38        NA&#39;s   :60               NA&#39;s   :30         
##  Miss.Dist..kilometers. Miss.Dist..miles.  Orbiting.Body    Orbit.ID             Orbit.Determination.Date Orbit.Uncertainity
##  Min.   :   26610       Min.   :   16535   Earth:4665    Min.   :  1.00   2017-06-21 06:17:20:   9        Min.   :0.000     
##  1st Qu.:19964907       1st Qu.:12454813   NA&#39;s :  22    1st Qu.:  9.00   2017-04-06 08:57:13:   8        1st Qu.:0.000     
##  Median :39685408       Median :24662435                 Median : 16.00   2017-04-06 09:24:24:   8        Median :3.000     
##  Mean   :38436154       Mean   :23885560                 Mean   : 28.34   2017-04-06 08:24:13:   7        Mean   :3.521     
##  3rd Qu.:57540318       3rd Qu.:35714721                 3rd Qu.: 31.00   2017-04-06 08:26:19:   7        3rd Qu.:6.000     
##  Max.   :74781600       Max.   :46467132                 Max.   :611.00   (Other)            :4622        Max.   :9.000     
##  NA&#39;s   :56             NA&#39;s   :27                       NA&#39;s   :33       NA&#39;s               :  26        NA&#39;s   :49        
##  Minimum.Orbit.Intersection Jupiter.Tisserand.Invariant Epoch.Osculation   Eccentricity     Semi.Major.Axis   Inclination      
##  Min.   :0.00000            Min.   :2.196               Min.   :2450164   Min.   :0.00752   Min.   :0.6159   Min.   : 0.01451  
##  1st Qu.:0.01435            1st Qu.:4.047               1st Qu.:2458000   1st Qu.:0.24086   1st Qu.:1.0012   1st Qu.: 4.93290  
##  Median :0.04653            Median :5.071               Median :2458000   Median :0.37251   Median :1.2422   Median :10.27694  
##  Mean   :0.08191            Mean   :5.056               Mean   :2457723   Mean   :0.38267   Mean   :1.4009   Mean   :13.36159  
##  3rd Qu.:0.12150            3rd Qu.:6.017               3rd Qu.:2458000   3rd Qu.:0.51256   3rd Qu.:1.6782   3rd Qu.:19.47848  
##  Max.   :0.47789            Max.   :9.025               Max.   :2458020   Max.   :0.96026   Max.   :5.0720   Max.   :75.40667  
##  NA&#39;s   :137                NA&#39;s   :56                  NA&#39;s   :60        NA&#39;s   :39        NA&#39;s   :53       NA&#39;s   :42        
##  Asc.Node.Longitude Orbital.Period   Perihelion.Distance Perihelion.Arg     Aphelion.Dist    Perihelion.Time    Mean.Anomaly     
##  Min.   :  0.0019   Min.   : 176.6   Min.   :0.08074     Min.   :  0.0069   Min.   :0.8038   Min.   :2450100   Min.   :  0.0032  
##  1st Qu.: 83.1849   1st Qu.: 365.9   1st Qu.:0.63038     1st Qu.: 95.6430   1st Qu.:1.2661   1st Qu.:2457815   1st Qu.: 87.0069  
##  Median :172.6347   Median : 504.9   Median :0.83288     Median :189.7729   Median :1.6182   Median :2457972   Median :186.0219  
##  Mean   :172.1717   Mean   : 635.5   Mean   :0.81316     Mean   :184.0185   Mean   :1.9864   Mean   :2457726   Mean   :181.2882  
##  3rd Qu.:254.8804   3rd Qu.: 793.1   3rd Qu.:0.99718     3rd Qu.:271.9535   3rd Qu.:2.4497   3rd Qu.:2458108   3rd Qu.:276.6418  
##  Max.   :359.9059   Max.   :4172.2   Max.   :1.29983     Max.   :359.9931   Max.   :8.9839   Max.   :2458839   Max.   :359.9180  
##  NA&#39;s   :60         NA&#39;s   :46       NA&#39;s   :22          NA&#39;s   :48         NA&#39;s   :38       NA&#39;s   :59        NA&#39;s   :40        
##   Mean.Motion       Equinox       Hazardous    
##  Min.   :0.08628   J2000:4663   Min.   :0.000  
##  1st Qu.:0.45147   NA&#39;s :  24   1st Qu.:0.000  
##  Median :0.71137                Median :0.000  
##  Mean   :0.73732                Mean   :0.176  
##  3rd Qu.:0.98379                3rd Qu.:0.000  
##  Max.   :2.03900                Max.   :1.000  
##  NA&#39;s   :48                     NA&#39;s   :4187</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Impute missing values (not our response variable!)</li>
</ol>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="datasets.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb270-2"><a href="datasets.html#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb270-3"><a href="datasets.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="co">#wine_imputed = titanic %&gt;% select(-name, -ticket, -cabin, -boat, -home.dest)</span></span>
<span id="cb270-4"><a href="datasets.html#cb270-4" aria-hidden="true" tabindex="-1"></a>nasa_imputed <span class="ot">=</span> missRanger<span class="sc">::</span><span class="fu">missRanger</span>(<span class="at">data =</span> nasa <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Hazardous), <span class="at">maxiter =</span> <span class="dv">1</span>, <span class="at">num.trees=</span>5L)</span></code></pre></div>
<pre><code>## 
## Missing value imputation by random forests
## 
##   Variables to impute:       Neo.Reference.ID, Name, Absolute.Magnitude, Est.Dia.in.KM.min., Est.Dia.in.KM.max., Est.Dia.in.M.min., Est.Dia.in.M.max., Est.Dia.in.Miles.min., Est.Dia.in.Miles.max., Est.Dia.in.Feet.min., Est.Dia.in.Feet.max., Close.Approach.Date, Epoch.Date.Close.Approach, Relative.Velocity.km.per.sec, Relative.Velocity.km.per.hr, Miles.per.hour, Miss.Dist..Astronomical., Miss.Dist..lunar., Miss.Dist..kilometers., Miss.Dist..miles., Orbiting.Body, Orbit.ID, Orbit.Determination.Date, Orbit.Uncertainity, Minimum.Orbit.Intersection, Jupiter.Tisserand.Invariant, Epoch.Osculation, Eccentricity, Semi.Major.Axis, Inclination, Asc.Node.Longitude, Orbital.Period, Perihelion.Distance, Perihelion.Arg, Aphelion.Dist, Perihelion.Time, Mean.Anomaly, Mean.Motion, Equinox
##   Variables used to impute:  Neo.Reference.ID, Name, Absolute.Magnitude, Est.Dia.in.KM.min., Est.Dia.in.KM.max., Est.Dia.in.M.min., Est.Dia.in.M.max., Est.Dia.in.Miles.min., Est.Dia.in.Miles.max., Est.Dia.in.Feet.min., Est.Dia.in.Feet.max., Close.Approach.Date, Epoch.Date.Close.Approach, Relative.Velocity.km.per.sec, Relative.Velocity.km.per.hr, Miles.per.hour, Miss.Dist..Astronomical., Miss.Dist..lunar., Miss.Dist..kilometers., Miss.Dist..miles., Orbiting.Body, Orbit.ID, Orbit.Determination.Date, Orbit.Uncertainity, Minimum.Orbit.Intersection, Jupiter.Tisserand.Invariant, Epoch.Osculation, Eccentricity, Semi.Major.Axis, Inclination, Asc.Node.Longitude, Orbital.Period, Perihelion.Distance, Perihelion.Arg, Aphelion.Dist, Perihelion.Time, Mean.Anomaly, Mean.Motion, Equinox
## iter 1:  .....</code></pre>
<pre><code>## Warning: Dropped unused factor level(s) in dependent variable: 2017-04-06 08:35:59, 2017-04-06 09:06:29, 2017-04-06 09:10:05.</code></pre>
<pre><code>## ..................................</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="datasets.html#cb274-1" aria-hidden="true" tabindex="-1"></a>nasa_imputed<span class="sc">$</span>Hazardous <span class="ot">=</span> nasa<span class="sc">$</span>Hazardous</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Split into training and testing</li>
</ol>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="datasets.html#cb275-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> nasa_imputed[<span class="sc">!</span><span class="fu">is.na</span>(nasa<span class="sc">$</span>Hazardous), ]</span>
<span id="cb275-2"><a href="datasets.html#cb275-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> nasa_imputed[<span class="fu">is.na</span>(nasa<span class="sc">$</span>Hazardous), ]</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Train model</li>
</ol>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="datasets.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span>
<span id="cb276-2"><a href="datasets.html#cb276-2" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">=</span> <span class="fu">ranger</span>(Hazardous<span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">classification =</span> <span class="cn">TRUE</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="datasets.html#cb277-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(rf, <span class="at">data =</span> test)<span class="sc">$</span>predictions[,<span class="dv">2</span>]</span>
<span id="cb277-2"><a href="datasets.html#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<pre><code>## [1] 0.7227714 0.7291341 0.0017500 0.8403690 0.1601960 0.1616310</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="datasets.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;rf.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="flower" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Flower</h2>
<p>A collection of over 4000 flower images of 5 plant species. The dataset is from <img src="https://www.kaggle.com/alxmamaev/flowers-recognition" alt="kaggle" /> but we downsampled the images from <span class="math inline">\(320*240\)</span> to <span class="math inline">\(80*80\)</span> pixels.
You can download the dataset <img src="http://rhsbio7.uni-regensburg.de:8500" alt="here" />.</p>
<p><strong>Notes:</strong>
- check out CNN notebooks on kaggle (they are often written in python but you can still copy the CNN architectures), e.g. <img src="https://www.kaggle.com/alirazaaliqadri/flower-recognition-tensorflow-keras-sequential" alt="this one" />
- Last year’s winner have used a transfer learning approach (they achieved around 70% accuracy), check out this <img src="https://www.kaggle.com/stpeteishii/flower-name-classify-densenet201" alt="notebook" />, see also the section about transfer learning <a href="Deep.html#transfer">4.2.2</a></p>
<p><strong>Response variable:</strong> Plant species</p>
<ol style="list-style-type: decimal">
<li>Load dataset
The dataset requires pre-processing (we have to concatenate the train and test images):</li>
</ol>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="datasets.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keras)</span>
<span id="cb280-2"><a href="datasets.html#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb280-3"><a href="datasets.html#cb280-3" aria-hidden="true" tabindex="-1"></a>data_files <span class="ot">=</span> <span class="fu">list.files</span>(<span class="st">&quot;flower/&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb280-4"><a href="datasets.html#cb280-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> data_files[<span class="fu">str_detect</span>(data_files, <span class="st">&quot;train&quot;</span>)]</span>
<span id="cb280-5"><a href="datasets.html#cb280-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;flower/test.RDS&quot;</span>)</span>
<span id="cb280-6"><a href="datasets.html#cb280-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> <span class="fu">lapply</span>(train, readRDS)</span>
<span id="cb280-7"><a href="datasets.html#cb280-7" aria-hidden="true" tabindex="-1"></a>train_classes <span class="ot">=</span> <span class="fu">lapply</span>(train, <span class="cf">function</span>(d) <span class="fu">dim</span>(d)[<span class="dv">1</span>])</span>
<span id="cb280-8"><a href="datasets.html#cb280-8" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> abind<span class="sc">::</span><span class="fu">abind</span>(train, <span class="at">along =</span> 1L)</span>
<span id="cb280-9"><a href="datasets.html#cb280-9" aria-hidden="true" tabindex="-1"></a>labels_train <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">unlist</span>(train_classes))</span></code></pre></div>
<p>Let’s visualize a flower:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="datasets.html#cb281-1" aria-hidden="true" tabindex="-1"></a>train[<span class="dv">100</span>,,,] <span class="sc">%&gt;%</span> </span>
<span id="cb281-2"><a href="datasets.html#cb281-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">image_to_array</span>() <span class="sc">%&gt;%</span></span>
<span id="cb281-3"><a href="datasets.html#cb281-3" aria-hidden="true" tabindex="-1"></a> <span class="st">`</span><span class="at">/</span><span class="st">`</span>(., <span class="dv">255</span>) <span class="sc">%&gt;%</span></span>
<span id="cb281-4"><a href="datasets.html#cb281-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">as.raster</span>() <span class="sc">%&gt;%</span></span>
<span id="cb281-5"><a href="datasets.html#cb281-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Build &amp; train model:</li>
</ol>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="datasets.html#cb282-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">keras_model_sequential</span>()</span>
<span id="cb282-2"><a href="datasets.html#cb282-2" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> </span>
<span id="cb282-3"><a href="datasets.html#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_conv_2d</span>(<span class="at">filters =</span> 4L, <span class="at">kernel_size =</span> 2L, <span class="at">input_shape =</span> <span class="fu">c</span>(80L, 80L, 3L)) <span class="sc">%&gt;%</span> </span>
<span id="cb282-4"><a href="datasets.html#cb282-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_max_pooling_2d</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb282-5"><a href="datasets.html#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_flatten</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb282-6"><a href="datasets.html#cb282-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> 5L, <span class="at">activation =</span> <span class="st">&quot;softmax&quot;</span>)</span>
<span id="cb282-7"><a href="datasets.html#cb282-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-8"><a href="datasets.html#cb282-8" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> </span>
<span id="cb282-9"><a href="datasets.html#cb282-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compile</span>(<span class="at">optimizer =</span> <span class="fu">optimizer_adamax</span>(<span class="fl">0.01</span>), <span class="at">loss =</span> loss_categorical_crossentropy)</span>
<span id="cb282-10"><a href="datasets.html#cb282-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-11"><a href="datasets.html#cb282-11" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> </span>
<span id="cb282-12"><a href="datasets.html#cb282-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">epochs =</span> 2L, <span class="at">x =</span> train<span class="sc">/</span><span class="dv">255</span>, <span class="at">y =</span> keras<span class="sc">::</span><span class="fu">k_one_hot</span>(labels_train, 5L))</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Predictions</li>
</ol>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="datasets.html#cb283-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> model <span class="sc">%&gt;%</span> <span class="fu">predict</span>(test<span class="sc">/</span><span class="dv">255</span>)</span>
<span id="cb283-2"><a href="datasets.html#cb283-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">apply</span>(preds, <span class="dv">1</span>, which.max)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb283-3"><a href="datasets.html#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preds)</span></code></pre></div>
<pre><code>## [1] 1 2 4 4 4 3</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Create submission csv</li>
</ol>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="datasets.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(<span class="at">y=</span>preds), <span class="at">file =</span> <span class="st">&quot;cnn.csv&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gans-vaes-and-reinforcement-learning.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
